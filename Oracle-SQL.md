
- [Section 2 - Installation of Oracle Database 21c XE](#section-2-installation-of-oracle-database-21c-xe)
   * [Class 1 - Download and Installation of Oracle Database 21c XE](#class-1-download-and-installation-of-oracle-database-21c-xe)
   * [Class 2 - Configuring the listener and tnsnames - Creating and testing a local connection](#class-2-configuring-the-listener-and-tnsnames-creating-and-testing-a-local-connection)
- [Section 3 - User Settings](#section-3-user-settings)
   * [Class 3 - Creating the HR user](#class-3-creating-the-hr-user)
   * [Class 4 - Creating a connection to the HR user in SQL Developer](#class-4-creating-a-connection-to-the-hr-user-in-sql-developer)
   * [Class 5 - Creating HR user Schema objects](#class-5-creating-hr-user-schema-objects)
   * [Class 6 - Populating the HR user Schema objects](#class-6-populating-the-hr-user-schema-objects)
   * [Class 7 - Creating Indexes, Inserting Comments and Others in the HR User Schema](#class-7-creating-indexes-inserting-comments-and-others-in-the-hr-user-schema)
- [Section 6 - SQL Fundamentals - Consulting data using the Select Command](#section-6-sql-fundamentals-consulting-data-using-the-select-command)
   * [consulting data using the SQL SELECT command](#consulting-data-using-the-sql-select-command)
   * [selects](#selects)
- [Section 7 - SQL Fundamentals - Restricting and ordering data](#section-7-sql-fundamentals-restricting-and-ordering-data)
   * [clause where](#clause-where)
- [Section 8 - Single -Row Functions](#section-8-single-row-functions)
   * [Date Functions](#date-functions)
   * [Single-Row Functions 2](#single-row-functions-2)
   * [Single-Row Functions](#single-row-functions)
- [Section 9 - Conversion Functions](#section-9-conversion-functions)
   * [Using conversion functions and conditional expressions](#using-conversion-functions-and-conditional-expressions)
- [Section 10 - Group Functions](#section-10-group-functions)
   * [adding data using group functions](#adding-data-using-group-functions)
   * [Group by](#group-by)
- [Section 11 - Joins](#section-11-joins)
   * [1 - Joins](#1-joins)
   * [2 - Nonequijoins](#2-nonequijoins)
   * [3 - Inner Joins](#3-inner-joins)
   * [4 - Outer Joins](#4-outer-joins)
   * [5 - Cartesian product](#5-cartesian-product)
   * [6 - Joins Oracle](#6-joins-oracle)
   * [Joins Ansii](#joins-ansii)
   * [Joins Oracle](#joins-oracle)
- [Section 12 - Sub -Queries](#section-12-sub-queries)
   * [1-Single-Row Sub-Consults](#1-single-row-sub-consults)
   * [2-Multiple-Row sub-consults](#2-multiple-row-sub-consults)
   * [3 - Using exists and not exists](#3-using-exists-and-not-exists)
   * [4 - Using correlated subconsult](#4-using-correlated-subconsult)
   * [5-Using multiple-column sub-consults](#5-using-multiple-column-sub-consults)
   * [6 - Using sub -consults in the from](#6-using-sub-consults-in-the-from)
   * [Sub-Queries](#sub-queries)
- [Section 13 - Set Operators](#section-13-set-operators)
   * [1 - Set operators](#1-set-operators)
- [Section 14 - DML Commands - Manipulating Data](#section-14-dml-commands-manipulating-data)
   * [1 - DML Commands Manipulating Data](#1-dml-commands-manipulating-data)
   * [DML Commands Manipulating Data](#dml-commands-manipulating-data)
- [Section 15 - DDL Commands](#section-15-ddl-commands)
   * [1 - Creating and Managing Tables](#1-creating-and-managing-tables)
   * [2 - Changing the table structure](#2-changing-the-table-structure)
   * [DDL Commands](#ddl-commands)
- [Section 16 - Managing constraints](#section-16-managing-constraints)
   * [1 - Creating constraints in the creation of the table](#1-creating-constraints-in-the-creation-of-the-table)
   * [2 - Managing constraints](#2-managing-constraints)
   * [CONSTRANTS](#constrants)
- [Section 17 - Views](#section-17-views)
   * [1 - Creating and Managing Visions](#1-creating-and-managing-visions)
   * [Views](#views)
- [Section 18 - Sequences](#section-18-sequences)
   * [1 - Creating and Managing Sequences](#1-creating-and-managing-sequences)
   * [Sequence](#sequence)
- [Section 19 - Indexes](#section-19-indexes)
   * [1 - Creating and Managing Indexes](#1-creating-and-managing-indexes)
   * [Index](#index)
- [Section 20 - Synonyms](#section-20-synonyms)
   * [Creating Synonyms](#creating-synonyms)
- [Section 21 - Using SQL Plus](#section-21-using-sql-plus)
   * [ExampleACCEPT](#exampleaccept)
   * [Examplesqlplus](#examplesqlplus)
   * [Using SQL Plus](#using-sql-plus)
- [Section 22 - Database Objects](#section-22-database-objects)
   * [Database Objects](#database-objects)
- [Section 23 - Dice Dictionary Visions](#section-23-dice-dictionary-visions)
   * [DIFFERENCES BETWEEN VISIONS WITH PREFIX USER, ALL AND DBA](#differences-between-visions-with-prefix-user-all-and-dba)
   * [Visions with prefix v $ - Dynamic performance visions](#visions-with-prefix-v-dynamic-performance-visions)
   * [Dice Dictionary Visions](#dice-dictionary-visions)
- [Section 24 - Indexes - Advanced](#section-24-indexes-advanced)
   * [1 - Indexes](#1-indexes)
   * [2 - Types of Indexes](#2-types-of-indexes)
   * [3 - Reconstructing and reorganizing indices](#3-reconstructing-and-reorganizing-indices)
   * [4 - Consulting Indexes](#4-consulting-indexes)
   * [5 - Removing Indexes](#5-removing-indexes)
   * [6 - Creating Indexes in the Creation of the Table](#6-creating-indexes-in-the-creation-of-the-table)
   * [7 - Creating Index for Primary Key after the creation of the table](#7-creating-index-for-primary-key-after-the-creation-of-the-table)
   * [8 - Creating Function Based Indexes](#8-creating-function-based-indexes)
   * [9 - Multiple indexes for the same columns](#9-multiple-indexes-for-the-same-columns)
   * [Index 2](#index-2)
   * [Index](#index-1)
- [Section 25 - Advanced data handling](#section-25-advanced-data-handling)
   * [1 - Using the word default key in the insert or update commands](#1-using-the-word-default-key-in-the-insert-or-update-commands)
   * [2 - INSERT ALL INCONDITIONAL COMMAND](#2-insert-all-inconditional-command)
   * [3 - INSERT ALL CONDITIONAL COMMAND](#3-insert-all-conditional-command)
   * [4 - Conditional INSERT FIRST COMMAND](#4-conditional-insert-first-command)
   * [5 - INSERT PIVOTING COMMAND](#5-insert-pivoting-command)
   * [6 - MERGE COMMAND](#6-merge-command)
   * [INSERT ALL](#insert-all)
   * [INSERT FIRST](#insert-first)
   * [INSERT PIVOTING](#insert-pivoting)
   * [MERGE](#merge)
- [Section 26 - Flashback](#section-26-flashback)
   * [1 - Flashback Query - Me](#1-flashback-query-me)
   * [1 - Flashback Query](#1-flashback-query)
   * [2 - Flashback Drop - ME](#2-flashback-drop-me)
   * [2 - Flashback Drop](#2-flashback-drop)
   * [3 - Flashback table](#3-flashback-table)
   * [3 - Flashback Versions Query - Me](#3-flashback-versions-query-me)
   * [4 - Flashback Versions query](#4-flashback-versions-query)
- [Section 27 - Hierarchical Consultations](#section-27-hierarchical-consultations)
   * [1 - Hierarchical queries](#1-hierarchical-queries)
   * [2 - Hierarchical queries - Up to Down and Bottom to Up](#2-hierarchical-queries-up-to-down-and-bottom-to-up)
   * [3 - Hierarchical queries using pseudocoluna level](#3-hierarchical-queries-using-pseudocoluna-level)
   * [4 - Formatting the exit of the structure on a tree](#4-formatting-the-exit-of-the-structure-on-a-tree)
   * [5 - suppressing branches (brunches) of the hierarchical structure (tree)](#5-suppressing-branches-brunches-of-the-hierarchical-structure-tree)
   * [6 - Ordering hierarchical SQL](#6-ordering-hierarchical-sql)
   * [Hierarchical queries](#hierarchical-queries)
- [Section 28 - REGEX](#section-28-regex)
   * [1 - Using REGEXP_LIKE](#1-using-regexp_like)
   * [2 - Using REGEXP_Replace](#2-using-regexp_replace)
   * [3 - Using REGEXP_SUBSTR](#3-using-regexp_substr)
   * [4- Using REGEXP_INSTR](#4-using-regexp_instr)
   * [5 - Using REGEXP_COUNT](#5-using-regexp_count)
   * [REGEX](#regex)
- [Section 29 - Temporary Tables](#section-29-temporary-tables)
   * [1 - Temporary Tables](#1-temporary-tables)
   * [Temporary Tables](#temporary-tables)
   * [1 - Globalization - Time Zones](#1-globalization-time-zones)
   * [2 - Globalization - Data Types](#2-globalization-data-types)
   * [3 - Globalization - Functions](#3-globalization-functions)
   * [4 - Conversion functions used with interval](#4-conversion-functions-used-with-interval)
   * [5 - Tz_Offset function](#5-tz_offset-function)
   * [6 - Extract Function](#6-extract-function)
   * [7 - Conversion Functions](#7-conversion-functions)
   * [8 - Conversion Functions](#8-conversion-functions)
   * [Globalization](#globalization)
- [Section 31 - Advanced Sub -Query](#section-31-advanced-sub-query)
   * [1 - Using the clause with](#1-using-the-clause-with)
   * [2 - Update using correlated subconsultures](#2-update-using-correlated-subconsultures)
   * [Advanced Subqueries](#advanced-subqueries)
- [Section 32 - SQL Script Dynamic](#section-32-sql-script-dynamic)
   * [1 - Generating dynamic scripts](#1-generating-dynamic-scripts)
- [Section 33 - Group by Advanced](#section-33-group-by-advanced)
   * [1 - Creating Schema Sales](#1-creating-schema-sales)
   * [2 - Grouping Sets](#2-grouping-sets)
   * [3 - Rollup](#3-rollup)
   * [4 - Cube](#4-cube)
   * [Group by Advanced](#group-by-advanced)
- [Section 34 - Materialized Views](#section-34-materialized-views)
   * [1 - MATERIALIZED VISIONS](#1-materialized-visions)
   * [2 - Types of materialized views](#2-types-of-materialized-views)
   * [3 - FAST REFRESH MATERIALIZED View](#3-fast-refresh-materialized-view)
   * [4 - Complete Refresh Materialized](#4-complete-refresh-materialized)
   * [5 - Force Refresh Materialized View](#5-force-refresh-materialized-view)
   * [6 - Updating materialized views using packages](#6-updating-materialized-views-using-packages)
   * [7 - Scheduling Periodic Updates of Materialized Visions](#7-scheduling-periodic-updates-of-materialized-visions)
   * [MATERIALIZED View](#materialized-view)

<!-- TOC end -->

<!-- TOC --><a name="section-2-installation-of-oracle-database-21c-xe"></a>
## Section 2 - Installation of Oracle Database 21c XE

<!-- TOC --><a name="class-1-download-and-installation-of-oracle-database-21c-xe"></a>
### Class 1 - Download and Installation of Oracle Database 21c XE

```sql
-
- Course - Oracle PL/SQL Specialist: from basic to advanced
-
- Author - Emílio Scudero
-
- Section 02 - PL/SQL Fundamentals - Oracle Installation Database 21c XE
-
- Class 1 - Download and Installation of Oracle Database 21c XE
-

- Download and Installation of Oracle Database 21c XE

1. Select the link: http://otn.oracle.com or https://www.oracle.com/technical-resources

   1.1 Select View Accounts

   1.2 Select Create an Account and complete your registration

   NOTE: If you already have an Oracle account login, select sign in
   
2. Download the latest version of Java Jdk 

   2.1 Select the link: http://otn.oracle.com or https://www.oracle.com/technical-resources
   
   2.2 Select Java Downloads
   
   2.3 Select Java (jdk) for developers
   
   Link: https://www.oracle.com/java/technologies/downloads
   
   2.4 Select Windows Tab
   
   2.5 Select the X64 MSI Installer or X64 Installer link

   2.6 Select Save File
   
3. Java JDK Installation 

   3.1 Right-click: Select the JDK-17_windows-X64_bi.msi => Install file

       Or 

       Right-click: Select the JDK-17_Windows-X64_bi.exe => Run as Administrator file
  
   3.2 Accept the Default options and click Next until the installation is completed
   
   3.3 Configuration of environmental variables 
   
       In Windows: 
          Edit the Variable Path: Add the path to the bin directory of Java
          Create the Java_Home variable: Enter the way to the Java

4. Oracle DataBase 21c XE download 

   4.1 Select the link: http://otn.oracle.com or https://www.oracle.com/technical-resources
   
   4.2 Select Database Download
   
   4.2 Select Database Express Edition
   
   4.3 Select Oracle Database 21c Express Edition for Windows X64
   
   4.4 Accept Oracle License Agreement
   
5. Installation of Oracle Database 21c XE

   5.1 Move the ORAClexe213_win64.zip file for drive C:
   
   5.2 Extract the file to the Oraclexe213_Win64 folder
   
   5.3 In the ORACLEXE213_WIN64 folder:
   
       . Rightly select Setup.exe execute as administrator
	   . Accept the Default options and click Next until the installation is completed
	   
	   Note: Set a simple password (do not use special characters) for SYS (DBA) users, for example: Oracle

6. Configuring Windows Oracle Services for Automatic

   6.1 Access Windows services
  
   6.2 Configure the Oracleservicexe Service for Automatic (Default)
  
   6.3 Configure the OracleoradB21home1Tnslistener for automatic (default) service

  
```
---

<!-- TOC --><a name="class-2-configuring-the-listener-and-tnsnames-creating-and-testing-a-local-connection"></a>
### Class 2 - Configuring the listener and tnsnames - Creating and testing a local connection

```sql
-
- Course - Oracle PL/SQL Specialist: from basic to advanced
-
- Author - Emílio Scudero
-
- Section 02 - PL/SQL Fundamentals - Oracle Installation Database 21c XE
-
- Class 2 - Configuring the listener and tnsnames - creating and testing a local connection
-

- Configuring the listener and tnsnames - creating and testing a local connection

1. Configuring the listener

   1.1 In Windows Go to Network \ Admin folder in the home folder of your 21c Oracle Database installation
   
       Example: C: \ oracledatabase21cxe \ HOMES \ ORADB21HOME1 \ NETWORK \ Admin

   1.2 Make a backup copy of the listener.ore file
   
   1.3 Edit the listener.ora file
   
       Review and if necessary change the listener configuration to (host = localhost):
	   
	   Listener =
				  (Description_list =
					(Description =
					  (Address = (protocol = tcp) (host = localhost) (port = 1521))))
					  (Address = (protocol = IPC) (key = extroc1521))))
					)
				  )
				  
	1.4 Save the change in the listener file.or
	
2. Configuring the Tnsnames.ora file 

   2.1 On Windows Go to Network \ Admin folder in the home folder of your 21c Oracle Database installation
   
       Example: C: \ oracledatabase21cxe \ HOMES \ ORADB21HOME1 \ NETWORK \ Admin

   2.2 Make a backup copy of the Tnsnames.or file
   
   2.3 Edit the Tnsnames.or file
   
       Review and if necessary change all tnsnames settings.Ora for (host = localhost):
	   
	   XE =
			  (Description =
				(Address = (protocol = tcp) (host = localhost) (port = 1521))))
				(Connect_data =
				  (Server = dedicated)
				  (Service_name = xe)
				)
			  )

	   Listener_xe =
		     (Address = (protocol = tcp) (host = localhost) (port = 1521))))
						  
	1.4 Save the change in the Tnsnames.ora file

3. Restarting Windows Oracle and Listener services

   3.1 Stop the service: oracleservicexe
   
      Note: Leave this service configured as automatic
   
   3.2 Stop the Service: Oracleoradb21home1tnslistener
   
       Note: Leave this service configured as automatic
   
   3.3 Start the service again: oracleoDB21home1tnslistener
   
   3.4 Start the service again: oracleservicexe
   
4. Creating and testing a local connection

   4.1 In the Windows Start menu 
       Visit: Oracle - Ora DB21Home1 => Network Configuration Assistant
  
       . Select Local Network Service Name Setup
	     CLICK NEXT
		 
	   . Select Add
	     CLICK NEXT
		 
	   . Service Name: XEPDB1
	     CLICK NEXT
		 
	   . Select the Protocol used: TCP
	     CLICK NEXT
		 
	   . Host name: localhost
         Select Use the standard port 1521
	   	 CLICK NEXT
		 
	   . Yes, take a test
	   	 CLICK NEXT
		 
	   . Click the Change Log-in button 
	     User Name: System
		 Password: Oracle (Enter the password you have defined for SYS and System users at the installation)
		 Click Ok
		 CLICK NEXT
	
       . Network Service Name: XEPDB1
	     CLICK NEXT	
		 
	   . Do you want to configure another network service name? No
	   	 CLICK NEXT	
		 
		 Concluded Network Service Name Configuration!
		 CLICK NEAR
		 
		 Click Finish

5. Connecting to Oracle using the local connection via Oracle SQL*Plus

   5.1 Access the Windows command line 
  
   5.2 Run the command:
   
       sqlplus system/oracle@xepdb1   
   
   5.3 In SQLPLUS Run the following command:
   
       SQL> SELECT SYSDATE FROM DUAL;
	   
	   SQL> Exit
   


  
```
---

<!-- TOC --><a name="section-3-user-settings"></a>
## Section 3 - User Settings

<!-- TOC --><a name="class-3-creating-the-hr-user"></a>
### Class 3 - Creating the HR user

```sql
-
- Course - Oracle PL/SQL Specialist: from basic to advanced
-
- Author - Emílio Scudero
-
- Section 03 - PL/SQL Fundamentals - Installation and configuration of connections in Oracle SQL Developer
-
- Class 3 - Creating the HR user

- Creating the HR user

/*
 In Oracle SQL Developer connect as SYS user using your connection to the SYS user
 Open this script in Oracle SQL Developer and run (F5)
/*

/*
  Configures the session for the Pluggable Database XEPDB1
*/

Alter Session set container = xepdb1;

/*
  Removes the HR user account and removes all its objects in waterfall
*/
Drop user hr Cascade;

/*
  Create the HR user account with the HR password and grants the privileges
*/

Create User HR 
Identified by hr
Default Tablespace Users
TEMPORY TABLESPACE TEMP
Quota unlimited on users
Quota 0 on system;

Grant Connect, Resource to HR;

Grant Create Session, Create View, Create Table, Alter Session, Create Sequence, Create Procedure, Create Trigger to HR;
Grant Create Synonym, Create Database Link, Unlimited Tablespace to HR;
```
---

<!-- TOC --><a name="class-4-creating-a-connection-to-the-hr-user-in-sql-developer"></a>
### Class 4 - Creating a connection to the HR user in SQL Developer

```sql
-
- Course - Oracle PL/SQL Specialist: from basic to advanced
-
- Author - Emílio Scudero
-
- Section 03 - PL/SQL Fundamentals - Installation and configuration of connections in Oracle SQL Developer
-
- Class 4 - Creating a connection to the HR user in SQL Developer

- Creating a connection to the HR user in SQL Developer

1. Creating a connection to the HR user in SQL Developer

   1.1 In SQL Developer
       With the right button, select Oracle Connections => Select new connection

       Name: HR_XEPDB1
	   User Name: HR 
	   Password: HR
	   Assignment: Standard

       Connection Type: Basic
       Host name: localhost
       Door: 1521
       Service Name: XEPDB1
	   
	   Click Test
	   Click Save
	   Click Connect, Enter the HR Password (HR)
	   Click Ok	   
	   
2. Performing a command in the desktop
   
   2.1 Run the command:
   
       SELECT SYSDATE
	   From dual;
    
   2.2 DISCONDACTE
   

```
---

<!-- TOC --><a name="class-5-creating-hr-user-schema-objects"></a>
### Class 5 - Creating HR user Schema objects

```sql
-
- Course - Oracle PL/SQL Specialist: from basic to advanced
-
- Author - Emílio Scudero
-
- Section 03 - PL/SQL Fundamentals - Installation and configuration of connections in Oracle SQL Developer
-
- Class 5 - Creating HR user Schema objects

- Creating HR user Schema objects

/*
 In Oracle SQL Developer connect as HR user using your connection to the HR user
 Open this script in Oracle SQL Developer and run (F5)
/*

/*
  Removes the tables if they already exist
*/


DROP Table Job_History Cascade Constraints;
DROP TABLE DEPARTMENTS CASCADE CONSTRANTS;
Drop Table Employees Cascade Constraints;
DROP Table Jobs Cascade Constraints;
DROP TABLE LOCATIONS CASCADE CONSTRANTS;
DROP TABLE COUNTRIES CASCADE CONSTRANTS;
DROP TABLE REGIONS CASCADE CONSTRANTS;
Drop Sequence Locations_SEQ;
DROP Sequence Departments_SEQ;
Drop Sequence Employees_SEQ;


Alter Session set nls_language = American;
Alter Session set nls_territhy = America;

/*
  Tables Creation
*/

/ * Regions */

Create Table Regions (
  regional_id number constraint regions_id_nn not null,
  region_Name Varchar2 (25)
);

CREATE UNIQUE INDEX REG_ID_PK
On regions (regional_id);

Alter table regions
Add constraint reg_id_pk
Primary Key (region_id);

/ * Countries */

Create Table Countries (
  country_id char (2) constraint country_id_nn not null,
  Country_Name Varchar2 (40),
  regional_id Number, Constraint country_c_id_pk primary key (country_id)
)
Organization Index;

Alter Table Countries
Add constraint country_reg_fk
Foreign Key (region_id)
Regional References (regional_id);

/ * Locations */

Create Table Locations (
  location_id number (4),
  Street_address Varchar2 (40),
  Postal_Code Varchar2 (12),
  City Varchar2 (30) constraint loc_city_nn not null,
  STATE_PROVINCE VARCHAR2 (25),
  Country_id Char (2)
);

CREATE UNIQUE INDEX LOC_ID_PK
On locations (location_id);

Alter table locations
ADD (
    Constraint loc_id_pk primary key (location_id),
    Constraint loc_c_id_fk Foreign Key (country_id) References Countries (country_id)
);

CREATE SEQUENCE LOCATIONS_SEQ
  Start with 3300
  Increment by 100
  Maxvalue 9900
  Nocache
  Nocycle;

/ * Department */


Create Table Departments (
  Department_id Number (4),
  Department_Name Varchar2 (30) constraint dept_name_nn not null,
  Manager_id Number (6),
  Location_id Number (4)
);

CREATE UNIQUE INDEX DEPT_ID_PK
On Department (Department_id);

Alter Table Deportments
ADD (
  Constraint dept_id_pk primary key (department_id),
  CONSTRINT DEPT_LOC_FK Foreign Key (location_id) REFERENCE LOCATIONS (location_id)
);

CREATE SEQUENCE DEPARTMENTS_SEQ
  Start with 280
  Increment by 10
  Maxvalue 9990
  Nocache
  Nocycle;

/ * Jobs */

Create Table Jobs (
  Job_id Varchar2 (10),
  JOB_TITLE VARCHAR2 (35) CONSTRINT JOB_TITLE_NN NOT NULL,
  Min_Salarry Number (6),
  Max_Salarry Number (6)
);

Create Unique Index Job_id_PK
On Jobs (Job_id);

Alter Table Jobs
ADD (
  Constraint job_id_pk primary key (job_id)
);


/ * Employees */

Create Table Employees (
  Employee_id Number (6),
  First_Name Varchar2 (20),
  Last_Name Varchar2 (25) constraint emp_last_name_nn not null,
  EMAIL VARCHAR2 (25) CONSTRINT EMP_Email_NN NOT NULL,
  Phone_number Varchar2 (20),
  HIRE_DATE DATE CONSTRINT EMP_HIRE_DATE_NN NOT NULL,
  job_id varchar2 (10) constraint emp_job_nn not null,
  SALARY NUMBER (8.2),
  Commission_PCT NUMBER (2,2),
  Manager_id Number (6),
  Department_id Number (4),
  Constraint emp_salary_min check (salary> 0),
  Constraint emp_email_uk unique (email)
);

Create Unique Index Emp_emp_id_PK
On Employees (Employee_id);


Alter Table Employees
ADD (
  Constraint emp_emp_id_pk
    Primary Key (Employee_id),
  Constraint emp_dept_fk
    Foreign Key (department_id)
  Constraint emp_job_fk
    Foreign Key (Job_id) Jobs References (Job_id),
  Constraint emp_manager_fk
    Foreign Key (manager_id) References Employees (Employee_id)
);

/ * Alter tables */

Alter Table Deportments
ADD (
  Constraint dept_mgr_fk
    Foreign Key (manager_id)
    References Employees (Employee_id)
);

CREATE SEQUENCE EMPLOYEES_SEQ
  Start with 207
  Increment by 1
  Nocache
  Nocycle;


/ * Job History */
Create Table Job_History (
  Employee_id Number (6) constraint jhist_employee_nn not null,
  START_DATE DATE CONSTRINT JHist_start_date_nn Not null,
  End_Date Date Constraint Jhist_end_date_nn Not null,
  job_id varchar2 (10) constraint jhist_job_nn not null,
  Department_id Number (4),
  Constraint jhist_date_interval check (end_date> start_date)
);

Cream unique index jhist_emp_id_st_date_pk
On Job_History (Employee_id, Start_date);

Alter table job_history
ADD (
  Constraint jhist_emp_id_st_date_pk
    Primary Key (employee_id, start_date),
  Constraint jhist_job_fk
    Foreign Key (Job_id) Jobs References,
  Constraint jhist_emp_fk
    Foreign Key (Employee_id) References Employees,
  Constraint jhist_dept_fk
    Foreign Key (Department_id)
);



Create or replace View EMP_Details_View
  (Employee_id,
   job_id,
   manager_id,
   department_id,
   location_id,
   country_id,
   First_Name,
   Last_Name,
   SALARY,
   commission_pct,
   department_name,
   job_title,
   City,
   STATE_PROVINCE,
   country_name,
   region_name)
TO THE
Select
  e.employee_id,
  e.job_id,
  e.manager_id,
  e.department_id,
  D.LOCATION_ID,
  L.COUNTRY_ID,
  E.FIRST_NAME,
  e.last_name,
  E.SARARY,
  e.comMission_PCT,
  D.Department_Name,
  j.job_title,
  l.city,
  L.state_Province,
  c.country_name,
  R.region_name
From
  Employees and
  Inner Join Departments D On E.Department_id = D.Department_id
  Inner Join Jobs J on J.job_id = e.job_id
  Inner Join Locations L On D.location_id = L.location_id
  Inner Join Countries C On L.Country_id = C.Country_id
  Inner Join Regions R On C.region_id = R.region_id
With read only;

Commit;

```
---

<!-- TOC --><a name="class-6-populating-the-hr-user-schema-objects"></a>
### Class 6 - Populating the HR user Schema objects

```sql
-
- Course - Oracle PL/SQL Specialist: from basic to advanced
-
- Author - Emílio Scudero
-
- Section 03 - PL/SQL Fundamentals - Installation and configuration of connections in Oracle SQL Developer
-
- Class 6 - Populating the HR user Schema objects - Populating HR user Schema objects

/*
 In Oracle SQL Developer connect as HR user using your connection to the HR user
 Open this script in Oracle SQL Developer and run (F5)
/*

/*
  Popula the tables of Schema HR
*/

Alter Session set nls_language = American;

INSERT INTO REGIONS (regional_id, region_name) VALUES (1, 'Europe');
INSERT INTO REGIONS (regional_id, regional_name) VALUES (2, 'AMERICAS');
INSERT INTO REGIONS (regional_id, region_name) VALUES (3, 'ASIA');
INSERT INTO REGIONS (regional_id, regional_name) VALUES (4, Middle East and Africa ');


INSERT INTO Countries (country_id, country_name, region_id) VALUES ('IT', 'ITALY', 1);
INSERT INTO COUNTRIES (country_id, country_name, region_id) VALUES ('JP', 'Japan', 3);
INSERT INTO COUNTRIES (country_id, country_name, region_id) VALUES ('US', 'United States of America', 2);
INSERT INTO Countries (country_id, country_name, region_id) VALUES ('ca', 'canada', 2);
INSERT INTO COUNTRIES (country_id, country_name, region_id) VALUES ('CN', 'China', 3);
INSERT INTO Countries (country_id, country_name, region_id) VALUES ('in', 'India', 3);
INSERT INTO COUNTRIES (country_id, country_name, region_id) VALUES ('Au', 'Australia', 3);
INSERT INTO COUNTRIES (country_id, country_name, region_id) VALUES ('ZW', 'Zimbabwe', 4);
INSERT INTO Countries (country_id, country_name, region_id) VALUES ('SG', 'Singapore', 3);
INSERT INTO COUNTRIES (country_id, country_name, region_id) VALUES ('UK', 'United Kingdom', 1);
INSERT INTO Countries (country_id, country_name, region_id) VALUES ('FR', 'France', 1);
INSERT INTO COUNTRIES (country_id, country_name, region_id) VALUES ('de', 'Germany', 1);
INSERT INTO COUNTRIES (country_id, country_name, region_id) VALUES ('ZM', 'Zambia', 4);
INSERT INTO COUNTRIES (country_id, country_name, region_id) VALUES ('EG', 'Egypt', 4);
INSERT INTO COUNTRIES (country_id, country_name, region_id) VALUES ('BR', 'Brazil', 2);
INSERT INTO COUNTRIES (country_id, country_name, region_id) VALUES ('CH', 'Switzerland', 1);
INSERT INTO COUNTRIES (country_id, country_name, region_id) VALUES ('NL', 'NETHERLANDS', 1);
INSERT INTO Countries (country_id, country_name, region_id) VALUES ('MX', 'Mexico', 2);
INSERT INTO Countries (country_id, country_name, region_id) VALUES ('KW', 'KUWAIT', 4);
INSERT INTO Countries (country_id, country_name, region_id) VALUES ('IL', 'Israel', 4);
INSERT INTO Countries (country_id, country_name, region_id) VALUES ('DK', 'Denmark', 1);
INSERT INTO Countries (country_id, country_name, region_id) VALUES ('ml', 'Malaysia', 3);
INSERT INTO COUNTRIES (country_id, country_name, region_id) VALUES ('NG', 'Nigeria', 4);
INSERT INTO Countries (country_id, country_name, region_id) VALUES ('AR', 'Argentina', 2);
INSERT INTO Countries (country_id, country_name, region_id) VALUES ('BE', 'BELGIUM', 1);


INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(1000, '1297 via glue di rie', '00989', 'Rome', null, 'it');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(1100, '93091 Calle Della Testa', '10934', 'Venice', null, 'it');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(1200, '2017 Shinjuku-Ku', '1689', 'Tokyo', 'Tokyo Prefecture', 'JP');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(1300, '9450 Kamiya-Cho', '6823', 'Hiroshima', null, 'JP');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(1400, '2014 Jabberwocky RD', '26192', 'Southlake', 'Texas', 'US');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(1500, '2011 interior Blvd', '99236', 'South San Francisco', 'California', 'US');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(1600, '2007 Zagora St', '50090', 'South Brunswick', 'New Jersey', 'US');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(1700, '2004 Charade RD', '98199', 'Seattle', 'Washington', 'US');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(1800, '147 Spadina Ave', 'M5V 2L7', 'Toronto', 'Ontario', 'Ca');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(1900, '6092 Boxwood St', 'YSW 9T2', 'WhiteHorse', 'Yukon', 'Ca');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(2000, '40 -5-12 Laogianggen ',' 190518 ',' Beijing ', null,' cn ');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(2100, '1298 Vileparle (E)', '490231', 'Bombay', 'Maharashtra', 'In'); INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(2200, '12 -98 Victoria Street ',' 2901 ',' Sydney ',' New South Wales', 'Au');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(2300, '198 Clementi North', '540198', 'Singapore', null, 'SG');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(2400, '8204 Arthur St', null, 'London', null, 'uk');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(2500, 'Magdalen Center, The Oxford Science Park', 'Ox9 9ZB', 'Oxford', 'Oxford', 'UK');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(2600, '9702 Chester Road', '09629850293', 'Stretford', 'Manchester', 'UK');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(2700, 'Schwanthalestr. 7031', '80925', 'Munich', 'Bavaria', 'De');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(2800, 'Rua Frei Caneca 1360', '01307-002', 'Sao Paulo', 'Sao Paulo', 'br');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(2900, '20 rue des corps-saints', '1730', 'geneva', 'geneve', 'ch');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(3000, 'murtenstrasse 921', '3095', 'bern', 'be', 'ch');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(3100, 'Pieter Breughelstraat 837', '3029sk', 'utrecht', 'utrecht', 'nl');

INSERT INTO Locations (location_id, street_address, postal_code, city, state_province, country_id) values
(3200, 'Mariano Escobedo 9991', '11932', 'Mexico City', 'Federal District,', 'MX');



Alter Table Departments Disable Constraint Depp_MGR_FK;

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(10, 'Administration', 200, 1700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(20, 'marketing', 201, 1800);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(30, 'Purchasing', 114, 1700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(40, 'Human Resources', 203, 2400);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(50, 'shipping', 121, 1500);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(60, 'IT', 103, 1400);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(70, 'Public Relations', 204, 2700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(80, 'Sales', 145, 2500);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(90, 'Executive', 100, 1700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(100, 'financial', 108, 1700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(110, 'accounting', 205, 1700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(120, 'Treasury', null, 1700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(130, 'corporate tax', null, 1700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(140, 'Control and Credit', null, 1700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(150, 'Shareholder Services', Null, 1700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(160, 'Benefits', Null, 1700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(170, 'manufacturing', null, 1700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(180, 'Construction', null, 1700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(190, 'Contracting', Null, 1700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(200, 'Operations', Null, 1700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(210, 'IT Support', Null, 1700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(220, 'NOC', null, 1700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(230, 'IT HELPDESK', NULL, 1700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES (240, 'Government Sales', Null, 1700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(250, 'Retail Sales', Null, 1700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(260, 'Recruiting', Null, 1700);

INSERT INTO DEPARTMENTS (Department_id, Department_Name, Manager_id, Location_id) VALUES
(270, 'Payroll', null, 1700);



INSERT INTO JOBS (job_id, job_title, min_sarly, max_sarly) values
('Ad_pres', 'President', 20080, 40000);

INSERT INTO JOBS (job_id, job_title, min_sarly, max_sarly) values
('AD_VP', 'Administration Vice President', 15000, 30000);

INSERT INTO JOBS (job_id, job_title, min_sarly, max_sarly) values
('Ad_ast', 'Administration Assistant', 3000, 6000);

INSERT INTO JOBS (job_id, job_title, min_sarly, max_sarly) values
('Fi_mgr', 'financial manager', 8200, 16000);

INSERT INTO JOBS (job_id, job_title, min_sarly, max_sarly) values
('Fi_account', 'accountant', 4200, 9000);

INSERT INTO JOBS (job_id, job_title, min_sarly, max_sarly) values
('AC_MGR', 'Accounting Manager', 8200, 16000);

INSERT INTO JOBS (job_id, job_title, min_sarly, max_sarly) values
('Ac_account', 'public accountant', 4200, 9000);

INSERT INTO JOBS (job_id, job_title, min_sarly, max_sarly) values
('Sa_Man', 'Sales Manager', 10000, 20080);

INSERT INTO JOBS (job_id, job_title, min_sarly, max_sarly) values
('Sa_REP', 'Sales Representative', 6000, 12008);

INSERT INTO JOBS (job_id, job_title, min_sarly, max_sarly) values
('Pu_Man', 'Purchasing Manager', 8000, 15000);

INSERT INTO JOBS (job_id, job_title, min_sarly, max_sarly) values
('Pu_clerk', 'Purchasing Clerk', 2500, 5500);

INSERT INTO JOBS (job_id, job_title, min_sarly, max_sarly) values
('St_man', 'Stock Manager', 5500, 8500);

INSERT INTO JOBS (job_id, job_title, min_sarly, max_sarly) values
('St_clerk', 'Stock Clerk', 2008, 5000);

INSERT INTO JOBS (job_id, job_title, min_sarly, max_sarly) values
('Sh_clerk', 'Shipping Clerk', 2500, 5500);

INSERT INTO JOBS (job_id, job_title, min_sarly, max_sarly) values
('IT_PROG', 'Programmer', 4000, 10000);

INSERT INTO JOBS (job_id, job_title, min_sarly, max_sarly) values
('Mk_man', 'marketing manager', 9000, 15000);

INSERT INTO JOBS (job_id, job_title, min_sarly, max_sarly) values
('Mk_rep', 'representative marketing', 4000, 9000);

INSERT INTO JOBS (job_id, job_title, min_sarly, max_sarly) values
('HR_REP', 'Human Resources Representative', 4000, 9000);

INSERT INTO JOBS (job_id, job_title, min_sarly, max_sarly) values
('Pr_REP', 'Public Relations Representative', 4500, 10500);



INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(100, 'Steven', 'King', 'Sking', '515.123.4567', to_date ('17 -06-2003 '', 'dd-myyy'), 'ad_pres', 24000, null, null, 90);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(101, 'Neena', 'Kochhar', 'Nkochhar', '515.123.4568', to_date ('21 -09-2005 ',' dd-m-yyy '),' ad_vp ', 17000, null, 100, 90);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(102, 'lex', 'de haan', 'ldehaan', '515.123.4569', to_date ('13 -01-2001 '', 'dd-myyy'), 'ad_vp', 17000, null, 100 , 90);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(103, 'Alexander', 'Hunold', 'Ahunold', '590.423.4567' ', to_date ('03 -01-2006', 'dd-myyy'), 'it_prog', 9000, null, 102, 60);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(104, 'Bruce', 'Ernst', 'Bernst', '590.423.4568', to_date ('21 -05-2007 '', 'dd-m-yyy'), 'it_prog', 6000, null, 103, 60);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(105, 'David', 'Austin', 'Daustin', '590.423.4569', to_date ('25 -06-2005 '', 'dd-myyy'), 'it_prog', 4800, null, 103, 60);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(106, 'Valli', 'Pataballa', 'vpatabal', '590.423.4560', to_date ('05 -02-2006 ',' dd-myyy '),' it_prog ', 4800, null, 103, 60);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(107, 'Diana', 'Lorentz', 'Dlorentz', '590.423.5567' ', to_date ('07 -02-2007' ',' dd-m-yyyy '),' it_prog ', 4200, null, 103, 60); INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(108, 'Nancy', 'Greenberg', 'Ngreenbe', '515.124.4569', to_date ('17 -08-2002 '', 'dd-myyy'), 'fi_mgr', 12008, null, 101, 100);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(109, 'Daniel', 'faviet', 'dfaviet', '515.124.4169', to_date ('16 -08-2002 '', 'dd-myyy'), 'fi_account', 9000, null, 108, 100);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(110, 'John', 'Chen', 'JCHEN', '515.124.4269', to_date ('28 -09-2005 '', 'dd-mm-yyy'), 'fi_account', 8200, null, 108, 100);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
. 100);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(112, 'Jose Manuel', 'Urman', 'Jmurman', '515.124.4469', to_date ('07 -03-2006 '', 'dd-mm-yyyy'), 'fi_account', 7800, null, 108 , 100);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(113, 'LUIS', 'POPP', 'LPOPP', '515.124.4567', to_date ('07 -12-2007 '', 'dd-mm-yyy'), 'fi_account', 6900, null, 108, 100);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(114, 'den', 'ramphaeely', 'drapheal', '515.127.4561', to_date ('07 -12-2002 ',' dd-myyy '),' p_man ', 11000, null, 100, 30);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(115, 'Alexander', 'Khoo', 'Akhoo', '515.127.4562', to_date ('18 -05-2003 '', 'dd-m-yyy'), 'Pu_clerk', 3100, null, 114, 30);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(116, 'shelli', 'baida', 'sbaida', '515.127.4563', to_date ('24-2005 '', 'dd-m-yyyy'), 'p_clerk', 2900, null, 114, 30);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(117, 'Sigal', 'Tobias', 'Stobias', '515.127.4564' ', to_date ('24 -07-2005', 'dd-m-yyy'), 'PU_Clerk', 2800, null, 114, 30);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(118, 'Guy', 'Himuro', 'Ghimuro', '515.127.4565', to_date ('15 -11-2006 '', 'dd-mm-yyy'), 'Pu_clerk', 2600, null, 114, 30);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(119, 'Karen', 'Colmenares', 'Kcolmena', '515.127.4566', to_date ('10 -08-2007 '', 'dd-m-yyyy'), 'PU_Clerk', 2500, null, 114, 30);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(120, 'Matthew', 'Weiss', 'Mweiss', '650.123.1234', to_date ('18 -07-2004 '', 'DD-MM-YYY'), 'St_Man', 8000, null, 100, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(121, 'Adam', 'Fripp', 'AFRIPP', '650.123.2234', to_date ('10 -04-2005 '', 'dd-mm-yyy'), 'St_Man', 8200, null, 100, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(122, 'Payam', 'Kaufling', 'pkauflin', '650.123.3234' ', to_date ('01 -05-2003', 'dd-myyy'), 'st_man', 7900, null, 100, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(123, 'Shanta', 'Vollman', 'Svoltan', '650,123.4234', to_date ('10 -10-2005 ',' dd-mm-yyy '),' St_Man ', 6500, null, 100, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(124, 'Kevin', 'Mourgos',' Kmourgos', '650.123.5234' ', to_date ('16 -11-2007' ',' dd-myyy '),' st_man ', 5800, null, 100, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES (125, 'Julia', 'Nayer', 'Jnayer', '650,124.1214', to_date ('16 -07-2005 ',' dd-mm-yyy '),' St_clerk ', 3200, null, 120, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(126, 'Irene', 'mikkilineni', 'imikkili', '650.1224' ', to_date ('28 -09-2006', 'dd-mm-yyyy'), 'st_clerk', 2700, null, 120, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(127, 'James', 'Landry', 'Jlandry', '650,124.1334', to_date ('14-01-2007 '', 'dd-m-yyyy'), 'St_clerk', 2400, null, 120, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(128, 'Steven', 'Markle', 'Smarkle', '650.124.1434', to_date ('08 -03-2008 '', 'dd-mm-yyy'), 'st_clerk', 2200, null, 120, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(129, 'Laura', 'BISOT', 'LBISSOT', '650.124.5234', to_date ('20 -08-2005 '', 'dd-myyy'), 'St_clerk', 3300, null, 121, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(130, 'Mozhe', 'Atkinson', 'Matkins',' 650.124.6234 ', to_date ('30 -10-2005', 'dd-mm-yyy'), 'St_clerk', 2800, null, 121, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(131, 'James',' Marlow ',' Jamrlow ',' 650.124.7234 ', to_date ('16 -02-2005', 'dd-mm-yyy'), 'St_clerk', 2500, null, 121, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(132, 'TJ', 'Olson', 'Tjolson', '650,124,8234', to_date ('10 -04-2007 '', 'dd-mm-yyy'), 'St_clerk', 2100, null, 121, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(133, 'Jason', 'Mallin', 'Jmallin', '650.127.1934' ', to_date ('14 -06-2004' ',' dd-mm-yyy '),' St_clerk ', 3300, null, 122, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(134, 'Michael', 'Rogers',' Mrogers', '650.127.1834', to_date ('26 -08-2006 ',' DD-MM-YYY '),' St_clerk ', 2900, null, 122, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(135, 'ki', 'gee', 'kgee', '650.127.1734', to_date ('12-2007 ',' dd-m-yyyy '),' st_clerk ', 2400, null, 122, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(136, 'Hazel', 'Philtanker', 'Hphiltan', '650.127.1634', to_date ('06 -02-2008 ',' dd-m-yyyy '),' St_clerk ', 2200, null, 122, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(137, 'Renske', 'Ladwig', 'Rladwig', '650.121.1234' ', to_date ('14 -07-2003' ',' dd-myyy '),' st_clerk ', 3600, null, 123, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(138, 'STEPHEN', 'STILES', 'SSTILES', '650.121.2034', TO_DATE ('26 -10-2005 ',' DD-MM-YYY '),' St_clerk ', 3200, null, 123, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(139, 'John', 'SEO', 'Jseo', '650,121.2019', to_date ('12 -02-2006 ',' dd-myyy '),' St_clerk ', 2700, null, 123, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(140, 'Joshua', 'Patel', 'Jpatel', '650.121.1834', to_date ('06 -04-2006 ',' dd-m-yyyy '),' St_clerk ', 2500, null, 123, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(141, 'Trenna', 'Rajs',' Trajs', '650.121.8009', to_date ('17 -10-2003 ',' dd-m-yyy '),' St_clerk ', 3500, null, 124, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(142, 'Curtis',' Davies', 'CDAVIES', '650,121.2994', to_date ('29 -01-2005 ',' dd-mm-yyy '),' st_clerk ', 3100, null, 124, 50); INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(143, 'Randall', 'Matos',' rmatos', '650,121,2874' ', to_date ('15 -03-2006' ',' dd-myyy '),' St_clerk ', 2600, null, 124, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(144, 'Peter', 'Vargas',' Pvargas', '650,121.2004', to_date ('09 -07-2006 ',' dd-myyy '),' St_clerk ', 2500, null, 124, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(145, 'John', 'Russell', 'Jrussel', '011.44.1344.429268' ', to_date ('01 -10-2004' ',' dd-myyy '),' sa_man ', 14000, .4, 100 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(146, 'Karen', 'Partners', 'Kpartner', '011.44.1344.467268' ', to_date ('05 -01-2005', 'dd-myyy'), 'sa_man', 13500, .3, 100 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(147, 'Alberto', 'Errazuriz', 'Aerrazur', '011.44.1344.429278' ', to_date ('10 -03-2005', 'dd-myyy'), 'sa_man', 12000, .3, 100 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(148, 'Gerald', 'Cambrault', 'Gcambrau', '011.44.1344.619268' ', to_date ('15 -10-2007' ',' dd-myyy '),' sa_man ', 11000, .3, 100 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(149, 'Eleni', 'Zlotkey', 'Ezlotkey', '011.44.1344.429018' ', to_date ('29 -01-2008', 'dd-myyy'), 'sa_man', 10500, .2, 100 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(150, 'Peter', 'Tucker', 'Ptucker', '011.44.1344.129268', to_date ('30 -01-2005 ',' dd-m-yyyy '),' sa_rep ', 10000, .3, 145 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(151, 'David', 'Bernstein', 'Dbernste', '011.44.1344.345268' ', to_date ('24 -03-2005', 'dd-myyy'), 'sa_rep', 9500, .25, 145 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(152, 'Peter', 'Hall', 'Phall', '011.44.1344.478968', to_date ('20 -08-2005 ',' dd-m-yyyy '),' sa_rep ', 9000, .25, 145 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(153, 'Christopher', 'Olsen', 'Colsen', '011.44.1344.498718' ', to_date ('30 -03-2006', 'dd-myyy'), 'sa_rep', 8000, .2, 145 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(154, 'Nanette', 'Cambrault', 'Ncambrau', '011.44.1344.987668' ', to_date ('09 -12-2006', 'dd-m-yyy'), 'sa_rep', 7500, .2, 145 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(155, 'oliver', 'tuvault', 'otuvault', '011.44.1344.486508' ', to_date ('23 -11-2007', 'dd-myyy'), 'sa_rep', 7000, .15, 145 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(156, 'Janette', 'King', 'Jking', '011.44.1345.429268', to_date ('30 -01-2004 '', 'dd-myyy'), 'sa_rep', 10000, .35, 146 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(157, 'Patrick', 'Sully', 'psully', '011.44.1345.929268', to_date ('04 -03-2004 '', 'dd-myyy'), 'sa_rep', 9500, .35, 146, 146 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(158, 'allan', 'mcewen', 'amcewen', '011.44.1345.829268' ', to_date ('01 -08-2004' ',' dd-myyy '),' sa_rep ', 9000, .35, 146 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(159, 'Lindsey', 'Smith', 'Lsmith', '011.44.1345.729268' ', to_date ('10 -03-2005', 'dd-myyy'), 'sa_rep', 8000, .3, 146 , 80); INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(160, 'Louise', 'Doran', 'Ldoran', '011.44.1345.629268', to_date ('15 -12-2005 ',' dd-m-yyyy '),' sa_rep ', 7500, .3, 146 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(161, 'Sarath', 'Sewall', 'Ssewall', '011.44.1345.529268' ', to_date ('03 -11-2006', 'dd-myyy'), 'sa_rep', 7000, .25, 146 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(162, 'Clara', 'Vishney', 'Cvishney', '011.44.1346.129268' ', to_date ('11 -11-2005', 'dd-m-yyy'), 'sa_rep', 10500, .25, 147 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(163, 'Danielle', 'Greene', 'dgreene', '011.44.1346.229268' ', to_date ('19 -03-2007', 'dd-myyy'), 'sa_rep', 9500, .15, 147 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(164, 'mattea', 'marvins', 'mmarvins', '011.44.1346.329268' ', to_date ('24 -01-2008', 'dd-myyy'), 'sa_rep', 7200, .10, 147 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(165, 'David', 'Lee', 'Dlee', '011.44.1346.529268', to_date ('23 -02-2008 ',' dd-m-yyyy '),' sa_rep ', 6800, .1, 147 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(166, 'Sunday', 'Ande', 'Sande', '011.44.1346.629268', to_date ('24 -03-2008 ',' dd-myyy '),' sa_rep ', 6400, .10, 147 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(167, 'amit', 'band', 'abanda', '011.44.1346.729268', to_date ('21 -04-2008 ',' dd-myyy '),' sa_rep ', 6200, .10, 147 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(168, 'Lisa', 'Ozer', 'LOZER', '011.44.1343.929268', to_date ('11 -03-2005 ',' dd-myyy '),' sa_rep ', 11500, .25, 148 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(169, 'Harrison', 'Bloom', 'Hbloom', '011.44.1343.829268' ', to_date ('23 -03-2006', 'dd-myyy'), 'sa_rep', 10000, .20, 148 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(170, 'Tayler', 'Fox', 'TFOX', '011.44.1343.729268', to_date ('24 -01-2006 ',' dd-m-yyyy '),' sa_rep ', 9600, .20, 148 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(171, 'William', 'Smith', 'Wsmith', '011.44.1343.629268' ', to_date ('23 -02-2007', 'dd-myyy'), 'sa_rep', 7400, .15, 148 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(172, 'Elizabeth', 'Bates',' ebates', '011.44.1343.529268' ', to_date ('24 -03-2007' ',' dd-myyy '),' sa_rep ', 7300, .15, 148 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(173, 'Sundita', 'Kumar', 'Skumar', '011.44.1343.329268' ', to_date ('21 -04-2008', 'dd-myyy'), 'sa_rep', 6100, .10, 148 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(174, 'Ellen', 'Abel', 'Eabel', '011.44.1644.429267' ', to_date ('11 -05-2004' ',' dd-myyy '),' sa_rep ', 11000, .30, 149 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(175, 'Alyssa', 'Hutton', 'Ahutton', '011.44.1644.429266' ', to_date ('19 -03-2005', 'dd-myyy'), 'sa_rep', 8800, .25, 149 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(176, 'Jonathon', 'Taylor', 'Jtaylor', '011.44.1644.429265' ', to_date ('24 -03-2006' ',' dd-myyy '),' sa_rep ', 8600, .20, 149 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES (177, 'Jack', 'Livingston', 'Jlivings', '011.44.1644.429264' ', to_date ('23 -04-2006', 'dd-myyy'), 'sa_rep', 8400, .20, 149 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(178, 'Kimberely', 'Grant', 'Kgrant', '011.44.1644.429263' ', to_date ('24 -05-2007', 'dd-myyy'), 'sa_rep', 7000, .15, 149 , Null);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(179, 'Charles', 'Johnson', 'cjohnson', '011.44.1644.429262' ', to_date ('04 -01-2008', 'dd-myyy'), 'sa_rep', 6200, .10, 149 , 80);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(180, 'Winston', 'Taylor', 'Wtaylor', '650.507.9876', to_date ('24 -01-2006 '', 'dd-mm-yyy'), 'sh_clerk', 3200, null, 120, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(181, 'Jean', 'Fleaur', 'Jfleaur', '650.507.9877', to_date ('23 -02-2006 '', 'dd-mm-yyyy'), 'sh_clerk', 3100, null, 120, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(182, 'Martha', 'Sullivan', 'Msulliva', '650.507.9878', to_date ('21 -06-2007 '', 'dd-myyy'), 'sh_clerk', 2500, null, 120, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(183, 'Girard', 'Geoni', 'GGEONI', '650.507.9879', to_date ('03 -02-2008 ',' dd-myyy '),' sh_clerk ', 2800, null, 120, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(184, 'Nandita', 'Sarchand', 'Ronschan', '650.509.1876', to_date ('27 -01-2004 '', 'dd-myyy'), 'sh_clerk', 4200, null, 121, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(185, 'Alexis', 'Bull', 'Abull', '650.509.2876', to_date ('20 -02-2005 '', 'dd-m-yyyy'), 'sh_clerk', 4100, null, 121, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(186, 'Julia', 'Dellinger', 'Jdelling', '650.509.3876', to_date ('24 -06-2006 '', 'dd-mm-yyy'), 'sh_clerk', 3400, null, 121, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(187, 'Anthony', 'Cabrio', 'Enter', '650.509.4876', to_date ('07 -02-2007 '', 'dd-m-yyyy'), 'sh_clerk', 3000, null, 121, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(188, 'Kelly', 'Chung', 'Kchung', '6505.1876', to_date ('14 -06-2005 ',' dd-m-yyyy '),' sh_clerk ', 3800, null, 122, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(189, 'Jennifer', 'Dilly', 'Jdilly', '6505.2876', to_date ('13 -08-2005 ',' dd-myyy '),' sh_clerk ', 3600, null, 122, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(190, 'timothy', 'gates',' tgates', '6505.3876', to_date ('11 -07-2006 ',' dd-mm-yyy '),' sh_clerk ', 2900, null, 122, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
. 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(192, 'Sarah', 'Bell', 'Sbell', '650.501.1876', to_date ('04-02-2004 '', 'dd-myyy'), 'sh_clerk', 4000, null, 123, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(193, 'Britney', 'Everett', 'Beverett', '6501.2876', to_date ('03 -03-2005 '', 'dd-myyy'), 'sh_clerk', 3900, null, 123, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(194, 'Samuel', 'McCain', 'SMCCAIN', '650.501.3876', to_date ('01 -07-2006 '', 'dd-myyy'), 'sh_clerk', 3200, null, 123, 50); INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(195, 'vance', 'Jones', 'vjones', '6501.4876', to_date ('17 -03-2007 '', 'dd-m-yyyy'), 'sh_clerk', 2800, null, 123, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(196, 'Alana', 'Walsh', 'Awalsh', '650.507.9811', to_date ('24 -04-2006 ',' DD-MM-YYY '),' SH_Clerk ', 3100, null, 124, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(197, 'Kevin', 'Feeney', 'Kfeeney', '650.507.9822', to_date ('23 -05-2006 '', 'dd-myyy'), 'sh_clerk', 3000, null, 124, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(198, 'Donald', 'Oconnell', 'Doconnel', '650.507.9833', to_date ('21 -06-2007 '', 'dd-mm-yyyy'), 'sh_clerk', 2600, null, 124, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(199, 'Douglas',' Grant ',' Dgrant ',' 650.507.9844 ', to_date ('13 -01-2008', 'dd-m-yyyy'), 'sh_clerk', 2600, null, 124, 50);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(200, 'Jennifer', 'Whalen', 'Jwhalen', '515.123.444' ', to_date ('17 -09-2003', 'dd-m-yyyy'), 'ad_ast', 4400, null, 101, 10);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(201, 'Michael', 'Hartstein', 'Mhartte', '515.123.5555', to_date ('17 -02-2004 '', 'dd-m-yyyy'), 'mk_man', 13000, null, 100, 20);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(202, 'Pat', 'Fay', 'pfay', '603,123,6666', to_date ('17 -08-2005 ',' dd-m-yyyy '),' mk_rep ', 6000, null, 201, 20);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(203, 'Susan', 'Mavris',' Smavris', '515.123.7777', to_date ('07-06-2002 ',' dd-mm-yyyy '),' hr_rep ', 6500, null, 101, 40);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(204, 'Hermann', 'baer', 'hbaer', '515.123.8888', to_date ('07-06-2002 '', 'dd-mm-yyy'), 'pr_rep', 10000, null, 101, 70);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(205, 'Shelley', 'Higgins',' Shiggins', '515.123.8080', to_date ('07 -06-2002 ',' dd-m-yyy '),' ac_mgr ', 12008, null, 101, 110);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, FIRST_NAME, LAST_NAME, EMAIL, PHONE_NUMBER, HIRE_DATE, JOB_ID, SALARY, COMMISSON_PCT, MANAGER_ID, DEPARTMENT_ID) VALUES
(206, 'William', 'Gietz', 'Wgietz', '515.123.8181' ', to_date ('07 -06-2002', 'dd-myyy'), 'ac_account', 8300, null, 205, 110);


INSERT INTO Job_History (Employee_id, Start_date, End_date, Job_id, Department_id)
VALUES (102, TO_DATE ('13 -01-2001 ',' DD-MM-YYY '), TO_DATE ('24 -07-2006', 'DD-MM-YYY'), 'it_Prog', 60);

INSERT INTO Job_History (Employee_id, Start_date, End_date, Job_id, Department_id)
VALUES (101, TO_DATE ('21 -09-1997 ',' DD-MM-YYY '), to_date ('27 -10-2001', 'dd-myyy'), 'ac_account', 110);

INSERT INTO Job_History (Employee_id, Start_date, End_date, Job_id, Department_id)
VALUES (101, TO_DATE ('28 -10-2001 ',' DD-MM-YYY '), to_date ('15 -03-2005', 'dd-myyy'), 'ac_mgr', 110);

INSERT INTO Job_History (Employee_id, Start_date, End_date, Job_id, Department_id)
VALUES (201, TO_DATE ('17 -02-2004 ',' DD-MM-YYY '), TO_DATE ('19 -12-2007', 'DD-MM-YYY'), 'mk_rep', 20);

INSERT INTO Job_History (Employee_id, Start_date, End_date, Job_id, Department_id)
VALUES (114, TO_DATE ('24 -03-2006 ',' DD-MM-YYY '), TO_DATE ('31 -12-2007', 'DD-MM-YYY'), 'St_clerk', 50);

INSERT INTO Job_History (Employee_id, Start_date, End_date, Job_id, Department_id)
VALUES (122, TO_DATE ('01 -01-2007 ',' DD-MM-YYY '), TO_DATE ('31 -12-2007', 'DD-MM-YYY'), 'St_clerk', 50);

INSERT INTO Job_History (Employee_id, Start_date, End_date, Job_id, Department_id)
VALUES (200, TO_DATE ('17 -09-1995 ',' DD-MM-YYY '), To_Date ('17 -06-2001', 'DD-MM-YYY'), 'ad_ast', 90);

INSERT INTO Job_History (Employee_id, Start_date, End_date, Job_id, Department_id)
VALUES (176, TO_DATE ('24 -03-2006 ',' DD-MM-YYY '), to_date ('31 -12-2006', 'dd-myyy'), 'sa_rep', 80);

INSERT INTO Job_History (Employee_id, Start_date, End_date, Job_id, Department_id) VALUES (176, TO_DATE ('01 -01-2007 ',' DD-MM-YYY '), TO_DATE ('31 -12-2007', 'DD-MYYY'), 'sa_man', 80);

INSERT INTO Job_History (Employee_id, Start_date, End_date, Job_id, Department_id)
VALUES (200, TO_DATE ('01 -07-2002 ',' DD-MM-YYY '), to_date ('31 -12-2006', 'dd-mm-yyyy'), 'ac_account', 90);


Alter table departments enable constraint dept_mgr_fk;

Commit;

```
---

<!-- TOC --><a name="class-7-creating-indexes-inserting-comments-and-others-in-the-hr-user-schema"></a>
### Class 7 - Creating Indexes, Inserting Comments and Others in the HR User Schema

```sql
-
- Course - Oracle PL/SQL Specialist: from basic to advanced
-
- Author - Emílio Scudero
-
- Section 03 - PL/SQL Fundamentals - Installation and configuration of connections in Oracle SQL Developer
-
- Class 7 - Creating indexes, inserting comments and others in the HR user Schema

- Creating indexes, inserting comments and others in the HR user Schema

/*
 In Oracle SQL Developer connect as HR user using your connection to the HR user
 Open this script in Oracle SQL Developer and run (F5)
/*

/*
  Creating Indexes for Tables
*/

Create Index EMP_DEPARTMENT_IX
On Employees (Department_id);

Create Index EMP_JOB_IX
On Employees (Job_id);

Create Index EMP_MANAGER_IX
On Employees (manager_id);

Create Index Empi_Name_ix
On Employees (Last_Name, First_Name);

Create index dept_location_ix
On Departments (location_id);

Create index jhist_job_ix
On job_history (job_id);

Create index jhist_employee_ix
On job_history (employee_id);

Create index jhist_department_ix
On Job_History (Department_id);

Create index loc_city_ix
On Locations (City);

Create index loc_state_province_ix
On locations (state_province);

Create index loc_country_ix
On locations (country_id);

Commit;

Create or Replace Procedure Secure_DML
Is
Begin
  If to_char (Sysdate, 'HH24: Mi') Not Between '08: 00 'and '18: 00'
        Or to_char (Sysdate, 'Dy') In ('Sat', 'Sun') Then
	Raise_application_error (-20205,
		'You May Only Make Changes During Normal Office Hours');
  End IF;
End Secure_DML;
/

Create or Replace Trigger Secure_employees
  Before Insert or Update or Delete On Employees
Begin
  Secure_DML;
End Secure_employees;
/

Alter Trigger Secure_employees Disable;

Create or replace procedure add_job_history
  (p_emp_id job_history.employee_id%type
   , p_start_date job_history.start_date%type
   , p_end_date job_history.end_date%type
   , p_job_id job_history.job_id%Type
   , p_department_id job_history.department_id%Type
   )
Is
Begin
  INSERT INTO JOB_History (Employee_id, Start_date, End_date,
                           job_id, department_id)
    VALUES (p_emp_id, p_start_date, p_end_date, p_job_id, p_department_id);
End add_job_history;
/

Create or replace trigger update_job_history
  After Update of Job_id, Department_id on Employees
  For each row
Begin
  add_job_history (: old.employee_id ,: old.hire_date, sysdate,
                  : Old.JOB_ID ,: Old.Department_id);
End;
/

Commit;

/*
  Adding comments to tables and columns
*/

Comment on table regions
Is' regional table that contains region numbers and names. Contains 4 Rows; References with the Countries Table. ';

Comment on column regions.region_id
Is 'Primary Key of Regional Table.';

Comment on column regions.region_name
Is' names of regions. Locations are in the country of these regions. ';

Comment on table locations
Is' locations table that contains specific address of a specific office,
Warehouse, and/or production Site of a Company. Does not Store Addresses /
Locations of Customers. Contains 23 Rows; References with the
Departments and Countries Tables. ';

Comment on Column Locations.location_id
Is 'Primary Key of Locations Table';

Comment on Column Locations.street_address
Is' Street Address of An Office, Warehouse, Or Production Site of A Company.
Contains Building Number and Street Name ';

Comment on column locations.postal_code
Is' Postal Code of the location of an Office, Warehouse, or Production Site
Of A Company. ';

Comment on Column Locations.City
Is' a not null column that shows city Where an Office, Warehouse, or
Production Site of A Company is Located. ';

Comment on column locations.state_province
Is' State or Province Where an Office, Warehouse, or Production Site of a
Company is located. ';

Comment on Column Locations.Country_id
Is' country where an office, warehouse, or production site of a company is
Located. Foreign Key to Country_id Column of the Countries Table. ';


COMMENT ON TABLE DEPARTMENTS
Is' departments table that shows details of departments where employees
Work. Contains 27 Rows; References with Locations, Employees, and Job_History Tables. ';

Comment on Column Departments.Department_id
Is 'Primary Key Column of Department Table.';

COMMENT ON COLUMN DEPARTMENTS.DEPARTMENT_NAME
Is' a not null column that shows name of a department. Administration,
Marketing, Purchasing, Human Resources, Shipping, It, Executive, Public
Relationships, Sales, Finance, and Accounting. ';

Comment on Column Departments.manager_id Is' manager_id of a department. Foreign Key to Employee_id Column of Employees Table. The Manager_id Column of the Employeee Table Referees This Column. ';

COMMENT ON COLUMN DEPARTMENTS.LOCATION_ID
Is' location id where a department is located. Foreign Key to Location_id Column of Locations Table. ';


Comment on table job_history
Is' Table That Stores Job History of the Employees. If an Employeee
Changes Departments Within the Job Or Changes Jobs Within The Department,
New Rows Get Inserted into this table with old Job Information of the
Employee. Contains A Complex Primary Key: Employee_id+Start_date.
Contains 25 Rows. References with Jobs, Employees, and Departments Tables. ';

Comment on column job_history.employee_id
Is' a not null column in the complex primary key Employee_id+Start_date.
Foreign Key to Employee_id Column of the Employeee Table ';

Comment on column job_history.start_date
Is' a not null column in the complex primary key Employee_id+Start_date.
Must Be Less Than The End_Date of the Job_History Table. (Encarced by
constraint jhist_date_interval) ';

Comment on column job_history.end_date
Is' Last Day of the Employeee in This Job Role. A not null column. Must be
Greater than the start_date of the job_history table.
(Encorced by constraint jhist_date_interval) ';

Comment on column job_history.job_id
Is' Job Role in Which The Employeee Worked in the Past; Foreign Key To
Job_id Column in the Jobs Table. To not null Column. ';

Comment on column job_history.department_id
Is' Department ID in Which the Employeee Worked in the Past; Foreign Key to Desparment_id Column in the Departments Table ';



COMMENT ON TABLE COUNTRIES
Is' country table. Contains 25 Rows. References with locations table. ';

Comment on column country.country_id
Is 'Primary Key of Countries Table.';

Comment on column country.country_name
Is 'country name';

Comment on column country.region_id
Is' region id for the country. Foreign Key to Region_id Column in the Departments Table. ';



COMMENT ON TABLE JOBS
Is' Jobs Table with Job Titles and Salary Ranges. Contains 19 Rows.
References with Employees and Job_History Table. ';

Comment on column jobs.job_id
Is 'Primary Key of Jobs Table.';

Comment on column jobs.job_title
Is 'a not null column that shows job title, e.g. ad_vp, fi_accountant';

Comment on column jobs.min_salary
Is 'minimum salary for a job title.';

COMMENT ON COLUMN JOBS.MAX_SALARY
Is 'maximum salary for a job title';



COMMENT ON TABLE EMPLOYEES
Is' Employees table. Contains 107 Rows. References with departments,
Jobs, Job_History Tables. Contains A self reference. ';

Comment on column employees.employee_id
Is 'Primary Key of Employees Table.';

Comment on column employees.first_name
Is' First Name of the Employee. To not null Column. ';

Comment on column employees.last_name
Is' Last Name of the Employee. To not null Column. ';

Comment on column employees.email
Is 'Email id of the Employeee';

Comment on column employees.phone_number
Is' Phone Number of the Employee; includes country code and area code ';

Comment on column employees.hire_date
Is' Date when the Employeee Started on this Job. To not null Column. ';

Comment on column employees.job_id
Is' current Job of the Employee; Foreign Key to Job_id Column of the
Jobs Table. To not null Column. ';

Comment on column employees.salary
Is' Monthly Salary of the Employee. Must Be Greater
Than Zero (Encorced by constraint emp_salary_min) ';

Comment on column employees.comMission_PCT
Is' Commission Percentage of the Employee; Only Employees in Sales
Department Elgible for Commission Percentage ';

Comment on column employees.manager_id
Is' Manager ID of the Employee; has same taboin as manager_id in
Table Department. Foreign Key to Employee_id Column of Employees Table.
(Useful for Reflexive Joins and Connect by Query) ';

Comment on Column Employees.Department_id
Is' department id where employeee works; Foreign Key to Department_id
Column of the Department Table ';

Commit;

```
---

<!-- TOC --><a name="section-6-sql-fundamentals-consulting-data-using-the-select-command"></a>
## Section 6 - SQL Fundamentals - Consulting data using the Select Command

<!-- TOC --><a name="consulting-data-using-the-sql-select-command"></a>
### consulting data using the SQL SELECT command

```sql
-
- Section 6 
- Consulting data using the SQL SELECT command
-
- Class Practices 1
- 

- Using the command describes

Described employees

Descplayess

Des Des Departments

Desi Jobs

Des Des Departments

- Selecting all columns in the table

SELECT *
From Departments;

EMPLOYEES

SELECT *
From Employees;

Desi Jobs

SELECT * 
From Jobs;

- Selecting specific columns

Select Employee_id, First_Name, Last_Name, Salary
From Employees;

Select department_id, department_name, manager_id
From Departments;

- Using arithmetic operators

SELECT FIRST_NAME, LAST_NAME, SALARY, SALARY * 1.15 
From Employees;

- Operators precedence rules

SELECT FIRST_NAME, LAST_NAME, SALARY, SALARY + 100 * 1.15 
From Employees;

- Using parentheses to change precedence SELECT FIRST_NAME, LAST_NAME, SALARY, (SALARY + 100) * 1.15 
From Employees;

I understand the null value (null)

SELECT FIRST_NAME, LAST_NAME, JOB_ID, SALARY, COMMISSON_PCT
From Employees;

- Using null values ​​in arithmetic expressions

Select First_Name, Last_Name, Job_id, Commission_PCT, 200000 * Commission_PCT
From Employees
WHERE COMMISSION_PCT IS NULL;

- Using column alias

SELECT FIRST_NAME THE NAME, LAST_NAME THE Surname, SALARY THE SALARY
From Employees;

Select First_Name Name, Last_Name Surname, Salary Salary
From Employees;

SELECT FIRST_NAME "NAME", LAST_NAME "Surname", Salary "Salary ($)", Commission_PCT "Commission percentage"
From Employees;

- Using Concatenation Operator 

SELECT FIRST_NAME || '' || Last_Name || ', Admission Date:' || hire_date "employee"
From Employees;

- Using concatenation operator and character strings 

SELECT FIRST_NAME || '' || Last_Name || ', Admission Date:' || hire_date "employee"
From Employees;

- Using alternative operator for quotation marks

SELECT Department_Name || Q '[Department Manager ID:]'
|| Manager_id "Department and Manager"
From Departments;

- Duplicate Lines

Select department_id
From Employees;

- Using Distinct to eliminate duplicate lines

SELECT DISTINCT Department_id
From Employees;

SELECT DISTINCT LAST_NAME
From Employees;

SELECT DISTINCT LAST_NAME, FIRST_NAME
From Employees;


```
---

<!-- TOC --><a name="selects"></a>
### selects

```sql
- most basic select that exists
Select E.* From Employees and;

- Select to display specific columns
Select e.employee_id, e.first_name, e.last_name from employees and;

- Select with arithmetic expressions and using
Select e.first_name name,
       E.last_name surname,
       E.SARARY SALARY,
       (E.Salarry * 1.15) "New Salary"
  From Employees and;

- Select using concatenation
SELECT E.FIRST_NAME || '' || E.last_name "Employee Name"
  From Employees and;

- SELECT WITH DISTINCT
Select Distinct Department_id from Employees;

```
---

<!-- TOC --><a name="section-7-sql-fundamentals-restricting-and-ordering-data"></a>
## Section 7 - SQL Fundamentals - Restricting and ordering data

<!-- TOC --><a name="clause-where"></a>
### clause where

```sql
- WERE CLAUSE
Select * From Employees and Where E.last_Name = 'King';

- Where with comparison operators
Select * From Employees and Where E.Salarry> = 3000;

Select * From Employees and Where E.Salarry <= 3000;

- Where within specific values
Select * From Employees and Where E.Salarry Between 3000 and 4000;

- Where within a list of values
SELECT *
  From Employees and
 Where e.job_id in ('it_prog', 'fi_account', 'sa_rep');

- Where with Joker: % = followed by anything. _ = only 1 character
Select * From Employees and Where E.FIRST_Name Like 'SA%';

Select * From Employees and Where E.FIRST_Name Like '_A%';

- Order by
SELECT * From Employees and Order by E.Hire_date Desi;

SELECT E.FIRST_NAME, E.LAST_NAME, E.SARARY * 12 "ANNUAL SALARY" FROMPLAYEES AND ORDER BY "ANNUAL SALARY" DES;

Select E.FIRST_NAME, E.LAST_NAME, E.SARARY * 12 "Annual Salary" From Employees and Order by 3 Desc;

- Substitution variables
SELECT * from departments d Where D.Department_id = & department_id; 

Select * From Employees and Where E.JOB_ID = '& Job_id';


```
---

<!-- TOC --><a name="section-8-single-row-functions"></a>
## Section 8 - Single -Row Functions

<!-- TOC --><a name="data-functions"></a>
### Date Functions

```sql
- Functions for the Date Type
- Date Format Default is defined by DBA
SELECT SYSDATE FROM DUAL;

SELECT TO_CAR (SYSDATE, 'DD/MM/YY') DUAL;
SELECT TO_char (Sysdate, 'DD/MM/YYYY') From Dual;

- When we perform operations with dates, we are working with days
SELECT SYSDATE + 30 from dual;

- Months_Between: Returns the number of months between two dates
Select Trunc (Months_Between (Sysdate, To_Date ('31 -12-1997 ',' dd-mm-yyyy '))))
  From dual;

- add_months: adds months to a date
SELECT ADD_MONTHS (SYSDATE, 4) FROM DUAL;

- Next_Day: next day in relation to the past argument
SELECT NEXT_DAY (SYSDATE, 'Friday') from dual;

- Last_Day: last day of the month
SELECT LAST_DAY (SYSDATE) DUAL;

```
---

<!-- TOC --><a name="single-row-functions-2"></a>
### Single-Row Functions 2

```sql
-
- Section 8 
- Using Single Row Functions
-
- Class 1
-

- Call and tiny conversion functions

Select Employee_id, Last_Name, Department_id
From Employees
Where Last_Name = 'King';

Select Employee_id, Last_Name, Department_id
From Employees
Where Upper (Last_Name) = 'King';

- Character manipulation functions

Select Concat ('Course:', 'Oracle 19C' Introduction), Substr ('Oracle 19C' Introduction, 1,11),
       Length ('Oracle 19C' Introduction), Instr ('Oracle 19C', 'Oracle')
From dual;

SELECT FIRST_NAME "NAME", LPAD (FIRST_NAME, 20, '') "RIGHT ALIGNED NAME", RPAD (FIRST_NAME, 20, '') "Left aligned name"
From Employees;

Select Job_Title, Replace (Job_Title, 'President', 'President')
From Jobs
Where Job_Title = 'President';

- Number Type Functions

SELECT ROUND (45,923.2), ROUND (45,923.0)
From dual;

Select Trunc (45,923.2), Trunc (45,923.0)
From dual;

SELECT MOD (1300,600) REST From dual;

SELECT ABS (-9), SQRT (9)
From dual;

- Date Type Functions 

SELECT SYSDATE
From dual;

DUAL

SELECT *
From dual;

SELECT 30000 * 1.25
From dual;

- Calculations with dates

SELECT SYSDATE, SYSDATE + 30, SYSDATE + 60, SYSDATE - 30
From dual;

SELECT LAST_NAME, ROUND ((SYSDATE-HIRE_DATE)/7.2) "WEEKS OF WORK" "
From Employees;

- Other Date Type Functions

SELECT FIRST_NAME, LAST_NAME, ROUND (Months_Between (Sysdate, Hire_Date), 2) "MONTHS OF WORK"
From Employees;

SELECT SYSDATE, ADD_MONTHS (SYSDATE, 3), NEXT_DAY (SYSDATE, 'FRIDAY'), LAST_DAY (SYSDATE)
From dual;

Select Sysdate, Round (Sysdate, 'Month'), Round (Sysdate, 'Year'), 
       Trunc (Sysdate, 'Month'), Trunc (Sysdate, 'Year')
From dual;
       
SELECT SYSDATE, TO_CAR (TRUNC (SYSDATE), 'DD/MM/YYYY HH24: MI: SS')
From dual;
```
---

<!-- TOC --><a name="single-row-functions"></a>
### Single-Row Functions

```sql
-Single-Row Functions
- Character manipulation functions
SELECT UPPER ('SQL Specialist') From Dual;
SELECT LOWER ('SQL Specialist') from Dual;
SELECT INITCAP ('SQL Specialist') from dual;
SELECT CONCAT ('SQL Specialist', 2022) from dual;
Select Substr ('SQL Specialist', 1, 3) from dual;
SELECT LENGTH ('SQL Specialist') from Dual;
SELECT INTR ('SQL Specialist', 'Specialist') from Dual;
SELECT LPAD ('SQL Specialist', 20, '*') from dual;
SELECT RPAD ('SQL Specialist', 20, '*') from dual;
SELECT REPLACE ('SQL Specialist', 'SQL', 'PL/SQL') From Dual;
SELECT TRIM (';' from 'name@email.com;') from dual;
Select ltrim ('name@email.com', '') from dual;
Select RTrim ('name@email.com; ','; ') from dual;

- Numerical functions
Select Round (133,216, 2) from dual;
SELECT TRUNC (133,216, 2) from dual;
SELECT MOD (133, 2) from dual;
SELECT ABS (-333) from dual;
SELECT SQRT (49) from dual;

```
---

<!-- TOC --><a name="section-9-conversion-functions"></a>
## Section 9 - Conversion Functions

<!-- TOC --><a name="using-conversion-functions-and-conditional-expressions"></a>
### Using conversion functions and conditional expressions

```sql
-
- Section 9 
- Using conversion functions and conditional expressions 
-
- Class 1
-

- Using the to_har function with dates

SELECT LAST_NAME, TO_CHAR (HIRE_DATE, 'DD/MM/YYYY HH24: MI: SS') DT_ADMESSAO
From Employees;

SELECT SYSDATE, TO_CHAR (SYSDATE, 'DD/MM/YYYY HH24: MI: SS') DATE)
From dual;

Select Last_Name, To_char (Hire_Date, 'dd, "from" month "from" yyyy') dt_admissâo
From Employees;

Select Last_Name, To_char (Hire_Date, 'FMDD, "from" Month "from" Yyyy') DT_ADMESSAO
From Employees;

- Using the to_char function with numbers

SELECT FIRST_NAME, LAST_NAME, TO_CHAR (SALARY, 'L99G999G999D99') Salary
From Employees;

SELECT FIRST_NAME, LAST_NAME, TO_CHAR (SALARY, 'L99G999G999D99') Salary
From Employees;

- Using the to_number function

SELECT TO_NUMBER ('12000.50')
From dual;

- Using the to_date function

SELECT TO_DATE ('06/02/2020 ',' dd/mm/yyyy ') date
From dual;

SELECT FIRST_NAME, LAST_NAME, HIRE_DATE
From Employees
Where_date = to_date ('17/06/2003 ',' dd/mm/yyyy ');

- Using Anninhaded Functions

SELECT FIRST_NAME, LAST_NAME, ROUND (Months_Between (Sysdate, Hire_Date), 0)
From Employees
Where_date = to_date ('17/06/2003 ',' dd/mm/yyyy ');

- Using the NVL function

SELECT LAST_NAME, SALARY, NVL (Commission_PCT, 0), SALARY*12 Salary_anual, 
       (salary*12) + (salary*12*nvl (commission_pct, 0))
From Employees;

- Using the coalesce function

Select Coalesce (null, null, 'expression 3'), coalesce (null, 'expression 2', 'expression 3'),
       Coalesce ('Expression 1', 'Expression 2', 'Expression 3')
From dual;

Select Last_Name, Employee_id, Commission_PCT, Manager_id, 
       Coalesce (to_char (commission_pct), to_chage (manager_id),
       'No commission percentage and no manager')
From Employees;

- Using the NVL2 function

Select Last_Name, Salary, Commission_PCT, 
       Nvl2 (commission_pct, 10, 0) percentage_tered
From Employees;

- Using the nullif function

Select nullif (1000.1000), nullif (1000,2000)
From dual;

SELECT FIRST_NAME, LAST_NAME, LETTH (FIRST_NAME) "Expression 1",
       Length (Last_Name) "Expression 2", nullif (length (first_name), length (last_name) result)
From Employees;

- Expression Case

Select Last_Name, Job_id, Salary,
                          Case Job_id
                             When 'it_prog'   
                               Then 1.10*SALARY
                             When 'St_clerk' 
                               Then 1.15*SALARY
                             WHEN 'SA_REP' 
                               Then 1.20*SALARY
                             Else Salary 
                           End "New Salary"
From Employees;

- Using the Decode function

Select Last_Name, Job_id, Salary,
Decode (job_id, 'it_prog', 1.10*SALARY,
               'St_clerk', 1.15*Salary,
               'SA_REP', 1.20*SALARY
                         , salary) "New Salary"
From Employees;
```
---

<!-- TOC --><a name="section-10-group-functions"></a>
## Section 10 - Group Functions

<!-- TOC --><a name="adding-data-using-group-functions"></a>
### adding data using group functions

```sql
-
- Section 10 
- Adding data using group functions
-
- Class 1
-

- Using the functions AVG and SUM SELECT AVG (SALARY), SUM (SALARY)
From Employees;

- Using Min and Max functions

SELECT MIN (HIRE_DATE), MAX (HIRE_DATE)
From Employees;

SELECT MIN (SALARY), MAX (SALARY)
From Employees;

- Using the Count function

Select Count (*)
From Employees;

SELECT COUND (Commission_PCT)
From Employees;

Select Count (Commission_PCT), Count (*)
From Employees;

SELECT COUND (NVL (Commission_PCT, 0))
From Employees;

- Using the Count function with distinct

SELECT COUND (DISTINCT DEPARTMENT_ID)
From Employees;

Select Count (Department_id)
From Employees;

- Group functions and null values

SELECT AVG (commission_pct)
From Employees;

- Treatment of nulls in group functions 

SELECT AVG (NVL (commission_pct, 0)))
From Employees;

```
---

<!-- TOC --><a name="group-by"></a>
### Group by

```sql
-
-
- Section 10 
- Adding data using group functions
-
- Class 2
- 

- Created groups using the Group by clause

SELECT Department_id, AVG (SALARY)
From Employees
Group by Department_id 
Order by Department_id;

- Using the classula Group by with more than one column or expression

Select Department_id, Job_id, Sum (Salary)
From Employees
Group by Department_id, Job_id
Order by Department_id, Job_id;

Select Department_id, Job_id, Sum (Salary)
From Employees
Group by Department_id, Job_id
Order by Department_id, Job_id;

- Incorrect consultations using group functions

SELECT Department_id, AVG (SALARY)
From Employees;

- Correcting incorrect consultations using group functions

SELECT Department_id, AVG (SALARY)
From Employees
Group by Department_id;

- Incorrect consultations using group functions

Select Department_id, Max (Salary)
From Employees
WHERE MAX (SALARY)> 10000
Group by Department_id;

- Correcting incorrect consultations using group functions

- Restricting groups using the Having clause

Select Department_id, Max (Salary)
From Employees
Group by Department_id
HAVING MAX (SALARY)> 10000;

SELECT JOB_ID, SUM (SALARY) TOTAL
From Employees
WHERE JOB_ID <> 'SA_REP'
Group by job_id
Having sum (salary)> 10000
Order by sum (salary);

- Nestling Group Functions

SELECT MAX (AVG (SALARY))
From Employees
Group by Department_id;

SELECT AVG (SALARY)
From Employees
Group by Department_id;
```
---

<!-- TOC --><a name="section-11-joins"></a>
## Section 11 - Joins

<!-- TOC --><a name="1-joins"></a>
### 1 - Joins

```sql
-
- Section 11 
- Showing data from multiple tables
-
- Class 1 - Displaying data from multiple tables
-

- Using Column Prefixes with Table Names 

Select Employees.employee_id, employees.last_name, 
       employees.department_id, departments.department_name
From Employees Join Departments 
       ON (EMPLOYEES.DEPARTMENT_ID = Department.Department_id);

- Using Table Alias

Select e.employee_id, e.last_name, e.department_id, d.department_name
From Employees and Join Departments D
On (e.department_id = d.department_id);

- Using Natural Joins

Select Department_id, Department_Name, Location_id, City
From Deportments
Natural Join Locations;

- Join with the Using clause

SELECT E.EPPLEEE_ID, E.LAST_NAME, D.LOCATION_ID, DEPARTMENT_ID, D.Department_Name
From Employees and
  Join Department D Using (Department_id);

- Join with the on clause

SELECT E.EPPLEEE_ID, E.LAST_NAME, E.DEPARTMENT_ID, D.LOCATION_ID
From Employees and Join Departments D
On (e.department_id = d.department_id);

- Joins using several tables with the on clause

SELECT E.EPPLEEE_ID, J.JOB_TITLE, D.Department_Name, L.CITY, L.state_Province, L.COUNTRY_ID
From Employees and
  Join Jobs J On (e.job_id = j.job_id)
  Join Department D On (e.department_id = d.department_id)
  Join Locations L On (d.location_id = l.location_id)
Order by e.employee_id;
  
- Including additional conditions the condition of Join in the Where Clause

Select e.employee_id, e.last_name, e.salarry, e.department_id, d.department_name
From Employees and Join Departments D
On (e.department_id = d.department_id)
Where (E.Salary Between 10000 and 15000);

- Including additional conditions the condition of Join using and

Select e.employee_id, e.last_name, e.salarry, e.department_id, d.department_name
From Employees and Join Departments D
On (e.department_id = d.department_id) and
   (E.Salarry Between 10000 and 15000);
   
- Self Join using the on clause

Select Employee.employee_id "ID Employed", employee.last_name "Surname Employed",
       manager.employee_id "ID manager", manager.last_name "surname manager"
From Employees Employee Join Employees Manager
ON (employee.manager_id = manager.employee_id)
Order by employee.employee_id;

```
---

<!-- TOC --><a name="2-nonequijoins"></a>
### 2 - Nonequijoins

```sql
-
- Section 11 
- Showing data from multiple tables
-
- Class 2 - Nonequijoins
-

- Nonequijoins

- Removing the Job_Grads table

DROP Table Job_Grades;

- Creating the Job_Grads Table

Create Table Job_Grades (
 grid_level varchar2 (2) not null,
 Lowest_Sal Number (11.2),
 Highest_Sal Number (11,2),
 Constraint job_grades_pk primary key (grid_level)); - Inserting lines in the Job_Grads table

INSERT INTO JOB_GRADES VALUES ('A', 1000,2999); 
INSERT INTO JOB_GRADES VALUES ('B', 3000.5999);
INSERT INTO JOB_GRADES VALUES ('C', 6000,9999);
INSERT INTO JOB_GRADES VALUES ('D', 10000,14999);
INSERT INTO JOB_GRADES VALUES ('E', 15000.24999);
INSERT INTO JOB_GRADES VALUES ('F', 25000,40000);

- Effective the transaction

Commit;

- Nonequijoins

SELECT E.EPPLEEE_ID, E.SARARY, J.GRADE_LEVEL, J.LOWEST_SAL, J.HIGHEST_ALS
From Employees and 
  JOIN JOB_GRADES J
     On NVL (E.Salarry, 0) Between J.Lowest_Sal and J.Highest_Sal
Order by e.salary;

-
- Section 11 - Class 2
- Showing data from multiple tables
-

- Nonequijoins

- Removing the Job_Grads table

DROP Table Job_Grades;

- Creating the Job_Grads Table

Create Table Job_Grades (
 grid_level varchar2 (2) not null,
 Lowest_Sal Number (11.2),
 Highest_Sal Number (11,2),
 Constraint job_grades_pk primary key (grid_level));
 
- Inserting lines in the Job_Grads table

INSERT INTO JOB_GRADES VALUES ('A', 1000,2999); 
INSERT INTO JOB_GRADES VALUES ('B', 3000.5999);
INSERT INTO JOB_GRADES VALUES ('C', 6000,9999);
INSERT INTO JOB_GRADES VALUES ('D', 10000,14999);
INSERT INTO JOB_GRADES VALUES ('E', 15000.24999);
INSERT INTO JOB_GRADES VALUES ('F', 25000,40000);

- Effective the transaction

Commit;

SELECT *
From job_grades;

- Nonequijoins

SELECT E.EPPLEEE_ID, E.SARARY, J.GRADE_LEVEL, J.LOWEST_SAL, J.HIGHEST_ALS
From Employees and 
  JOIN JOB_GRADES J
     On NVL (E.Salarry, 0) Between J.Lowest_Sal and J.Highest_Sal
Order by e.salary;

SELECT E.EPPLEEE_ID, E.SARARY, J.GRADE_LEVEL, J.LOWEST_SAL, J.HIGHEST_ALS
From Employees and 
  JOIN JOB_GRADES J
     On NVL (e.salary, 0)> = j.lowest_sal and 
         NVL (E.Salarry, 0) <= J.Highest_Sal
Order by e.salary;


```
---

<!-- TOC --><a name="3-inner-joins"></a>
### 3 - Inner Joins

```sql
-
- Section 11 
- Showing data from multiple tables
-
-Class 3 -INNER JOINS 
- 

- Join with the on clause

SELECT E.EPPLEEE_ID, J.JOB_TITLE, D.Department_Name, L.CITY, L.state_Province, L.COUNTRY_ID
From Employees and
  Inner Join Jobs J On E.JOB_ID = J.JOB_ID
  Inner Join Departments D On D.Department_id = E.Department_id
  Inner Join Locations L On D.location_id = L.location_id
Order by e.employee_id;

SELECT E.EPPLEEE_ID, J.JOB_TITLE, D.Department_Name, L.CITY, L.state_Province, L.COUNTRY_ID
From Employees and
  Join Jobs J On E.JOB_ID = J.JOB_ID
  Join Departments D On D.Department_id = E.Department_id
  Join Locations L On D.location_id = L.location_id
Order by e.employee_id;

- Using Natural Joins

Select Department_id, Department_Name, Location_id, City
From Deportments
Natural Inner Join Locations;

Select Department_id, Department_Name, Location_id, City
From Deportments
Natural Join Locations;

- Join with the Using clause

SELECT E.EPPLEEE_ID, E.LAST_NAME, D.LOCATION_ID, DEPARTMENT_ID, D.Department_Name
From Employees and
  Inner Join Departments D Using (Department_id);
  
SELECT E.EPPLEEE_ID, E.LAST_NAME, D.LOCATION_ID, DEPARTMENT_ID, D.Department_Name
From Employees and
  Join Department D Using (Department_id);
```
---
#### Left joins = > Inner join + other non matching values in the left table
#### Right joins = > Inner join + other non matching values in the Right table
<!-- TOC --><a name="4-outer-joins"></a>
### 4 - Outer Joins => Inner Join + non matching in left table + non matching value in right table

```sql
-
- Section 11 
- Showing data from multiple tables
-
- Class 4 - Outer Joins

- Left Otero Join

SELECT E.FIRST_NAME, E.LAST_NAME, D.Department_id, D.Department_Name
From Employees and Left Otero Join Deportments D
     On (e.department_id = d.department_id) 
Order by D.Department_id;

- Right Otero Join

SELECT D.Department_id, D.Department_Name, E.FIRST_NAME, E.LAST_NAME
From Employees and Right Otero Join Departments D
     On (e.department_id = d.department_id) 
Order by D.Department_id;

- Full Otero Join

SELECT D.Department_id, D.Department_Name, E.FIRST_NAME, E.LAST_NAME
From Employees and Full Otero Join Departments D
     On (e.department_id = d.department_id) 
Order by D.Department_id;



```
---

<!-- TOC --><a name="5-cartesian-product"></a>
### 5 - Cartesian product 
 #### This also called as cross join. The of rows returned is equal to no.of.rows in left table a * no.of.rows in right table 

```sql
-
- Section 11 
- Showing data from multiple tables
-
- Class 5 - Cartesian product
-

- Generating a Cartesian product using Cross Join

SELECT LAST_NAME, Department_Name
From Employees
  Cross Join Departments;


```
---

<!-- TOC --><a name="6-joins-oracle"></a>
### 6 - Joins Oracle

```sql
-
- Section 11 
- Showing data from multiple tables
-
- Class 6 - Joins Using Oracle Syntax
- 

- Eguioin using Oracle syntax

Select e.Employee_id, e.last_name, e.department_id, d.department_id, d.location_id
From Employees E,
       Department D
Where (e.department_id = d.department_id)
Order by e.department_id;

- Joins between several tables using oracle syntax

SELECT E.EPPLEEE_ID, J.JOB_TITLE, D.Department_Name, L.CITY, L.state_Province, L.COUNTRY_ID
From Employees E,
       Jobs J,
       Department D, 
       Locations L
Where (e.job_id = j.job_id) and
      (D.Department_id = e.department_id) and
      (d.location_id = l.location_id)
Order by e.employee_id; - Including additional conditions the condition of Join using and

Select e.employee_id, e.salarry, j.job_title, 
       D.Department_Name, L.CITY, L.state_Province, L.COUNTRY_ID
From Employees E,
       Jobs J,
       Department D, 
       Locations L
Where (e.job_id = j.job_id) and
      (D.Department_id = e.department_id) and
      (d.location_id = l.location_id) and
      (e.salary> = 1000)
Order by e.employee_id;


- Nonequijoin using oracle syntax

SELECT E.EPPLEEE_ID, E.SARARY, J.GRADE_LEVEL, J.LOWEST_SAL, J.HIGHEST_ALS
From Employees E,
       Job_GRADES J
Where Nvl (E.Salarry, 0) Between J.Lowest_Sal and J.Highest_sal
Order by e.salary;

- Oter Join using oracle syntax

SELECT E.FIRST_NAME, E.LAST_NAME, D.Department_id, D.Department_Name
From Employees E,
       Department D
Where E.Department_id = D.Department_id (+) 
Order by e.department_id;

SELECT E.FIRST_NAME, E.LAST_NAME, D.Department_id, D.Department_Name
From Employees E,
       Department D
Where E.Department_id (+) = D.Department_id 
Order by E.FIRST_Name;

-Self-Join using oracle syntax

Select Employee.employee_id "ID Employed", employee.last_name "Surname Employed",
       manager.employee_id "ID manager", manager.last_name "surname manager"
From Employees Employed,
       Employees Manager
Where (employee.manager_id = manager.employee_id)
Order by employee.employee_id;

EMPLOYEES

- Outor Join and Self Join using Oracle Syntax

Select Employee.employee_id "ID Employed", employee.last_name "Surname Employed",
       manager.employee_id "ID manager", manager.last_name "surname manager"
From Employees Employed,
       Employees Manager
Where (employee.manager_id = manager.employee_id (+))
Order by employee.employee_id;

- Cartesian product

Select e.employee_id, e.first_name, e.last_name, j.job_id, j.job_title
From Employees E, Jobs J;

- Correcting Cartesian product

Select e.employee_id, e.first_name, e.last_name, j.job_id, j.job_title
From Employees E, Jobs J
WHERE E.JOB_ID = J.JOB_ID;
```
---

<!-- TOC --><a name="joins-ansii"></a>
### Joins Ansii

```sql
- Join with on
Select e.employee_id "Employee ID",
       E.FIRST_NAME || '' || e.last_name "whole name"
  From Employees and
  Join Deportments D
    On e.department_id = d.department_id;

- Natural Join
Select D.Department_id, D.Department_Name, L.City
  From Deportments D Natural
  Join Locations L;

- Join with Using
Select e.employee_id "Employee ID",
       E.FIRST_NAME || '' || e.last_name "whole name"
  From Employees and
  Join Deportments D
 Using (department_id);

- Join with several tables
SELECT E.FIRST_NAME, E.LAST_NAME, J.JOB_TITLE, D.DEPARTMENT_NAME, L.CITY
  From Employees and
  Join Jobs J
    On e.job_id = j.job_id
  Join Deportments D
    On e.department_id = d.department_id
  Join Locations L
    On d.location_id = l.location_id
 Order by e.employee_id;

- Nonequijoins
Select e.job_id,
       E.FIRST_NAME,
       e.last_name,
       J.GRADE_LEVEL,
       j.lowst_sal,
       j.highest_sal
  From Employees and
  JOIN JOB_GRADES J
    On NVL (E.Salarry, 0) Between J.Lowest_Sal and J.Highest_Sal
 Order by e.salary;

- Left Otero Join
SELECT E.FIRST_NAME, E.LAST_NAME, D.Department_id, D.Department_Name
  From Employees and
  Left Otero Join Departments D
    On e.department_id = d.department_id
 Order by D.Department_id;

- Right Otero Join
SELECT E.FIRST_NAME, E.LAST_NAME, D.Department_id, D.Department_Name
  From Employees and
 Right Otero Join Departments D
    On e.department_id = d.department_id
 Order by D.Department_id;

- Full Otero Join
SELECT E.FIRST_NAME, E.LAST_NAME, D.Department_id, D.Department_Name
  From Employees and
  FULL OUTER JOIN DEPARTMENTS D
    On e.department_id = d.department_id
 Order by D.Department_id;

- Cross Join
SELECT E.LAST_NAME, D.Department_Name
  From Employees and
 CROSS JOIN DEPARTMENTS D;

```
---

<!-- TOC --><a name="joins-oracle"></a>
### Joins Oracle

```sql
- EARRY 
Select e.employee_id, e.last_name, d.department_id, d.department_name
  From Employees E, Departments D
 Where E.Department_id = D.Department_id;

- Join with several columns
SELECT E.LAST_NAME, D.Department_Name, L.CITY, J.JOB_TITLE
  From Employees E, Departments D, Locations L, Jobs J
 Where e.department_id = d.department_id
   And d.location_id = l.location_id
   And e.job_id = j.job_id;

- Left Otero Join
SELECT E.FIRST_NAME, E.LAST_NAME, D.Department_id, D.Department_Name
  From Employees E, Departments D
 Where E.Department_id = D.Department_id (+)
 Order by D.Department_id;

- Right Otero Join
SELECT E.FIRST_NAME, E.LAST_NAME, D.Department_id, D.Department_Name
  From Employees E, Departments D
 Where E.Department_id (+) = D.Department_id
 Order by D.Department_id;

```
---

<!-- TOC --><a name="section-12-sub-queries"></a>
## Section 12 - Sub -Queries

<!-- TOC --><a name="1-single-row-sub-consults"></a>
### 1-Single-Row Sub-Consults

```sql
-
- Section 12 
-Using sub-consults
-
-Class 1-Single-Row Sub-Consults

-Signal Single-Row

SELECT FIRST_NAME, LAST_NAME, JOB_ID, SALARY
From Employees
WHERE SALARY> (SELECT AVG (NVL (SALARY, 0))
                 From Employees);              

-Using sub-consults in the Having clause

SELECT E1.Department_id, Max (E1.SARARY)
From Employees E1
Group by E1.Department_id
Having Max (Salary) <(Select AVG (E2.Salarry)
                       From Employees E2);
                                                  
-Errors using Single-Row Sub-Consults

Select Employee_id, First_Name, Last_Name
From Employees
WHERE SALARY =
                (SELECT AVG (NVL (SALARY, 0))
                 From Employees
                 Group by Department_id);

-What happens when the subconsult returns any lines?

Select Employee_id, First_Name, Last_Name
From Employees
Where Last_Name = (Select Last_Name
                     From Employees
                     Where Last_Name = 'Suzuki');
                     

```
---

<!-- TOC --><a name="2-multiple-row-sub-consults"></a>
### 2-Multiple-Row sub-consults

```sql
-
-
- Section 12 
-Using sub-consults
-
-Class 2-Multiple-Row Sub-Consults
- 
                  
-Multiple-Row sub-consults

Select Employee_id, First_Name, Last_Name
From Employees
WHERE SALARY IN 
                (SELECT AVG (NVL (SALARY, 0))
                 From Employees
                 Group by Department_id);

-Using Not in Operator in Multiple-Row Sub-Consults

Select Employee_id, First_Name, Last_Name
From Employees
WHERE SALARY NOT IN
                (SELECT AVG (NVL (SALARY, 0))
                 From Employees
                 Group by Department_id);
                 
-Using Any Operator in Multiple-Row Sub-Consults

Select Employee_id, Last_Name, Job_id, Salary
From Employees
WHERE SALARY <ANY
                   (SELECT SALARY
                    From Employees
                    Where job_id = 'it_prog');

-Using ALL Operator in Multiple-Row Sub-Consults

Select Employee_id, Last_Name, Job_id, Salary
From Employees
WHERE SALARY <ALL
                   (SELECT SALARY
                    From Employees
                    Where job_id = 'it_prog');
                    
-Care with null values ​​in a sub-consult with operator in

Select emp.employee_id, emp.last_name
From Employees EMP
Where Emp.employee_id In (select mg.manager_id
                           From Employees MGR);

-Care with null values ​​in a sub-consult with not in operator

Select emp.employee_id, emp.last_name
From Employees EMP
Where Emp.employee_id not in (select mg.manager_id
                               From Employees MGR);

```
---

<!-- TOC --><a name="3-using-exists-and-not-exists"></a>
### 3 - Using exists and not exists

```sql
-
- Section 12 
-Using sub-consults
-
- Class 3 - Using exists and not exists 
-

- Using exists operator

Select D.Department_id, D.Department_Name
From Deportments D
Where Exists
             (Select e.department_id
               From Employees and
               Where D.Department_id = 
                             e.department_id);
							 
- Using exists operator

Select D.Department_id, D.Department_Name
From Deportments D
Where exists (select e.department_id
               From Employees and
               Where D.Department_id = E.Department_id);

- Using not exists operator

Select D.Department_id, D.Department_Name
From Deportments D
Where Not Exists (Select E.Department_id
                   From Employees and
                   Where D.Department_id = E.Department_id);
    

```
---

<!-- TOC --><a name="4-using-correlated-subconsult"></a>
### 4 - Using correlated subconsult

```sql
-
- Section 12 
-Using sub-consults
-
- Class 4- Using correlated subconsult
-
  
-Using correlated sub-consults
               
SELECT E1.Eprployee_id, E1.FIRST_NAME, E1.LAST_NAME, E1.Department_id, E1.Salarry
From Employees E1
Where E1.Salarry> = (Select Trunc (AVG (NVL (SALARY, 0)), 0)
                     From Employees E2
                     Where E1.Department_id = E2.Department_id);
                   
SELECT TRUNC (AVG (NVL (SALARY, 0)), 0)
From Employees E2
Where E2.Department_id = 60;


```
---

<!-- TOC --><a name="5-using-multiple-column-sub-consults"></a>
### 5-Using multiple-column sub-consults

```sql
-
- Section 12 
-Using sub-consults
-
-Class 5-Using multiple-column sub-consults 
- 
  
-Using multiple-column sub-consults 

SELECT E1.Epployee_id, E1.FIRST_NAME, E1.JOB_ID, E1.SARARY
From Employees E1
Where (E1.job_id, E1.Salarry) In (Select E2.job_id, Max (E2.Salarry)
                                 From Employees E2
                                 Group by E2.job_id);
								 

```
---

<!-- TOC --><a name="6-using-sub-consults-in-the-from"></a>
### 6 - Using sub -consults in the from

```sql
-
- Section 12 
-Using sub-consults
-
- Class 6- Using sub-consults in the from
-
		
-Using sub-consults in the from

SELECT EMPLOYEES.EMPLEEE_ID, EMPLOYEES.FIRST_NAME, EMPLOYEES.LAST_NAME, EMPLOYEES.JOB_ID, 
       Employees.Salarry, Round (Max_Salarry_job.Max_Salary, 2) Max_Salarry, employees. SALARY - ROUND (max_salary_job.max_salary, 2) Difference
From Employees Employed
  Left Join (Select E2.Job_id, Max (E2.Salarry) Max_Salarry
             From Employees E2
             Group by e2.job_id) max_salary_job
       On employees.job_id = max_salary_job.job_id;
```
---

<!-- TOC --><a name="sub-queries"></a>
### Sub-Queries

```sql
- Sub-Querry- Which employees have the highest salary than average salaries?
SELECT E.FIRST_NAME || '' || e.last_name "employee name",
       E.SARARY "SALARY"
  From Employees and
 Where E.Salarry> (Select AVG (E.Salarry) From Employees e);

-Sub-Query with Having 
SELECT E1.Department_id, Max (E1.SARARY)
  From Employees E1
 Group by E1.Department_id
Having Max (E1.Salarry) <(Select AVG (E2.Salarry) From Employees E2);

-Sub-Query Multiple-Row 
SELECT E1.Eprployee_id, E1.FIRST_NAME, E1.LAST_NAME, E1.SARARY
  From Employees E1
 WHERE E1.SARARY IN
       (SELECT AVG (E2.Salarry) From Employees E2 Group by E2.Department_id);

SELECT E1.Eprployee_id, E1.FIRST_NAME, E1.LAST_NAME, E1.SARARY
  From Employees E1
 Where E1.Salarry <Any - Any 
 (Select E2.Salarry from Employees E2 Where E2.JOB_ID = 'IT_PROG');

SELECT E1.Eprployee_id, E1.FIRST_NAME, E1.LAST_NAME, E1.SARARY
  From Employees E1
 WHERE E1.SARARY <ALL - ALL 
 (Select E2.Salarry from Employees E2 Where E2.JOB_ID = 'IT_PROG');

- exists and not exists
Select D.Department_id, D.Department_Name
  From Deportments D
 Where exists (select e.department_id
          From Employees and
         Where D.Department_id = E.Department_id);

Select D.Department_id, D.Department_Name
  From Deportments D
 Where Not Exists (Select E.Department_id
          From Employees and
         Where D.Department_id = E.Department_id);

- Correlated SubQuery- Return employees who receive more than the average of your department
Select e.employee_id, e.department_id, e.first_name, e.last_name, e.salary
  From Employees and
 Where E.Salarry> = (Select Trunc (AVG (NVL (EE.Salarry, 0)))))
                      From Employees EE
                     Where e.department_id = ee.department_id)
 Order by e.department_id;

Select E.Department_id, Trunc (AVG (NVL (E.Salarry, 0)))))
  From Employees and
 Where E.Department_id In (50, 60)
 Group by E.Department_id;

-Sub-Query Multiple-Column-Returns the employee who receives the highest salary by position
Select e.employee_id, e.first_name, e.last_name, e.job_id, e.salary
  From Employees and
 Where (e.job_id, e.salary) in
       (Select ee.job_id, max (ee.salary)
          From Employees EE
         Group by ee.job_id);

- Sub-Query no from- returns the employee's salary, the highest salary and the difference
Select e.employee_id,
       E.FIRST_NAME,
       e.last_name,
       e.job_id,
       Round (E.SARARY) SALARY,
       Round (max_salarry_job.max_salary),
       Round (E.Salarry - Max_Salarry_job.Max_Salarry) "Difference"
  From Employees E,
       (Select ee.job_id, max (ee.salary) max_sarly
          From Employees EE
         Group by ee.job_id) max_salary_job
 WHERE E.JOB_ID = max_salary_job.job_id (+);

```
---

<!-- TOC --><a name="section-13-set-operators"></a>
## Section 13 - Set Operators

<!-- TOC --><a name="1-set-operators"></a>
### 1 - Set operators

```sql
-
- Section 13 - Class 1
- Set Operators
-
- Class 1 - Set Operators
-

- Using the Union Operator 

Select Employee_id, Job_id, Hire_Date, Salary
From Employees
Where Department_id In (60, 90, 100)
Union
Select Employee_id, Job_id, Hire_Date, Salary
From Employees
Where job_id = 'it_prog'
Order by Employee_id;

- Using the UNION ALL OPERATOR

Select Employee_id, Job_id, Hire_Date, Salary
From Employees
Where job_id = 'it_prog'
UNION ALL
Select Employee_id, Job_id, Hire_Date, Salary
From Employees
Where Department_id = 60
Order by Employee_id;

- Using Intersect operator

Select Employee_id, Job_id
From Employees
Where job_id = 'it_prog'
Intersect
Select Employee_id, Job_id
From Employees
Where Department_id In (60, 90, 100)
Order by Employee_id;

- Using Minus Operator

Select Employee_id, Job_id
From Employees
Where Department_id In (60, 90, 100)
Minus
Select Employee_id, Job_id
From Employees
Where job_id = 'it_prog'
Order by Employee_id;

- Care for data types in the select column or expressions list

Select Employee_id, Job_id, Hire_Date
From Employees
Where Department_id In (60, 90, 100)
Union
Select Employee_id, Job_id, Salary
From Employees
Where job_id = 'it_prog'
Order by Employee_id;

- Correcting the error

Select Employee_id, Job_id, Hire_Date, Salary
From Employees
Where Department_id In (60, 90, 100)
Union
Select Employee_id, Job_id, Hire_Date, Salary
From Employees
Where job_id = 'it_prog'
Order by Employee_id;

- Using more than one set operator

Select Employee_id, Job_id, Hire_Date, Salary
From Employees
Where Department_id In (60, 90, 100)
Union
(Select Employee_id, Job_id, Hire_Date, Salary
From Employees
Where job_id = 'it_prog'
Intersect
Select Employee_id, Job_id, Hire_Date, Salary
From Employees
WHERE SALARY> 10000)
Order by Employee_id;
```
--- ### Operators Set - Union, Union All, Intersect, Minus

```sql
-Set Operator -> Union
Select e.employee_id, e.job_id, e.hire_date, e.salary
  From Employees and
 Where E.Department_id In (60, 90, 100)
Union
Select e.employee_id, e.job_id, e.hire_date, e.salary
  From Employees and
 Where e.job_id = 'it_prog'
 Order by Employee_id;

-SET OPERATOR -> UNION ALL
Select e.employee_id, e.job_id, e.hire_date, e.salary
  From Employees and
 Where E.Department_id In (60, 90, 100)
UNION ALL
Select e.employee_id, e.job_id, e.hire_date, e.salary
  From Employees and
 Where e.job_id = 'it_prog'
 Order by Employee_id;

-Set Operator -> Intersect
Select e.employee_id, e.job_id, e.hire_date, e.salary
  From Employees and
 Where E.Department_id In (60, 90, 100)
Intersect
Select e.employee_id, e.job_id, e.hire_date, e.salary
  From Employees and
 Where e.job_id = 'it_prog'
 Order by Employee_id;

-Set Operator -> Minus
Select e.employee_id, e.job_id, e.hire_date, e.salary
  From Employees and
 Where E.Department_id In (60, 90, 100)
Minus
Select e.employee_id, e.job_id, e.hire_date, e.salary
  From Employees and
 Where e.job_id = 'it_prog'
 Order by Employee_id;

```
---

<!-- TOC --><a name="section-14-dml-commands-manipulating-data"></a>
## Section 14 - DML Commands - Manipulating Data

<!-- TOC --><a name="1-dml-commands-manipulating-data"></a>
### 1 - DML Commands Manipulating Data

```sql
-
- Section 14 
- DML Commands - Manipulating Data 
-
- Class 1 - DML Commands - Manipulating Data 
- 

- Using the Insert command

INSERT INTO DEPARTMENTS (Department_id,
department_name, manager_id, location_id)
VALUES (280, 'Project Management', 103, 1400);

- Inserting lines with null values- Explicit Metdo

INSERT INTO DEPARTMENTS
VALUES (290, 'Data Science', null, null);

- Inserting lines with null values- implicit method

INSERT INTO DEPARTMENTS (Department_id,
department_name)
VALUES (300, 'BUSINESS INTELLIGENCE');
Des Des Departments

- Inserting lines with null values- Explicit Metdo

INSERT INTO DEPARTMENTS
VALUES (301, 'INOVATION', NULL, NULL);

- Inserting lines with null values- implicit method

INSERT INTO DEPARTMENTS (Department_id,
department_name)
VALUES (302, 'IoT');

Commit;

- Inserting special values ​​returned from functions

INSERT INTO EMPLOYEES 
           (employee_id, first_name, last_name, email, 
            Phone_number, hire_date, job_id, salary,
            commission_pct, manager_id, department_id)
       VALUES (207, 'Rock', 'Balboa', 'Drock', 
               '525,342,237', Sysdate, 'it_prog', 7000,
               Null, 103, 60);

- Insert using specific date and time

INSERT INTO EMPLOYEES 
           (employee_id, first_name, last_name, email, 
            Phone_number, hire_date, job_id, salary,
            commission_pct, manager_id, department_id)
       VALUES (208, 'VITO', 'COLLEONE', 'VCOL', 
               '525,342,237', to_date ('11/02/2020 ',' dd/mm/yyyy '),' it_prog ', 20000,
               Null, 103, 60);
               
SELECT *
From Employees
Order by Employee_id Desi;

Commit;

- Using substitution variables

SELECT *
From Deportments
Order by Department_id Desc;

INSERT INTO DEPARTMENTS
(department_id, department_name, location_id)
VALUES (& department_id, '& department_name', & location);

Commit;

-Inserting lines from a subconsult

DROP TABLE SALES_REPS;

Create Table Sales_Reps
(ID Number (6.0),
 Name Varchar2 (20),
 SALARY NUMBER (8.2),
 Commission_PCT Number (2.2));

INSERT INTO SALES_REPS (ID, NAME, SALARY, COMMISSON_PCT)
Select Employee_id, Last_Name, Salary, Commission_PCT
From Employees
Where Job_id = 'Sa_REP';

Commit;

SELECT *
From Sales_Reps;

- Using the Update command

UPDATE EMPLOYEES
SET SALLARY = SALARY * 1.2;

Rollback;

UPDATE EMPLOYEES
SET SALARY = SALARY * 1.2
Where Last_Name = 'King';

Commit;

SELECT *
From Employees
Where Last_Name = 'King';

-Using the Update Command with Sub-Consultations

UPDATE EMPLOYEES
Set Job_id = (Select Job_id
              From Employees
              Where Employee_id = 141),
    SALARY = (SELECT SALARY
              From Employees
              Where Employee_id = 141)
Where Employee_id = 140;

Commit;

- Using the delete command

Delete From Countries
WHERE COUNTRY_NAME = 'Nigeria';

Rollback;

- Using the Rollback command

Delete from Employees
Where Employee_id = 208;

- Using the Commit Command

Commit;

- Using the Commit Command

- Using SavePoint

Delete from Employees
Where Employee_id In (207,208);

Commit;

INSERT INTO EMPLOYEES 
           (employee_id, first_name, last_name, email, 
            Phone_number, hire_date, job_id, salary,
            commission_pct, manager_id, department_id)
       VALUES (207, 'Rock', 'Balboa', 'Drock', 
               '525,342,237', Sysdate, 'it_prog', 7000,
               Null, 103, 60);

SavePoint A;

INSERT INTO EMPLOYEES 
           (employee_id, first_name, last_name, email, 
            Phone_number, hire_date, job_id, salary,
            commission_pct, manager_id, department_id)
       VALUES (208, 'VITO', 'COLLEONE', 'VCOL', '525,342,237', to_date ('11/02/2020 ',' dd/mm/yyyy '),' it_prog ', 20000,
               Null, 103, 60);
               
Rollback to SavePoint A;

Commit; 

SELECT *
From Employees
Order by Employee_id Desi;

- For Update Clause in Select Command 

Select Employee_id, Salary, Commission_PCT, Job_id
From Employees
Where job_id = 'sa_rep'
For update
Order by Employee_id;

Commit;

Select e.employee_id, e.salary, e.comMission_pct
From Employees and Join Departments D
Using (department_id)
Where job_id = 'St_clerk'
And location_id = 1500
For update of e.salary
Order by e.employee_id;

Commit;
```
---

<!-- TOC --><a name="dml-commands-manipulating-data"></a>
### DML Commands Manipulating Data

```sql
- Example of INSERT
INSERT INTO DEPARTMENTS
  (department_id, department_name, manager_id, location_id)
VALUES
  (280, 'Project Management', 103, 1400);

- Example of INSERT with values ​​null explicit method - order of table structure
INSERT INTO DEPARTMENTS VALUES (290, 'PROJECT MANAGEMENT', NULL, NULL);

- Example of INSERT with values ​​null implicit method - order of table structure
INSERT INTO DEPARTMENTS
  (department_id, department_name)
VALUES
  (300, 'Business Intelligence');

- inserting special values ​​returned
INSERT INTO EMPLOYEES
  (Employee_id,
   First_Name,
   Last_Name,
   e-mail,
   Phone_number,
   hire_date,
   job_id,
   SALARY,
   commission_pct,
   manager_id,
   department_id)
VALUES
  (employees_seq.nextval,
   'Lucas',
   'Pink',
   'lucas@email.com',
   '222-222',
   SYSDATE,
   'IT_PROG',
   5000,
   0.1,
   100,
   90);

UPDATE EMPLOYEES
   Set email = '& email',
       Phone_number = '& Phone_number',
       hire_date = '& hire_date'
 Where Employee_id = 207;

Commit;

SELECT * from Departments D Where D.Department_id In (280, 290, 300);
Select * From Jobs J;
SELECT * From Employees and Order by e.employee_id Desi;

- Create Table
Create Table Sales_Reps (ID Number (6, 0),
                        Name Varchar2 (20),
                        SALARY NUMBER (8, 2),
                        Commission_pct Number (2, 2));

INSERT INTO SALES_REPS
  (id, name, salary, commission_pct)
  Select e.employee_id, e.last_name, e.salary, e.comMission_pct
    From Employees and
   Where e.job_id = 'sa_rep';

SELECT * FROM SALES_REPS; 

```
---

<!-- TOC --><a name="section-15-ddl-commands"></a>
## Section 15 - DDL Commands

<!-- TOC --><a name="1-creating-and-managing-tables"></a>
### 1 - Creating and Managing Tables

```sql
-
- Section 15 
- DDL Commands 
-
- Class 1 - Creating and Managing Tables
-

- Consulting the HR User Schema objects

SELECT *
From user_objects
Order by Object_Type;

- Creating Tables

Drop table projects;
Create Table Projects
(Project_id Number (6) Not null,
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varcha2 (400) not null);
 
 Descts Descts
 
 SELECT *
 From projects;
 
DROP Table Teams;

Create Table Teams
(Project_id Number (6) Not null,
 Employee_id Number (6) Not null);

- Consulting the structure of the table

Descts Descts

Teams;

- Rowid type

EMPLOYEES

Select Employee_id, First_Name, Rowid, Length (Rowid)
From Employees
Where Rowid = 'aaar6yaaaaaalbbae';

- Consulting the existing tables by the data dictionary

User_Tables

Select table_name
From user_tables;

- Consulting the user's table objects

User_Objects

Select Object_Name, Object_Type
From user_objects
Where Object_Type = 'Table';

-Creating a table using a subconsult

DROP TABLE EMPLOYEES_DEPARTMENT60;

Create Table Employees_Department60
TO THE
Select Employee_id, Last_Name, Salary*12 Ansal, Hire_Date
From Employees
Where Department_id = 60;

DescpLoyees_Department60

SELECT *
From Employees_Department60;

- TRUNCATE TABLE

TABLE TRUNCATE EMPLOYEES_DEPARTMENT60;

SELECT *
From Employees_Department60;

- Drop table

DROP TABLE EMPLOYEES_DEPARTMENT60;

SELECT *
From Employees_Department60;

- Consulting the trash

SELECT *
From user_recyclebin;
```
---

<!-- TOC --><a name="2-changing-the-table-structure"></a>
### 2 - Changing the table structure

```sql
-
- Section 15 
- DDL Commands 
-
- Class 2 - Changing the table structure
-

- Alter table- adding a column

Alter table projects
Add (Department_id Number (3)); 

Descts Descts

- Alter table- Removing a column

Alter table projects
DROP Column Department_id; 

Descts Descts

- Alter table- adding a column

Alter table projects
Add (Department_id Number (4) not null); 

Descts Descts

- Alter table- adding a column

Alter table projects
Modify (Project_Code Varchar2 (6));
                             
Descts Descts
               
- Alter Table- Renaming a column

Alter table projects
RENAME COLUMN PROJECT_NAME TO NAME;

Descts Descts

- Alter Table- Read Only

Alter table Employees Read Only;

- Alter Table- Read Write Alter table Employees Read Write;
```
---

<!-- TOC --><a name="ddl-commands"></a>
### DDL Commands

```sql
- Creating Tables
Create Table Projects
(Project_id Number (6) Not null,
Project_Code Varchar2 (10) Not null, 
Project_Name Varchar2 (100) Not null,
CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
START_DATE DATE,
End_Date Date,
status varchar2 (20) not null,
Priority Varchar2 (10) Not null,
Budget Number (11,2) Not null,
Description Varcha2 (400) not null);

Create Table Teams
(Project_id Number (6) Not null,
Employee_id Number (6) Not null);

- Consulting User Tables
Select table_name from user_tables;

Select Object_Name, Object_Type
  From user_objects
 Where Object_Type = 'Table';

- Changing Tables
Alter table projects Add (Department_id Number (3));
Alter table projects drop column department_id;
Alter table projects modify (project_code varchar2 (6));
Alter table projects RENAME COLUMN PROJECT_NAME TO NAME;
Alter table projects read only; 

```
---

<!-- TOC --><a name="section-16-managing-constraints"></a>
## Section 16 - Managing constraints

<!-- TOC --><a name="1-creating-constraints-in-the-creation-of-the-table"></a>
### 1 - Creating constraints in the creation of the table

```sql
-
- Section 16 
- Creating and managing constraints 
-
- Class 1 - Creating and managing constraints in the creation of the table
-

- Defining constraint not null

Drop table projects;
Create Table Projects
(Project_id Number (6) Not null,
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 Department_id Number (4) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varcha2 (400) not null);
 
 - Defining Constraint Primary Key at Column Level

Drop table projects;
Create Table Projects
(Project_id Number (6) Not null
 Constraint projects_project_id_pk primary key,
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 Department_id Number (4) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varcha2 (400) not null);
 
 - Defining Constraint Primary Key at Table Level

Drop table projects;
Create Table Projects
(Project_id Number (6) Not null, 
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 Department_id Number (4) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varchar2 (400) not null,
 Constraint projects_project_id_pk primary key (project_id));
 
 - Defining constraint unique at column level

Drop table projects;
Create Table Projects
(Project_id Number (6) Not null
 Constraint projects_project_id_pk primary key,
 Project_code Varchar2 (10) not null
 Constraint projects_project_code_uk unique,
 Project_Name Varchar2 (100) Not null,
 Department_id Number (4) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varcha2 (400) not null);
 
 - Defining constraint unique at table level

Drop table projects;
Create Table Projects
(Project_id Number (6) Not null, 
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 Department_id Number (4) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varchar2 (400) not null,
 Constraint projects_project_id_pk primary key (project_id),
 Constraint projects_project_code_uk unique (project_code));
 
  - Defining Constraint Foreign Key at Column Level

Drop table projects;
Create Table Projects
(Project_id Number (6) Not null
 Constraint projects_project_id_pk primary key,
 Project_code Varchar2 (10) not null
 Constraint projects_project_code_uk unique,
 Project_Name Varchar2 (100) Not null,
 Department_id Number (4) not null
 Constraint projects_department_id_fk Referencies Department,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varcha2 (400) not null);
 
 - Defining Constraint Foreign Key at Table Level

Drop table projects;
Create Table Projects
(Project_id Number (6) Not null, 
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 Department_id Number (4) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null, Budget Number (11,2) Not null,
 Description Varchar2 (400) not null,
 Constraint projects_project_id_pk primary key (project_id),
 Constraint projects_project_code_uk unique (project_code),
 Constraint projects_department_id_fk Foreign Key (department_id)
 Departmental References (Department_id));
 
 - Foreign Key- Deletion Rules- Default on Action
 
DROP Table Teams;
Create Table Teams
(Project_id Number (6) Not null,
 Employee_id Number (6) Not null,
 Constraint teams_project_id_fk Foreign Key (Project_id)
 REFERENCES PROJECTS (PROJECT_ID),
 Constraint teams_employee_id_fk Foreign Key (employee_id)
 References Employees (Employee_id));
 
 - Foreign Key- Deletion Rules- On Delete Cascade
 
DROP Table Teams;
Create Table Teams
(Project_id Number (6) Not null,
 Employee_id Number (6) Not null,
 Constraint teams_project_id_fk Foreign Key (Project_id)
 REFERENCES PROJECTS (PROJECT_ID) ON DELETE CASCADE,
 Constraint teams_employee_id_fk Foreign Key (employee_id)
 References Employees (Employee_id));
 
 - Foreign Key- Deletion Rules- On Delete Set null
 
DROP Table Teams;
Create Table Teams
(Project_id Number (6),
 Employee_id Number (6) Not null,
 Constraint teams_project_id_fk Foreign Key (Project_id)
 REFERENCES PROJECTS (PROJECT_ID) ON DELETE SET NULL,
 Constraint teams_employee_id_fk Foreign Key (employee_id)
 References Employees (Employee_id));
 
 - Defining constraint check in column level
 
DROP Table Projects Cascade Constraints;
Create Table Projects
(Project_id Number (6) Not null
 Constraint projects_project_id_pk primary key,
 Project_code Varchar2 (10) not null
 Constraint projects_project_code_uk unique,
 Project_Name Varchar2 (100) Not null,
 Department_id Number (4) not null
 Constraint projects_department_id_fk Referencies Department,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11.2) Not null 
 Constraint projects_budget_ck check (budget> 0),
 Description Varcha2 (400) not null);
 
 - Defining Constraint Foreign Key at Table Level

DROP Table Projects Cascade Constraints;
-
- Section 16 - Class 1
- Creating and managing constraints in the creation of the table
-

- Defining constraint not null

Drop table projects;
Create Table Projects
(Project_id Number (6) Not null,
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 Department_id Number (4) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varcha2 (400) not null);
 
 - Defining Constraint Primary Key at Column Level

Drop table projects;
Create Table Projects
(Project_id Number (6) Not null
 Constraint projects_project_id_pk primary key,
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 Department_id Number (4) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varcha2 (400) not null);
 
 - Defining Constraint Primary Key at Table Level

Drop table projects;
Create Table Projects
(Project_id Number (6) Not null, 
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 Department_id Number (4) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varchar2 (400) not null,
 Constraint projects_project_id_pk primary key (project_id));
 
 - Defining constraint unique at column level

Drop table projects;
Create Table Projects
(Project_id Number (6) Not null
 Constraint projects_project_id_pk primary key,
 Project_code Varchar2 (10) not null
 Constraint projects_project_code_uk unique,
 Project_Name Varchar2 (100) Not null,
 Department_id Number (4) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varcha2 (400) not null);
 
 - Defining constraint unique at table level

Drop table projects;
Create Table Projects
(Project_id Number (6) Not null, 
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 Department_id Number (4) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varchar2 (400) not null,
 Constraint projects_project_id_pk primary key (project_id), Constraint projects_project_code_uk unique (project_code));
 
  - Defining Constraint Foreign Key at Column Level

Drop table projects;
Create Table Projects
(Project_id Number (6) Not null
 Constraint projects_project_id_pk primary key,
 Project_Code Varchar2 (10) Not null
 Constraint projects_project_code_uk unique,
 Project_Name Varchar2 (100) Not null,
 Department_id Number (4) not null
 Constraint projects_department_id_fk Referees Departments (department_id),
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varcha2 (400) not null);
 
 - Defining Constraint Foreign Key at Table Level

Drop table projects;
Create Table Projects
(Project_id Number (6) Not null, 
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 Department_id Number (4) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varchar2 (400) not null,
 Constraint projects_project_id_pk primary key (project_id),
 Constraint projects_project_code_uk unique (project_code),
 Constraint projects_department_id_fk Foreign Key (department_id)
 Departmental References (Department_id));
 
 - Foreign Key- Deletion Rules- Default on Action
 
DROP Table Teams;
Create Table Teams
(Project_id Number (6) Not null,
 Employee_id Number (6) Not null,
 Constraint teams_project_id_fk Foreign Key (Project_id)
 REFERENCES PROJECTS (PROJECT_ID),
 Constraint teams_employee_id_fk Foreign Key (employee_id)
 References Employees (Employee_id));
 
 - Foreign Key- Deletion Rules- On Delete Cascade
 
DROP Table Teams;
Create Table Teams
(Project_id Number (6) Not null,
 Employee_id Number (6) Not null,
 Constraint teams_project_id_fk Foreign Key (Project_id)
 REFERENCES PROJECTS (PROJECT_ID) ON DELETE CASCADE,
 Constraint teams_employee_id_fk Foreign Key (employee_id)
 References Employees (Employee_id));
 
 - Foreign Key- Deletion Rules- On Delete Set null
 
DROP Table Teams;
Create Table Teams
(Project_id Number (6),
 Employee_id Number (6) Not null,
 Constraint teams_project_id_fk Foreign Key (Project_id)
 REFERENCES PROJECTS (PROJECT_ID) ON DELETE SET NULL,
 Constraint teams_employee_id_fk Foreign Key (employee_id)
 References Employees (Employee_id));

 - Oracle functions (cannot be referenced at the constraint check
 
 Select Uid, Userenv ('Language'), User, Sysdate
 From dual;
 
 Select Employee_id, First_Name, Rownum
 From Employees;
 
- Defining constraint check in column level

DROP Table Projects Cascade Constraints;

Create Table Projects
(Project_id Number (6) Not null
 Constraint projects_project_id_pk primary key,
 Project_Code Varchar2 (10) Not null
 Constraint projects_project_code_uk unique,
 Project_Name Varchar2 (100) Not null,
 Department_id Number (4) not null
 Constraint projects_department_id_fk Referencies Department,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11.2) Not null 
 Constraint projects_budget_ck check (budget> 0),
 Description Varcha2 (400) not null);
 
 - Defining constraint check in table level

DROP Table Projects Cascade Constraints;

Create Table Projects
(Project_id Number (6) Not null, 
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 Department_id Number (4) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varchar2 (400) not null,
 Constraint projects_project_id_pk primary key (project_id),
 Constraint projects_project_code_uk unique (project_code),
 Constraint projects_department_id_fk Foreign Key (department_id)
 Departmental References (Department_id),
 Constraint projects_budget_ck check (budget> 0));
 
 - Violating constraints - Error
 
 INSERT INTO PROJECTS (
    Project_id, Project_Code, Project_Name, Department_id,
    Creation_date, Start_date, End_Date, Status, Priority,
    budget, description) 
    VALUES (
    1, 'Erpimp', 'ERP Implementation', 77,
    Sysdate, null, null, 'use', 'high',
    1000000.00, 'Oracle ERP Implementation');
    
- Violating constraints - correcting 

INSERT INTO PROJECTS (
    Project_id, Project_Code, Project_Name, Department_id,
    Creation_date, Start_date, End_Date, Status, Priority,
    budget, description) 
    VALUES (
    1, 'Erpimp', 'ERP Implementation', 60,
    Sysdate, null, null, 'use', 'high',
    1000000.00, 'Oracle ERP Implementation');

Commit; - Consulting constraints for the data dictionary

User_Constraints

User_Cons_Columns

Select co.constraint_name,
       co.constraint_type,
       co.search_condition,
       co.r_constraint_name,
       co.delete_rule,
       cc.column_name,
       CC.POSITION,
       co.status
 From user_constraints co
   Join user_cons_columns cc on (co.constraint_name = cc.constraint_name) and 
                                (co.table_name = cc.table_name)
 Where co.table_name = 'projects'
 Order by co.constraint_name,
          CC.POSITION;
```
---

<!-- TOC --><a name="2-managing-constraints"></a>
### 2 - Managing constraints

```sql
-
- Section 16 
- Creating and managing constraints 
-
- Class 2 - Managing constraints
-

- Consulting constraints for the data dictionary

Select co.constraint_name,
               co.constraint_type,
               co.search_condition,
               co.r_constraint_name,
               co.delete_rule,
               cc.column_name,
               CC.POSITION,
               co.status
 From user_constraints co
   Join user_cons_columns cc on (co.constraint_name = cc.constraint_name) and 
                                (co.table_name = cc.table_name)
 Where co.table_name = 'projects'
 Order by co.constraint_name,
          CC.POSITION;
          
- Removing a constraint to a table

Alter table projects
Drop constraint projects_department_id_fk;

Alter table projects
Drop constraint projects_project_id_pk Cascade;

- Adding a constraint to a table

Alter table projects
Add constraint projects_department_id_fk Foreign Key (department_id)
Departmental References (Department_id);

Alter table projects
Add Constraint Projects_Project_id_PK Primary Key (Project_id);

- Disabling a constraint

Alter table projects
DISABLE CONSTRINT PROJECTS_DEPARTMENT_ID_FK;

Alter table projects
Disable Constraint Projects_Project_id_PK Cascade;

- Enabling a constraint

Alter table projects
ENABLE CONSTRINT PROJECTS_DEPARTMENT_ID_FK;

Alter table projects
ENABLE CONSTRINT PROJECTS_PROJECT_ID_PK;
```
---

<!-- TOC --><a name="constrants"></a>
### CONSTRANTS

```sql
Drop table projects;

- Primary Key at Column Level
Create Table Projects
(Project_id Number (6) Not null constraint projects_project_id_pk primary key,
 Project_Code Varchar2 (10) not null constraint projects_project_code_uk unique,
 Project_Name Varchar2 (100) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varcha2 (400) not null);
 
 - Primary Key at the table level
Create Table Projects
(Project_id Number (6) Not null,
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varchar2 (400) not null, 
 Constraint projects_project_id_pk primary key (project_id),
 Constraint projects_project_code_uk unique (project_code));
 
  - Foreign Key at Column Level
Create Table Projects
(Project_id Number (6) Not null,
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 Department_id Number (4) not null
 Constraint projects_department_id_fk Referees Departments (department_id),
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varchar2 (400) not null, 
 Constraint projects_project_id_pk primary key (project_id),
 Constraint projects_project_id_ul unique (project_code));
 
   - Foreign Key at Table Level
Create Table Projects
(Project_id Number (6) Not null,
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 Department_id Number (4) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varchar2 (400) not null, 
 Constraint projects_project_id_pk primary key (project_id),
 Constraint projects_project_code_uk unique (project_code),
 Constraint projects_department_id_fk Foreign Key (department_id) Reports Department (department_id));
 
DROP Table Teams;

 - Foreign Key - No Action 
Create Table Teams
(Project_id Number (6) Not null,
 Employee_id Number (6) Not null,
 Constraint teams_project_id_fk Foreign Key (Project_id)
 REFERENCES PROJECTS (PROJECT_ID),
 Constraint team_employee_id_fk Foreign Key (employee_id)
 References Employees (Employee_id));
 
 - Foreign Key - On Delete Cascade
(Project_id Number (6) Not null,
 Employee_id Number (6) Not null,
 Constraint teams_project_id_fk Foreign Key (Project_id)
 REFERENCES PROJECTS (PROJECT_ID) ON DELETE CASCADE, Constraint team_employee_id_fk Foreign Key (employee_id)
 References Employees (Employee_id));
 
  - Foreign Key - On Delete Set null
(Project_id Number (6) Not null,
 Employee_id Number (6) Not null,
 Constraint teams_project_id_fk Foreign Key (Project_id)
 REFERENCES PROJECTS (PROJECT_ID) ON DELETE SET NULL,
 Constraint team_employee_id_fk Foreign Key (employee_id)
 References Employees (Employee_id));

```
---

<!-- TOC --><a name="section-17-views"></a>
## Section 17 - Views

<!-- TOC --><a name="1-creating-and-managing-visions"></a>
### 1 - Creating and Managing Visions

```sql
-
- Section 17 
- Creating and Managing Visions
-
- Class 1 - Creating and Managing Visions
-

- Creating a vision

Create or Replace View VemployeesDept60
AS Select Employee_ID, FIRST_NAME, LAST_NAME, DEPARTMENT_ID, SALARY, COMMISSON_PCT
From Employees
Where Department_id = 60;

Desc vemplooyeesdept60

- Recovering data using a vision

SELECT *
From vemployeesdept60;

- Creating a complex view 

Create or Replace View Vdepartments_Total
(Department_id, Department_Name, Minasal, Maxal, AVGSAL)
A.Department_id, D.Department_Name, Min (E.Salarry),
          Max (E.Salarry), AVG (E.SARARY)
From Employees and 
  Join Deportments D
On (e.department_id = d.department_id)
Group by E.Department_id, Department_Name;

SELECT * 
From vdepartments_total;

- Using the Check Option clause

Create or Replace View VemployeesDept100
AS SELECT EMPLOYEE_ID, FIRST_NAME, LAST_NAME, DEPARTMENT_ID, SALARY
From Employees
Where Department_id = 100
With check option constraint vemployeesdept100_ck;

- Using the Read Only clause

Create or Replace View VemployeesDept20
AS SELECT EMPLOYEE_ID, FIRST_NAME, LAST_NAME, DEPARTMENT_ID, SALARY
From Employees
Where Department_id = 20
With read only;

- Removing a vision

DROP VIEW VEMPLOYEESDEPT20;

```
---

<!-- TOC --><a name="views"></a>
### Views

```sql
- views
Create or replace view vw_employeesdpt60
The select e.employee_id, e.first_name, e.last_name, e.department_id, e.salary
From Employees and
Where E.Department_id = 60;

SELECT * FROM VW_EPPLOYEESDPT60;

- Complex View
Create or replace view vw_departments_total 
(Department_id, Department_Name, Minasal, Maxal, AVGSAL)
AS SELECT D.DEPARTMENT_ID, D.DEPARTMENT_NAME, 
Max (E.Salarry), Min (E.Salarry), Round (AVG (E.Salarry), 0)
From Employees E, Departments D
Where e.department_id = d.department_id
Group by D.Department_id, D.Department_Name
Order by D.Department_id;

SELECT * from vw_departments_total;

- view with check option
- views
Create or replace view vw_employeesdpt100
The select e.employee_id, e.first_name, e.last_name, e.department_id, e.salary
From Employees and
Where e.department_id = 100
With check option constraint vw_employeesdpt100_ck;

SELECT * FROM VW_EPPLOYEESDPT100;

```
---

<!-- TOC --><a name="section-18-sequences"></a>
## Section 18 - Sequences

<!-- TOC --><a name="1-creating-and-managing-sequences"></a>
### 1 - Creating and Managing Sequences

```sql
-
- Section 18 
- Creating and Managing Sequences
-
- Class 1 - Creating and Managing Sequences
-

- Creating a sequence

Select Max (Employee_id)
From Employees;

Drop Sequence Employees_SEQ;

CREATE SEQUENCE EMPLOYEES_SEQ
Start with 210
Increment by 1
Nomaxvalue 
Nocache
Nocycle;

- Consulting sequences of the data dictionary

SELECT *
From user_sequences;

- Recovering next sequence value

SELECT EMPLOYEES_SEQ.NEXTVAL
From dual;

- Recovering the current value of the sequence

SELECT EMPLOYEES_SEQ.CURRVAL
From dual;

- Removing a sequence 

Drop Sequence Employees_SEQ;

- recreating a sequence

CREATE SEQUENCE EMPLOYEES_SEQ
Start with 210
Increment by 1
Nomaxvalue 
Nocache
Nocycle;

- Using a sequence 

INSERT INTO EMPLOYEES 
           (employee_id, first_name, last_name, email, 
            Phone_number, hire_date, job_id, salary,
            commission_pct, manager_id, department_id)
       VALUES (EMPLOYEES_SEQ.NEXTVAL, 'PAUL', 'SIMON', 'PSIMO', 
               '525,342,237', to_date ('12/02/2020 ',' dd/mm/yyyy '),' it_prog ', 15000,
               Null, 103, 60);

SELECT *
From Employees
Order by Employee_id Desi;

Commit;

- Modifying a sequence

Alter Sequence Employees_SEQ
Maxvalue 999999
Cache 20;
```
---

<!-- TOC --><a name="sequence"></a>
### Sequence

```sql
- Sequence
Select Max (Employee_id)
From Employees;

Drop Sequence Employees_SEQ;

CREATE SEQUENCE EMPLOYEES_SEQ
Start with 208
Increment by 1
Nomaxvalue
Nocache
Nocycle;

- Consulting Sequence
SELECT * 
From user_objects u
Where U.Object_Type Like '%Sequence%';

SELECT * 
From user_sequences;

Alter Sequence Employees_SEQ
Cache 20;

```
---

<!-- TOC --><a name="section-19-indexes"></a>
## Section 19 - Indexes

<!-- TOC --><a name="1-creating-and-managing-indexes"></a>
### 1 - Creating and Managing Indexes

```sql
-
- Section 19 
- Creating and Managing Indexes
-
- Class 1 - Creating and Managing Indexes
-

- Analyze the cost of the command in the execution plan

DROP Index EMP_NAME_IX;
Drop Index Employees_last_Name_idx;
Drop index employees_name_idx;

SELECT *
From Employees
Where Last_Name = 'Himuro';

- Creating a simple index

Create Index Employees_last_Name_idx
On Employees (Last_Name);

- Analyze the cost of the command in the execution plan

SELECT *
From Employees
Where Last_Name = 'Himuro'; - Creating a compound index

Create Index Employees_last_Name_First_Name_idx
On Employees (Last_Name, First_Name);

- Analyze the cost of the command in the execution plan

SELECT *
From Employees
Where Last_Name = 'Himuro' and 
      First_Name = 'Guy';

- Reconstructing and reorganizing an index

ALTER INDEX EMPLOYEES_LAST_NAME_FIRST_NAME_IDX REBUILD;

- Removing an index

Drop Index Employees_last_Name_idx;

- Consulting Indexes

Select ix.index_name,
       ic.column_position,
       IC.Column_Name,
       IX.index_Type,
       IX.Uniqueness,
       IX.status
From user_indexes IX
  Join User_ind_Columns IC On (IX.index_Name = IC.index_name) and 
                              (ix.table_name = ic.table_name)
Where Ix.Table_Name = 'Employees'
Order by IX.index_name, IC.Column_POSITION; 

- Removing an index

Drop Index Employees_last_Name_idx;

Drop Index Employees_last_Name_First_Name_idx;
```
---

<!-- TOC --><a name="index"></a>
### Index

```sql
DROP Index EMP_NAME_IX;
Drop index employees_name_idx;
Drop Index Employees_last_Name_idx;

Select * From Employees and Where E.last_Name = 'Himuro';

- Index
Create Index Employees_last_Name_idx
On Employees (Last_Name);

```
---

<!-- TOC --><a name="section-20-synonyms"></a>
## Section 20 - Synonyms

<!-- TOC --><a name="creating-synonyms"></a>
### Creating Synonyms

```sql
-
- Section 20 
- Creating Synonyms
-
- Class 1 - Creating Synonyms
-

- Creating Private Synonyms

Create Synonym Departments
For Department;

Create Synonym Dept
For Department;

- Using synonyms

SELECT *
From departments;

SELECT *
From dept;

- Removing Synonyms

DROP Synonym Departments;

Drop synonym dept;

- Creating public synonyms for tables in another Schema

-Connect as SYS

Create Public Synonym Departments
For Hr.Departments;

Create Public Synonym Dept
For Hr.Departments;

-Connect as SYS

SELECT *
From departments;

SELECT *
From dept;

-Connect like HR

SELECT *
From departments;

SELECT *
From dept;

- Removing public synonyms

-Connect as SYS

DROP PUBLIC SYNONYM DEPARTMENTS;

DROP PUBLIC SYNONYM DEPT;
```
---

<!-- TOC --><a name="section-21-using-sql-plus"></a>
## Section 21 - Using SQL Plus

<!-- TOC --><a name="exampleaccept"></a>
### ExampleACCEPT

```sql
ACCEPT PNOME PROMPT 'Enter employee name:'
Select Employee_id, First_Name, Last_Name
From Employees
Where Upper (First_Name) = Upper ('& PNex');
```
---

<!-- TOC --><a name="examplesqlplus"></a>
### Examplesqlplus

```sql
Select Employee_id, First_Name, Last_Name 
From Employees
WHERE SALARY> 3500
/

```
---

<!-- TOC --><a name="using-sql-plus"></a>
### Using SQL Plus

```sql
-
- Section 21 
- Using SQL*Plus 
-
- Class 1
-

- in Windows

CMD

--- in the Windows command line

sqlplus hr/hr@xepdb1

- Testing  

SQL> SELECT SYSDATE 
From dual;


- Performing the Command Des Des

SQL> DescpLoyees

- Performing an SQL command

SQL> Select Employee_id, First_Name, Last_Name, Salary
From Employees;

- Listing SQL Buffer

SQL> List

SQL> L

- Editing the SQL*Plus buffer

SQL> Edit

SQL> Select Employee_id, First_Name, Last_Name, Salary, Commission_PCtedit
From Employees;

- Listing SQL Buffer

SQL> L

- Performing the SQL Buffer command

SQL> /

or 

SQL> RUN

- Saved the SQL Buffer command in a command file of commands

SQL> Save Example01.SQL 

- Editing the SCRIPT File of Commands

Sql> edit example01.sql

Select Employee_id, First_Name, Last_Name,
 Salary, commission_pct, department_id
From Employees
Order by Employee_id;

- Running the Command Script file

Sql> @example01.sql

SQL> Start Example01.SQL

- Operating System

SQL> Host

exit


- Directing Sahostda from the command execution to a spool file

Sql> spool Example01.txt

SQL> Select Employee_id, First_Name, Last_Name, Salary
From Employees;

Sql> spool off 

- Viewing the Spool file

SQL> Edit Example01.txt

- Using the ACCEPT command

SQL> Edit Example02.SQL

ACCEPT PID PROMPT 'Enter employee ID:'
Select Employee_id, First_Name, Last_Name, Salary
From Employees
Where Employee_id = & Pid
Order by Employee_id;

- Running the Command Script file

Sql> @example02.sql

Enter employee ID: 110

SQL> Edit Example03.SQL

ACCEPT PNOME PROMPT 'Enter the first name:'
Select Employee_id, First_Name, Last_Name, Salary
From Employees
Where Upper (First_Name) = Upper ('& PNew')
Order by Employee_id;

- Running the Command Script file

Sql> @example03.sql

Enter the first name: John

- SQL Environment Variables*Plus

SQL> Show All

SQL> Verify Show

- Performing the Command Script file

Sql> @example02.sql


SQL> Set Verify Off

- Performing the Command Script file

Sql> @example02.sql

- disconnecting and ending the session normally in SQL*Plus

SQL> Exit

or

SQL> quit














```
---

<!-- TOC --><a name="section-22-database-objects"></a>
## Section 22 - Database Objects

<!-- TOC --><a name="database-objects"></a>
### Database Objects

```sql
-
- Oracle SQL advanced 
-
- Section 22 - Database Objects
-
- Class 1 - Database Objects

- Consulting objects from Schema HR - Schema Objects

- Connect as HR User

User_Objects

Select Object_Name, Object_Type, Status From user_objects
Order by Object_Type;

- Connect as SYS User (DBA)

DBA_OBJECTS

Select Owner, Object_Name, Object_Type, Status
From dba_objects
Where owner = 'hr'
Order by Object_Type;

- Examples of consultations with Nonschema Objects for the Oracle Dice Dictionary

SELECT *
From dba_tablespaces;

SELECT *
From dba_users;
```
---

<!-- TOC --><a name="section-23-dice-dictionary-visions"></a>
## Section 23 - Dice Dictionary Visions

<!-- TOC --><a name="differences-between-visions-with-prefix-user-all-and-dba"></a>
### DIFFERENCES BETWEEN VISIONS WITH PREFIX USER, ALL AND DBA

```sql
-
- Oracle SQL advanced 
-
- Section 23 - Database Objects
-
- Class 2 - Differences between visions with prefix user, All and DBA

- Consulting data dictionary views

- Consulting Object Information

- Connect as HR User

SELECT *
From user_objects;

SELECT *
From all_objects;

- Connect as SYS User

SELECT *
From dba_objects
Where owner = 'hr';

- Consulting Tables Information

- Connect as HR User

SELECT *
From user_tables;

SELECT *
From all_tables;

- Connect as SYS User

SELECT *
From dba_tables
Where owner = 'hr';

- Consulting information about table columns

- Connect as HR User

SELECT *
From user_tab_columns
WHERE TABLE_NAME = 'EMPLOYEES' 
Order by Column_id;


SELECT *
From all_tab_columns
Where owner = 'hr' and 
       table_Name = 'Employees' 
Order by Column_id;

- Connect as SYS User

SELECT *
From dba_tab_columns
Where owner = 'hr' and 
       table_Name = 'Employees' 
Order by Column_id;

- Consulting Table Constraints Information

- Connect as HR User

SELECT *
From user_constraints
WHERE TABLE_NAME = 'EMPLOYEES';

SELECT *
From all_constraints
Where owner = 'hr' and
       table_Name = 'Employees';


- Connect as SYS User

SELECT *
From dba_constraints
Where owner = 'hr' and
       table_Name = 'Employees';

- Consulting information about columns of a constraint

- Connect as HR User

SELECT *
From user_cons_columns
Where Table_Name = 'Employees' and
       constraint_name = 'emp_emp_id_pk'
Order by position;

SELECT *
From all_cons_columns
Where owner = 'hr' and 
       table_Name = 'Employees' and
       constraint_name = 'emp_emp_id_pk'
Order by position;

- Connect as SYS User

SELECT *
From dba_cons_columns
Where owner = 'hr' and 
       table_Name = 'Employees' and
       constraint_name = 'emp_emp_id_pk'
Order by position;

- Consulting information about tables of tables

- Connect as HR User

SELECT *
From user_indexes
WHERE TABLE_NAME = 'EMPLOYEES';

SELECT *
From all_indexes
Where owner = 'hr' and 
       table_Name = 'Employees';

- Connect as SYS User

SELECT *
From dba_indexes
Where owner = 'hr' and 
       table_Name = 'Employees';

- Consulting information about columns that make up tables of tables

- Connect as HR User

SELECT *
From user_ind_columns
Where Table_Name = 'Employees' and
       index_name = 'EMP_Emp_id_PK';

SELECT *
From all_ind_columns
Where index_owner = 'hr' and 
       table_Name = 'Employees' and
       index_name = 'EMP_Emp_id_PK';

- Connect as SYS User

SELECT *
From dba_ind_columns
Where index_owner = 'hr' and 
       table_Name = 'Employees' and
       index_name = 'EMP_Emp_id_PK';
       
- Consulting information about sequences

- Connect as HR User

SELECT *
From user_sequences;

SELECT *
From all_sequences
Where Sequence_owner = 'HR';

- Connect as SYS User

SELECT *
From dba_sequences
Where Sequence_owner = 'HR';

- Consulting information about views

- Connect as HR User

SELECT *
From user_views;

SELECT *
From all_views
Where owner = 'hr';

- Connect as SYS User

SELECT *
From dba_Views
Where owner = 'hr';

- Consulting information about the database

- Connect as SYS User

SELECT *
From dba_users;

SELECT *
From dba_tablespaces;

SELECT * 
From dba_data_files;

SELECT * 
From dba_temp_files;
```
---

<!-- TOC --><a name="visions-with-prefix-v-dynamic-performance-visions"></a>
### Visions with prefix v $ - Dynamic performance visions

```sql
-
- Oracle SQL advanced 
-
- Section 23 - Database Objects
-
- Class 3 - Performance Dynamic Views

- Consulting Dynamic Performance Visions

- Connect as SYS User

SELECT *
From V $ Tablespace;

SELECT * 
From v $ datafile;

Select File#, Name, Bytes/1024/1024 MB, Blocks, Status
From v $ datafile;

SELECT * 
From V $ Tempfile;

Select File#, Name, Bytes/1024/1024 MB, Blocks, Status 
From V $ Tempfile;

SELECT * 
From v $ controlfile;

SELECT * 
From V $ parameter;

SELECT * 
From V $ parameter
Where name = 'db_block_size';
```
---

<!-- TOC --><a name="dice-dictionary-visions"></a>
### Dice Dictionary Visions

```sql
-
- Oracle SQL advanced 
-
- Section 23 - Database Objects
-
- Class 1 - Dice Dictionary Visions

- Consulting Vision Dictionary

Dictionary

SELECT *
From dictionary
Order by table_name;

SELECT *
From dictionary
Where Table_Name = 'User_Tables'
Order by table_name;

SELECT *
From dictionary Where Table_Name Like '%Tables%'
Order by table_name;

SELECT *
From dict
Where Table_Name Like '%Tables%'
Order by table_name;

- Examples of queries to the views of the data dictionary

- Connect as HR User

SELECT *
From user_objects;

SELECT *
From user_tables;

SELECT *
From user_sequences;

SELECT *
From user_views;

- Connect as SYS User

SELECT *
From dba_objects 
Where owner = 'hr';

SELECT *
From dba_tables
Where owner = 'hr';

SELECT *
From dba_sequences
Where Sequence_owner = 'HR';

SELECT *
From dba_Views
Where owner = 'hr';

SELECT *
From dba_users;

SELECT *
From dba_tablespaces;

SELECT * 
From dba_data_files;

SELECT * 
From dba_temp_files;
```
---

<!-- TOC --><a name="section-24-indexes-advanced"></a>
## Section 24 - Indexes - Advanced

<!-- TOC --><a name="1-indexes"></a>
### 1 - Indexes

```sql
-
- Oracle SQL advanced 
-
- Section 24 - Indexes
-
- Class 1 - Indexes

- Indexes

- Connect as HR User

DROP Index EMP_NAME_IX;
Drop Index Employees_last_Name_idx;
Drop index employees_name_idx;
Drop Index Employees_last_Name_First_Name_idx;
Drop index employees_job_id_idx;
Drop index employees_phone_number_idx;

- Full Table Scan

SELECT *
From Employees;

- Analyze the cost of the command in the execution plan

SELECT *
From Employees
WHERE PHONE_NUMBER = '515.127.4565';

- Analyze the cost of the command without using index by the execution plan

-Creating a single Index B-Tree simple

Create Unique Index Employees_phone_number_idx
On Employees (Phone_Number);

SELECT *
From Employees
WHERE PHONE_NUMBER = '515.127.4565';

- Analyze the cost of the command by the execution plan - note that now it must be using the index created

- Creating a unique index automatically in the creation of the Unique Constraint

Drop index employees_phone_number_idx;

Alter Table Employees
Add constraint employees_phone_number_uk unique (Phone_number);
```
---

<!-- TOC --><a name="2-types-of-indexes"></a>
### 2 - Types of Indexes

```sql
-
- Oracle SQL advanced 
-
- Section 24 - Indexes
-
- Class 2 - Types of Indexes 

- Types of Indexes 

- Connect as HR User

DROP Index EMP_NAME_IX;
Drop Index Employees_last_Name_idx;
Drop index employees_name_idx;
Drop Index Employees_last_Name_First_Name_idx;
Drop index employees_job_id_idx;
Drop index employees_phone_number_idx;
Alter Table Employees 
Drop constraint employees_phone_number_uk;

-Creating a simple B-Tree Index

Drop index employees_job_id_idx;

Create Index Employees_job_id_idx
On Employees (Job_id);	

SELECT *
From Employees
WHERE JOB_ID = 'IT_PROG';

- Analyze the cost of the command in the execution plan	  

Drop Index Employees_last_Name_idx;

SELECT *
From Employees
Where Last_Name = 'Himuro';

- Analyze the cost of the command in the execution plan

-Creating a unique index B-Tree simple

Create Index Employees_last_Name_idx
On Employees (Last_Name);

SELECT *
From Employees
Where Last_Name = 'Himuro';

- Analyze the cost of the command in the execution plan

-Creating a unique Index B-Prit compound

Create Index Employees_last_Name_First_Name_idx
On Employees (Last_Name, First_Name);

SELECT *
From Employees
Where Last_Name = 'Himuro' and 
       First_Name = 'Guy';

- Analyze the cost of the command in the execution plan	  

- Creating a simple bitmap index

Drop index employees_job_id_idx;

Create Bitmap Index Employees_job_id_idx
On Employees (Job_id);

SELECT *
From Employees
WHERE JOB_ID = 'IT_PROG';

- Analyze the cost of the command in the execution plan	 

SELECT COUND (DISTINCT JOB_ID)
From Employees;

```
---

<!-- TOC --><a name="3-reconstructing-and-reorganizing-indices"></a>
### 3 - Reconstructing and reorganizing indices

```sql
-
- Oracle SQL advanced 
-
- Section 24 - Indexes
-
- Class 3 - Reconstructing and reorganizing indices

- Reconstructing and reorganizing an index

ALTER INDEX EMPLOYEES_LAST_NAME_FIRST_NAME_IDX REBUILD;

- Reconstructing and reorganizing an index with online option

ALTER INDEX EMPLOYEES_LAST_NAME_FIRST_NAME_IDX REBUILD ONLINE;

```
---

<!-- TOC --><a name="4-consulting-indexes"></a>
### 4 - Consulting Indexes

```sql
-
- Oracle SQL advanced 
-
- Section 24 - Indexes
-
- Class 4 - Consulting Indexes 

- Consulting Indexes

Select ix.index_name,
       IC.Column_Name,
       ic.column_position,
       IX.index_Type,
       IX.Uniqueness,
       IX.status,
       IX.TABLESPACE_NAME
From user_indexes IX
  Join User_ind_Columns IC On (IX.index_Name = IC.index_name) and 
                              (ix.table_name = ic.table_name)
Where Ix.Table_Name = 'Employees'
Order by IX.index_name, IC.Column_POSITION; 



```
---

<!-- TOC --><a name="5-removing-indexes"></a>
### 5 - Removing Indexes

```sql
-
- Oracle SQL advanced 
-
- Section 24 - Indexes
-
- Class 5 - Removing Indexes

- Removing Indexes

Drop index employees_job_id_idx;

- Consulting Indexes 

Select ix.index_name,
       IC.Column_Name,
       ic.column_position,
       IX.index_Type,
       IX.Uniqueness,
       IX.status,
       IX.TABLESPACE_NAME,
       visibility
From user_indexes IX
  Join User_ind_Columns IC On (IX.index_Name = IC.index_name) and 
                              (ix.table_name = ic.table_name)
Where Ix.Table_Name = 'Employees' Order by IX.index_name, IC.Column_POSITION; 

- Creating Employees_job_id_idx Index

Create Index Employees_job_id_idx
On Employees (Job_id);

- Consulting Indexes 

ALL_INDEXES

Select ix.owner,
       IX.index_name,
       IC.Column_Name,
       ic.column_position,
       IX.index_Type,
       IX.Uniqueness,
       IX.status,
       IX.TABLESPACE_NAME,
       visibility
From all_indexes IX
  Join All_ind_Columns IC On (IX.index_Name = IC.index_name) and 
                              (ix.table_name = ic.table_name)
Where Ix.Table_Name = 'Employees'
Order by IX.index_name, IC.Column_POSITION; 

- Removing online indexes

Drop Index Employees_job_id_idx Online;

- Consulting Indexes 

Select ix.index_name,
       IC.Column_Name,
       ic.column_position,
       IX.index_Type,
       IX.Uniqueness,
       IX.status,
       IX.TABLESPACE_NAME,
       visibility
From user_indexes IX
  Join User_ind_Columns IC On (IX.index_Name = IC.index_name) and 
                              (ix.table_name = ic.table_name)
Where Ix.Table_Name = 'Employees'
Order by IX.index_name, IC.Column_POSITION; 
```
---

<!-- TOC --><a name="6-creating-indexes-in-the-creation-of-the-table"></a>
### 6 - Creating Indexes in the Creation of the Table

```sql
-
- Oracle SQL advanced 
-
- Section 24 - Indexes
-
- Class 6 - Creating Primary Key index in the creation of the table

- Creating Index for Primary Key in creating the table named Default

Drop table projects;

Create Table Projects
(Project_id Number (6) Not null 
   Constraint project_id_pk primary key,
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varcha2 (400) not null);
 
 - Consulting the index

Select ix.index_name,
       IC.Column_Name,
       ic.column_position,
       IX.index_Type,
       IX.Uniqueness,
       IX.status,
       IX.TABLESPACE_NAME
From user_indexes IX
  Join User_ind_Columns IC On (IX.index_Name = IC.index_name) and 
                              (ix.table_name = ic.table_name)
Where Ix.Table_Name = 'Projects'
Order by IX.index_name, IC.Column_POSITION; 

- Creating Primary Key index in creating the table with a specific name

Drop table projects;

Create Table Projects
(Project_id Number (6) Not null 
   Constraint project_id_pk primary key 
   Using Index (Create index project_id_idx on projects (project_id)),
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varcha2 (400) not null);
 
 - Consulting the index

Select ix.index_name,
       IC.Column_Name,
       ic.column_position,
       IX.index_Type,
       IX.Uniqueness,
       IX.status,
       IX.TABLESPACE_NAME
From user_indexes IX
  Join User_ind_Columns IC On (IX.index_Name = IC.index_name) and 
                              (ix.table_name = ic.table_name)
Where Ix.Table_Name = 'Projects'
Order by IX.index_name, IC.Column_POSITION; 

- Creating Primary Key index in creating the table with specific properties

Drop table projects;

Create Table Projects
(Project_id Number (6) Not null 
   Constraint project_id_pk primary key 
   Using Index (Create index project_id_idx on projects (project_id)
                Tablespace users),
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varcha2 (400) not null);
 
- Consulting the index

Select ix.index_name,
       IC.Column_Name,
       ic.column_position,
       IX.index_Type,
       IX.Uniqueness,
       IX.status,
       IX.TABLESPACE_NAME
From user_indexes IX
  Join User_ind_Columns IC On (IX.index_Name = IC.index_name) and 
                              (ix.table_name = ic.table_name)
Where Ix.Table_Name = 'Projects'
Order by IX.index_name, IC.Column_POSITION; 
```
---

<!-- TOC --><a name="7-creating-index-for-primary-key-after-the-creation-of-the-table"></a>
### 7 - Creating Index for Primary Key after the creation of the table

```sql
-
- Oracle SQL advanced 
-
- Section 24 - Indexes
-
- Class 7 - Creating Index for Primary Key after the creation of the table

- Creating Primary Key index after creating the table with the same name as the constraint

Drop table projects;

Create Table Projects
(Project_id Number (6) Not null,
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null, Description Varcha2 (400) not null);

Alter table projects  
Add constraint project_id_pk primary key (project_id);

- Consulting Indexes

Select ix.index_name,
       IC.Column_Name,
       ic.column_position,
       IX.index_Type,
       IX.Uniqueness,
       IX.status,
       IX.TABLESPACE_NAME
From user_indexes IX
  Join User_ind_Columns IC On (IX.index_Name = IC.index_name) and 
                              (ix.table_name = ic.table_name)
Where Ix.Table_Name = 'Projects'
Order by IX.index_name, IC.Column_POSITION; 

- Creating Primary Key index after creating the table with a specific name and specific properties

Drop table projects;

Create Table Projects
(Project_id Number (6) Not null,
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varcha2 (400) not null);

Create Unique Index Project_id_idx on Projects (Project_id)
Tablespace Users;

Alter table projects  
Add constraint project_id_pk primary key (project_id) 
  Using index project_id_idx;
  
- Consulting Indexes

Select ix.index_name,
       IC.Column_Name,
       ic.column_position,
       IX.index_Type,
       IX.Uniqueness,
       IX.status,
       IX.TABLESPACE_NAME
From user_indexes IX
  Join User_ind_Columns IC On (IX.index_Name = IC.index_name) and 
                              (ix.table_name = ic.table_name)
Where Ix.Table_Name = 'Projects'
Order by IX.index_name, IC.Column_POSITION; 

```
---

<!-- TOC --><a name="8-creating-function-based-indexes"></a>
### 8 - Creating Function Based Indexes

```sql
-
- Oracle SQL advanced 
-
- Section 24 - Indexes
-
- Class 8 - Creating functions based on 

- Creating an index for the First_Name column

Drop Index Employees_First_Name_idx;

Create Index Employees_First_Name_idx On Employees (First_Name);

SELECT *
From Employees
Where Upper (First_Name) = 'Daniel';

- Analyze the cost of the command in the execution plan

- Creating an index based on the First_Name column

Create Index Employees_Upper_First_Name_idx On Employees (Upper (First_Name));

- Creating functions based on functions 

SELECT *
From Employees
Where Upper (First_Name) = 'Daniel';

- Analyze the cost of the command in the execution plan
```
---

<!-- TOC --><a name="9-multiple-indexes-for-the-same-columns"></a>
### 9 - Multiple indexes for the same columns

```sql
-
- Oracle SQL advanced 
-
- Section 24 - Indexes
-
- Class 9 - Multiple Indexes for the same columns

- Multiple indexes for the same columns

-Creating a B-Tree Index for Job_id column

Drop index employees_job_id_idx;

Create Index Employees_job_id_idx
On Employees (Job_id);

SELECT *
From Employees
WHERE JOB_ID = 'IT_PROG';

- Analyze the cost of the command in the execution plan

-Creating a B-Tree Index for Job_id column

Drop Index Employees_job_id_idx2;

Create Bitmap Index Employees_job_id_idx2
On Employees (Job_id);  - Observe the error message

- Solving the problem

ALTER INDEX EMPLOYEES_JOB_ID_IDX INVISIBLE;

Create Bitmap Index Employees_job_id_idx2
On Employees (Job_id);  

SELECT *
From Employees
WHERE JOB_ID = 'IT_PROG';

- Analyze the cost of the command in the execution plan

- Consulting the indices for the Employees table

Select ix.index_name,
       IC.Column_Name,
       ic.column_position,
       IX.index_Type,
       IX.Uniqueness,
       IX.status,
       IX.TABLESPACE_NAME,
       visibility
From user_indexes IX
  Join User_ind_Columns IC On (IX.index_Name = IC.index_name) and 
                              (ix.table_name = ic.table_name)
Where Ix.Table_Name = 'Employees'
Order by IX.index_name, IC.Column_POSITION; 

ALTER INDEX EMPLOYEES_JOB_ID_IDX2 INVISIBLE;

ALTER INDEX EMPLOYEES_JOB_ID_IDX VISIBLE;

- Consulting the indices for the Employees table

Select ix.index_name,
       IC.Column_Name,
       ic.column_position,
       IX.index_Type,
       IX.Uniqueness,
       IX.status,
       IX.TABLESPACE_NAME,
       visibility
From user_indexes IX
  Join User_ind_Columns IC On (IX.index_Name = IC.index_name) and 
                              (ix.table_name = ic.table_name)
Where Ix.Table_Name = 'Employees'
Order by IX.index_name, IC.Column_POSITION; 

SELECT *
From Employees
WHERE JOB_ID = 'IT_PROG';

- Analyze the cost of the command in the execution plan

- Consulting the indices for the Employees table

Select ix.index_name,
       IC.Column_Name,
       ic.column_position,
       IX.index_Type,
       IX.Uniqueness,
       IX.status,
       IX.TABLESPACE_NAME,
       visibility
From user_indexes IX
  Join User_ind_Columns IC On (IX.index_Name = IC.index_name) and 
                              (ix.table_name = ic.table_name)
Where Ix.Table_Name = 'Employees'
Order by IX.index_name, IC.Column_POSITION; 
```
---

<!-- TOC --><a name="index-2"></a>
### Index 2

```sql
Select * From Employees Where Upper (First_Name) = 'Lucas';

- Creation of Index with function Create Index EMP_UPPER_FN_IX ON EMPLOYEES (UPPER (FIRST_NAME));
Select * From Employees Where Upper (First_Name) = 'Lucas';

- Visibility of Index
Create Bitmap Index EMP_UPPER_FN_IX2 On Employees (Upper (First_Name));

ALTER INDEX EMP_UPPER_FN_IX INVISIBLE;
ALTER INDEX EMP_UPPER_FN_IX2 INVISIBLE;
ALTER INDEX EMP_UPPER_FN_IX VISIBLE;

```
---

<!-- TOC --><a name="index-1"></a>
### Index

```sql
Select * from user_indexes;

- Select Full in the table
Select * From Employees;

- Creating an index for the Firts_Name column
Create Index EMP_FIRST_Name_ix on Employees (First_Name);

- Select Full using Index
Select * From Employees and Where E.FIRST_Name = 'Lucas';

- Creation of Index
Create Index Nameíndex on Table (column);

- Creation of Index Compound
Create Index NameAndex on Table (column1, column2);

- Creation of Unique Index
CREATE UNIQUE INDEX NAMEONDEX ON TABLE (column);

- Dropping an index
DROP INDEX EMP_JOB_IX;

- Select Table Access Full
Select * From Employees and Where E.JOB_ID = 'IT_PROG';

- Creating a simple Bitmap Index
Create Index EMP_JOB_IX On Employees (Job_id);

- Select with Index created
Select * From Employees and Where E.JOB_ID = 'IT_PROG';

- 
DROP Index EMP_NAME_IX;
Drop Index Employees_last_Name_idx;

SELECT *
  From Employees and
 Where E.FIRST_Name = 'Lucas'
   And e.last_name = 'pink';

Create Index EMP_NAME_IX On Employees (FIRST_NAME, LAST_NAME);

- Changing an index
ALTER INDEX EMP_NAME_IX REBUILD ONLINE;

- Index consultation at DICT
SELECT IX.*
  From user_indexes IX, user_ind_columns IC
 Where ix.index_name = ic.index_name
   And ix.table_name = ic.table_name
   And ix.table_name = 'Employees'
 Order by IX.index_name, IC.Column_POSITION;

```
---

<!-- TOC --><a name="section-25-advanced-data-handling"></a>
## Section 25 - Advanced data handling

<!-- TOC --><a name="1-using-the-word-default-key-in-the-insert-or-update-commands"></a>
### 1 - Using the word default key in the insert or update commands

```sql
-
- Oracle SQL advanced 
-
- Section 25 - Advanced data handling
-
- Class 1 - Using the Default option in the insert or update commands

- Using the default option in the insert or update commands

- Connect as HR User

- Creating a table with the default option for a column

Drop table projects;

Create Table Projects
(Project_id Number (6) Not null,
 Project_Code Varchar2 (10) Not null,
 Project_Name Varchar2 (100) Not null,
 CREATION_DATE DATE DEFAULT SYSDATE NOT NULL,
 START_DATE DATE,
 End_Date Date,
 Status varchar2 (20) not null,
 Priority Varchar2 (10) Not null,
 Budget Number (11,2) Not null,
 Description Varcha2 (400) not null);
 
 - Using the keyword (Keyword) default for the value of a column
 
 INSERT INTO PROJECTS (Project_id, Project_code, Project_Name, Creat_Date, Status, Priority, Budget, Description)
 VALUES (1, 'PROJERP001', 'Oracle Erp', Default, 'Planning', 'High', 1000000, 'Oracle ERP implantation');
 
 Commit;
 
 - Consulting the table 
 
 SELECT *
 From projects;
```
---

<!-- TOC --><a name="2-insert-all-inconditional-command"></a>
### 2 - INSERT ALL INCONDITIONAL COMMAND

```sql
-
- Oracle SQL advanced 
-
- Section 25 - Advanced data handling
-
- Class 3 - INSERT ALL INConditional Command

- INSERT ALL CONDITIONAL COMMAND

- Connect as HR User

- Cleaning the Employees table

Delete from Employees
Where Employee_id> = 207;

Commit;

- Creating the Salary_History table

DROP TABLE SALARY_History;

Create Table Salary_History
TO THE
Select Employee_id, Extract (Year from Hire_date) Year, Extract (Month From Hire_date) Month, Salary, Commission_PCT
From Employees
Where Hire_Date <= Sysdate - 365;

SELECT *
From salary_history;

- Creating the Employees_History table

Drop Table Employees_History;

Create Table Employees_History
TO THE
Select Employee_id, First_Name, Last_Name, Hire_Date
From Employees
Where Hire_Date <= Sysdate - 365;

SELECT *
From employees_history;

- INSERT ALL CONDITIONAL COMMAND

INSERT ALL
  Into Employees_History Values ​​(Employee_id, First_Name, Last_Name, Hire_Date)
  Into salary_history values ​​(employee_id, extract (year from hire_date), extract (month from hire_date), salary, commission_pct)
  SELECT *
  From Employees
  WHERE HIRE_DATE> SYSDATE-365;

- Consulting the Destination Tables

SELECT *
From employees_history
WHERE HIRE_DATE> SYSDATE-365;

SELECT *
From salary_history
Where Year = 2020;

- inserting a new employee

INSERT INTO EMPLOYEES
VALUES (207, 'CARL', 'PALMER', 'CPALMER', '515.123.8182', SYSDATE, 'IT_PROG', 15000, NULL, 103.60);

Commit;

- INSERT ALL CONDITIONAL COMMAND

INSERT ALL
Into Employees_History Values ​​(Employee_id, First_Name, Last_Name, Hire_Date)
Into salary_history values ​​(employee_id, extract (year from hire_date), extract (month from hire_date), salary, commission_pct)
SELECT *
From Employees
WHERE HIRE_DATE> SYSDATE-365;

Commit;

- Consulting the Destination Tables

SELECT *
From employees_history
WHERE HIRE_DATE> SYSDATE-365;

SELECT *
From salary_history
Where Year = 2020;
```
---

<!-- TOC --><a name="3-insert-all-conditional-command"></a>
### 3 - INSERT ALL CONDITIONAL COMMAND

```sql
-
- Oracle SQL advanced 
-
- Section 25 - Advanced data handling
- - Class 4 - INSERT ALL CONDITIONAL COMMAND

- INSERT ALL CONDITIONAL COMMAND

- Connect as HR User

- Cleaning the Employees table

Delete from Employees
Where Employee_id> = 207;

Commit;

- Creating the Salary_History table

DROP TABLE SALARY_History;

Create Table Salary_History
TO THE
Select Employee_id, Extract (Year from Hire_date) Year, Extract (Month From Hire_date) Month, Salary, Commission_PCT
From Employees
Where Hire_Date <= Sysdate - 365;

SELECT *
From salary_history;

- Creating the Employees_History table

Drop Table Employees_History;

Create Table Employees_History
TO THE
Select Employee_id, First_Name, Last_Name, Hire_Date
From Employees
Where Hire_Date <= Sysdate - 365;

SELECT *
From employees_history;

- Creating Table It_Programmers

DROP TABLE IT_PROGRAMMERS;

Create Table It_Programmers
TO THE
Select Employee_id, First_Name, Last_Name, Hire_Date
From Employees
Where job_id = 'it_prog' and 
       HIRE_DATE <= SYSDATE - 365;

SELECT *
From it_programmers;

- Creating the Living_in_US table

DROP Table Living_in_US;

Create Table Living_in_us
TO THE
Select Employee_id, First_Name, Last_Name, Hire_Date
From Employees
Where (hire_date <= sysdate - 365) and
        Department_id In (Select Department_id  
                           From Deportments 
                           Where location_id in (select location_id 
                                                  From locations
                                                  Where country_id = 'US'));

SELECT *
From Living_in_us;

- inserting an employees

- inserting new employees

INSERT INTO EMPLOYEES
VALUES (207, 'CARL', 'PALMER', 'CPALMER', '515.123.8182', SYSDATE, 'IT_PROG', 15000, NULL, 103.60);
INSERT INTO EMPLOYEES
VALUES (208, 'Keith', 'Richards', 'Krichards', '515.123.8183', Sysdate, 'It_Prog', 20000, Null, 103.60);

Commit;

- INSERT ALL CONDITIONAL COMMAND

INSERT ALL
  When hire_date> sysdate - 365 
  Then
       Into Employees_History Values ​​(Employee_id, First_Name, Last_Name, Hire_Date)
       Into salary_history values ​​(employee_id, extract (year from hire_date), extract (month from hire_date), salary, commission_pct)
  When (hire_date> sysdate - 365) and 
        (job_id = 'it_prog')
  Then 
       INTO IT_PROGRAMMERS VALUES (EMPLOETEE_ID, FIRST_NAME, LAST_NAME, HIRE_DATE)
  When (hire_date> sysdate - 365) and
        department_id in 
                           (Select Department_id  
                            From Deportments 
                            Where location_id in (select location_id 
                                                  From locations
                                                  Where Country_id = 'US')))
  Then
       INTO LIVING_IN_US VALUES (EMPLOETEE_ID, FIRST_NAME, LAST_NAME, HIRE_DATE)        
  SELECT *
  From Employees
  WHERE HIRE_DATE> SYSDATE-365;

- Consulting the Destination Tables

SELECT *
From employees_history
WHERE HIRE_DATE> SYSDATE-365;

SELECT *
From salary_history
Where Year = 2020;

SELECT *
From it_programmers
WHERE HIRE_DATE> SYSDATE-365;

SELECT *
From Living_in_us
WHERE HIRE_DATE> SYSDATE-365;

```
---

<!-- TOC --><a name="4-conditional-insert-first-command"></a>
### 4 - Conditional INSERT FIRST COMMAND

```sql
-
- Oracle SQL advanced 
-
- Section 25 - Advanced data handling
-
- Class 5 - Insert First Conditional Command

- Command Incert First Conditional

- Connect as HR User

- Creating the Low_Salaries Empty table

DROP Table Low_Salaries;

Create Table Low_Salaries
TO THE
Select Employee_id, Department_id, Salary
From Employees
Where 1 = 2;

SELECT *
From Low_Salaries;

- Creating the High_Salaries Empty table

Drop Table High_Salaries;

Create Table High_Salaries
TO THE
Select Employee_id, Department_id, Salary
From Employees
Where 1 = 2;

SELECT *
From High_Salaries;

- Creating the Averag_Salaries Empty table

DROP TABLE AVERAGE_SALARIES;

Create Table Averag_Salaries
TO THE
Select Employee_id, Department_id, Salary
From Employees
Where 1 = 2;

SELECT *
From averag_salaries;

- INSERT CONDITIONAL FIRST COMMAND

INSERT FIRST
  WHEN SALARY <5000 
  Then
       Into Low_Salaries Values ​​(Employee_id, Department_id, Salary)
  When Salary Between 5000 and 10000
  Then 
       Into averag_salaries values ​​(employee_id, department_id, salary)
  Else
       Into High_Salaries Values ​​(Employee_id, Department_id, Salary) 
  SELECT *
  From Employees;


Commit;

- Consulting the Destination Tables

SELECT *
From Low_Salaries;

SELECT *
From averag_salaries;

SELECT *
From High_Salaries;

```
---

<!-- TOC --><a name="5-insert-pivoting-command"></a>
### 5 - INSERT PIVOTING COMMAND

```sql
-
- Oracle SQL advanced 
-
- Section 25 - Advanced data handling
-
- Class 6 - INSERT PIVOTING COMMAND

- INSERT PIVOTING COMMAND

- Connect as HR User

- Creating the Job_Salaries table

DROP Table Job_Salaries;
Create Table Job_Salaries
(Year Number (4) Not null,
 Month Number (2) Not null,
 IT_PROG NUMBER (8.2) NOT NULL, 
 sa_man number (8,2) not null, St_man Number (8,2) not null);
 
- Inserting lines in the Job_Salaries table

INSERT INTO JOB_SALARIES (Year, Month, It_Prog, Sa_MAN, ST_MAN)
VALUES (2015, 9, 31300, 61000, 36400);

INSERT INTO JOB_SALARIES (Year, Month, It_Prog, Sa_MAN, ST_MAN)
VALUES (2015, 8, 35000, 79500, 37000);

Commit;

- Consulting the Job_Salaries table

SELECT *
From Job_Salaries;

- Creating the Job_Sal table

DROP Table Job_Sal;

Create Table Job_Sal
(Year Number (4) Not null,
 Month Number (2) Not null,
 job_id varchar2 (10) not null, 
 Total_Salarry Number (8.2) Not null);

- Consulting the Job_Sal table
 
SELECT *
From job_sal;

- INSERT PIVOTING COMMAND

INSERT ALL
  Into Job_Sal Values ​​(Year, Month, 'It_Prog', it_prog)
  Into Job_Sal Values ​​(Year, Month, 'Sa_Man', Sa_Man)
  Into Job_Sal Values ​​(Year, Month, 'St_Man', St_Man)
  SELECT *
  From Job_Salaries;
  
Commit;
  
- Consulting Origin Tables

SELECT *
From Job_Salaries;

- Consulting Tables Destination

SELECT *
From job_sal;
```
---

<!-- TOC --><a name="6-merge-command"></a>
### 6 - MERGE COMMAND

```sql
-
- Oracle SQL advanced 
-
- Section 25 - Advanced data handling
-
- Class 7 - Merge Command

- Merge Command

- Connect as HR User

- Creating the Employees_Copy table

Drop Table Employees_Copy;

Create Table Employees_Copy
TO THE
SELECT *
From Employees
Where 1 = 2;
  
SELECT *
From employees_copy;

- Merge Command

MERGE INTO EMPLOYEES_COPY C
Using Employees and
On (c.amployee_id = e.employee_id)
WHEN MATCHED THEN
   Update set 
   C.FIRST_NAME = E.FIRST_NAME,
   c.last_name = e.last_name,
   c.email = e.email,
   c.phone_number = e.phone_number,
   c.hire_date = e.hire_date,
   c.job_id = e.job_id,
   c.salary = e.salary,
   c.comMission_PCT = e.comMission_PCT,
   c.manager_id = e.manager_id,
   c.department_id = e.department_id
   Delete Where Department_id is null
WHEN NOT MATCHED THEN
  INSERT VALUES (e.employee_id, e.first_name, e.last_name, e.email, e.phone_number, e.hire_date, e.job_id,
                 E.SARARY, E.comMISSON_PCT, E.MANAGER_ID, E.DEPARTMENT_ID);
  
Commit;
  
- Consulting the Origin Employees tables

Select Count (*)
From Employees;

- Consulting the Tables Destination Employees_Copy

Select Count (*)
From employees_copy;

- Updating the Employees Origin Table

UPDATE EMPLOYEES
SET SALARY = 90000
Where Employee_id = 109;

Commit;

- Merge Command

MERGE INTO EMPLOYEES_COPY C
Using Employees and
On (c.amployee_id = e.employee_id)
WHEN MATCHED THEN
   Update set 
   C.FIRST_NAME = E.FIRST_NAME,
   c.last_name = e.last_name,
   c.email = e.email,
   c.phone_number = e.phone_number,
   c.hire_date = e.hire_date,
   c.job_id = e.job_id,
   c.salary = e.salary,
   c.comMission_PCT = e.comMission_PCT,
   c.manager_id = e.manager_id,
   c.department_id = e.department_id
   Delete Where Department_id is null
WHEN NOT MATCHED THEN
  INSERT VALUES (e.employee_id, e.first_name, e.last_name, e.email, e.phone_number, e.hire_date, e.job_id,
                 E.SARARY, E.comMISSON_PCT, E.MANAGER_ID, E.DEPARTMENT_ID);
  
Commit;
  
- Consulting the Origin Employees tables

Select Count (*)
From Employees;

- Consulting the Tables Destination Employees_Copy

Select Count (*)
From employees_copy;

SELECT *
From employees_copy
Where Employee_id = 109;
```
---

<!-- TOC --><a name="insert-all"></a>
### INSERT ALL

```sql
- INSERT INTO WITH DEFAULT
INSERT INTO PROJECTS
  (Project_id,
   Project_code,
   Project_Name,
   department_id,
   CREATION_DATE,
   start_date,
   end_date,
   status,
   Priority,
   budget,
   description)
VALUES
  (1,
   'Projerp001',
   'Oracle ERP',
   80,
   Default,
   Null,
   Null,
   'Planning',
   'High',
   10000,
   'Implementation Oracle ERP');

Select * From Departments;
SELECT * FROM PROJECTS;

Delete from Employees and Where E.Employee_id> = 207;
Commit;

- Creating Salary_History table
Create Table Salary_History As
  Select e.employee_id,
         Extract (Year from e.hire_date) Year,
         Extract (month from e.hire_date) Month,
         E.SARARY,
         e.comMission_PCT
    From Employees and
   WHERE E.HIRE_DATE <= SYSDATE - 365;

Select * from salary_history;

- Creating Table Employees_History
Create Table Employees_History As
  Select e.employee_id, e.first_name, e.last_name, e.hire_date
    From Employees and
   WHERE E.HIRE_DATE <= SYSDATE - 365;

Select * from employees_history;

INSERT INTO EMPLOYEES
  (Employee_id,
   First_Name,
   Last_Name,
   e-mail,
   Phone_number,
   hire_date,
   job_id,
   SALARY,
   commission_pct,
   manager_id,
   department_id)
VALUES
  (207,
   'Lucas',
   'Pink',
   'LROSA',
   '111-222-333',
   SYSDATE,
   'IT_PROG',
   1750,
   0.1,
   100,
   40);

- INSERT ALL INConditional
INSERT ALL INTO TABLE1
  (column1 [, column2])
VALUES
  (Value1, [, value2]) Into Table2
  (column1 [, column2])
VALUES
  (Value1, [, value2])
  SELECT columns from tablebase;

- INSERT ALL INConditional in the tables created
INSERT ALL INTO EMPLOYEES_History
VALUES
  (employee_id, first_name, last_name, hire_date) Into salary_history
VALUES (Employee_id,
   Extract (Year from hire_date),
   Extract (month from hire_date),
   SALARY,
   commission_pct)
  SELECT * from Employees and Where Hire_Date> Sysdate - 365;

- INSERT ALL CONDITIONAL
INSERT ALL WHEN CONDITION THEN INTO TABLE1
  (column1 [, column2])
VALUES
  .
  (column1 [, column2])
VALUES
  (Value1, [, value2])
  SELECT columns from tablebase;

- INSERT ALL Conditional in the tables created 
Select * from salary_history;
Table Table Salary_History;

- Creating Schedule Table
CREATE TABLE IT_PROGRAMMERS AS
  Select e.employee_id, e.first_name, e.last_name, e.hire_date
    From Employees and
   Where e.job_id = 'it_prog'
     And e.hire_date <= Sysdate - 365;

SELECT * from it_programmers;

DROP Table Living_in_US;

- Creating table of people living in the US
Create Table Living_in_us As
  Select e.employee_id, e.first_name, e.last_name, e.hire_date
    From Employees and
   Where (e.hire_date <= Sysdate - 365)
     And exists
   (Select 1
            From Deportments D
           Where e.department_id = d.department_id
             And exists (select 1
                    From locations l
                   Where d.location_id = l.location_id
                     And l.country_id = 'US'));

SELECT COUND (E.Eprployee_id)
  From Employees E, Departments D, Locations L
 Where e.department_id = d.department_id
   And d.location_id = l.location_id
   And l.country_id = 'US';

Select Count (liu.employee_id) from Living_in_us Liu;

INSERT INTO EMPLOYEES
  (Employee_id,
   First_Name,
   Last_Name,
   e-mail,
   Phone_number,
   hire_date,
   job_id,
   SALARY,
   commission_pct,
   manager_id,
   department_id)
VALUES
  (208,
   'Carl',
   'Palmer',
   'CPALMER',
   '111-222-333',
   SYSDATE,
   'IT_PROG',
   1750,
   0.1,
   100,
   40);

INSERT INTO EMPLOYEES
  (Employee_id,
   First_Name,
   Last_Name,
   e-mail,
   Phone_number,
   hire_date,
   job_id,
   SALARY,
   commission_pct,
   manager_id,
   department_id)
VALUES
  (209,
   'John',
   'TEXTOR',
   'Jtextor',
   '111-222-333',
   SYSDATE,
   'IT_PROG',
   1750,
   0.1,
   100,
   40);

- INSERT ALL CONDITIONAL
INSERT ALL WHEN
  (HIRE_DATE> SYSDATE - 365) THEN INTO EMPLOYEES_History
VALUES
  (employee_id, first_name, last_name, hire_date) Into salary_history
VALUES
  (Employee_id,
   Extract (Year from hire_date),
   Extract (month from hire_date),
   SALARY,
   commission_pct) When
  .
VALUES
  (employee_id, first_name, last_name, hire_date) When
  (hire_date> sysdate - 365) and exists
  (Select 1
     From Deportments D
    Where Exists (Select 1
             From locations l
            Where d.location_id = l.location_id
              And l.country_id = 'US')) then Into Living_in_US
VALUES
  (employee_id, first_name, last_name, hire_date)
  Select * From Employees and Where E.Hire_date> Sysdate - 365;

Table Table Employees_History;
Table Table Salary_History;
Table Table it_programmers;
TRUNCATE TABLE LIVING_IN_US;

- Consultations
SELECT * from Employees_History EH Where Eh.hire_date> Sysdate - 365;
Select * from salary_history;
SELECT * FROM IT_PROGRAMMERS IP WHERE IP.HIRE_DATE> SYSDATE - 365;
Select * From Living_in_us Liu Where Liu.hire_date> Sysdate - 365;

```
---

<!-- TOC --><a name="insert-first"></a>
### INSERT FIRST

```sql
- Creating Empty Tables
Create Table Low_Salaries
TO THE 
Select e.employee_id, e.department_id, e.salary
  From Employees and
 Where 1 = 2;

Create Table High_Salaries As
  Select e.employee_id, e.department_id, e.salary
    From Employees and
   Where 1 = 2;

Create Table Averag_Salaries As
  Select e.employee_id, e.department_id, e.salary
    From Employees and
   Where 1 = 2;

- INSERT FIRST CONDITIONAL
INSERT FIRST WHEN CONDITION THEN INTO TABLE1
  (column1 [, column2])
VALUES
  .
  (column1 [, column2])
VALUES
  (Valor1, [, value2]) Else into table3
  (column1 [, column2])
VALUES
  (Value1, [, value2])
  SELECT columns from tablebase;

- INSERT FIRST CONDITIONAL
INSERT FIRST WHEN SALARY <5000 THEN INTO LOW_SARIES
VALUES
  .
VALUES
  (employee_id, department_id, salary) Else into high_salaries
VALUES
  (employee_id, department_id, salary)
  Select * From Employees;

- Consultations
Select * from low_salaries;
SELECT * From averag_salaries;
Select * from high_salaries;

```
---

<!-- TOC --><a name="insert-pivoting"></a>
### INSERT PIVOTING

```sql
- Creating the Job_Salaries table
Create Table Job_Salaries
(Year Number (4) Not null,
Month Number (2) Not null,
IT_PROG NUMBER (8.2) NOT NULL,
sa_man number (8,2) not null,
St_man Number (8,2) not null);

- Inserting lines
INSERT INTO JOB_SARIES
  (Year, month, it_prog, sa_man, st_man)
VALUES
  (2015, 9, 31300, 71000, 44220);

INSERT INTO JOB_SARIES
  (Year, month, it_prog, sa_man, st_man)
VALUES
  (2015, 8, 36300, 81000, 49220); - Creating the Job_Sal table
Create Table Job_Sal
(Year Number (4) Not null,
Month Number (2) Not null,
job_id varchar2 (10) not null,
Total_Salarry Number (8.2) Not null); 

- INSERT PIVOTING
INSERT ALL
 Into Table Values ​​(column1, column2, 'ref_col_tb1', ref_col_tb1)
 Into Table Values ​​(column1, column2, 'ref_col_tb2', ref_col_tb2)
 Into Table Values ​​(column1, column2, 'ref_col_tb3', ref_col_tb3)
 Select * From Tablebase;

- INSERT PIVOTING
INSERT ALL
 Into Job_Sal Values ​​(Year, Month, 'It_Prog', it_prog)
 Into Job_Sal Values ​​(Year, Month, 'Sa_Man', Sa_Man)
 Into Job_Sal Values ​​(Year, Month, 'St_Man', St_Man)
 Select * from job_salaries;
 
Select * from job_sal;

```
---

<!-- TOC --><a name="merge"></a>
### MERGE

```sql
- Merge
MERGE INTO TABLE ALIASTABELA
Using Table | Visao | Subquery Alias
ON (Condition)
WHEN MATCHED THEN
  UPDATE SET column1 = value1, column2 = value2 delete where ..
WHEN NOT MATCHED THEN
  INSERT (column1 ..) VALUES (VALUE1 ..);

- Creating Employees_Copy table
Create Table Employees_copy As
  SELECT * From Employees Where 1 = 2;

- Merge
MERGE INTO EMPLOYEES_COPY C
Using Employees and
On (c.amployee_id = e.employee_id)
WHEN MATCHED THEN
  Update
     SET C.FIRST_NAME = E.FIRST_NAME, C.LAST_NAME = E.LAST_NAME DELETE
   Where c.department_id is null
WHEN NOT MATCHED THEN
  Insert
  VALUES
    (e.employee_id,
     E.FIRST_NAME,
     e.last_name,
     e.email,
     e.phone_number,
     e.hire_date,
     e.job_id,
     E.SARARY,
     e.comMission_PCT,
     e.manager_id,
     e.department_id);

```
---

<!-- TOC --><a name="section-26-flashback"></a>
## Section 26 - Flashback

<!-- TOC --><a name="1-flashback-query-me"></a>
### 1 - Flashback Query - Me

```sql
- Flashback Query 
Select Column | Expression [, column | Expression]
  From table as of timestamp to_timstamp ('dd/mm/yyyy hh24: mi: ss', 'date time in format');

Select Column | Expression [, column | Expression]
  From Table As of Timestamp (Systimestamp - Interval 'X' Minute);

- Flashback Query in practice
Select e.employee_id, e.first_name, e.last_name, e.job_id, e.salary
  From Employees and
 WHERE E.JOB_ID = 'FI_ACCOUNT';

UPDATE EMPLOYEES AND
   Set e.salary = e.salary * 2
 WHERE E.JOB_ID = 'FI_ACCOUNT';

Declare
  Cursor c_employees is
    SELECT *
      From Employees As of Timestamp (Systimestamp - Interval '15' Minute);

  R_ EMPLOYEES C_employees%Rowtype;
Begin
  Open c_employees;

  Loop
    Fetch c_employees
      Into R_Epplyees;
  
    Exit when c_empload%notfound;
  
    UPDATE EMPLOYEES AND
       Set e.salary = r_employees.salary
     Where e.employee_id = r_emploayees.employee_id;
  End Loop;

  Close c_employees;

  Commit;
End;

```
---

<!-- TOC --><a name="1-flashback-query"></a>
### 1 - Flashback Query

```sql
-
- Oracle SQL advanced 
-
- Section 26 - Flashback
-
- Class 2 - Flashback Query
-

- Using Flashback Query

- causing a problem 

Select Employee_id, First_Name, Last_Name, Job_id, Salary
From Employees
WHERE JOB_ID = 'FI_ACCOUNT';

UPDATE EMPLOYEES
SET SALARY = SALARY * 2
WHERE JOB_ID = 'FI_ACCOUNT';

Select Employee_id, First_Name, Last_Name, Job_id, Salary
From Employees
WHERE JOB_ID = 'FI_ACCOUNT';

Commit;


Declare
  Cursor c_employees is
    SELECT *
    From Employees As of Timestamp (Systimestamp - Interval '15' Minute);
    
  R_ EMPLOYEES C_employees%Rowtype;
  
Begin  
  Open c_employees;

  Loop 
    Fetch c_employees into r_employees; 
    
    Exit when c_empload%notfound; 
    
    UPDATE EMPLOYEES 
    SET SALARY = R_employees.salary
    Where Employee_id = R_employees.employee_id;
    
  End Loop; 
  
  Close c_employees;
  
  Commit;
End;

- Consulting after the problem is corrected

Select Employee_id, First_Name, Last_Name, Job_id, Salary
From Employees
WHERE JOB_ID = 'FI_ACCOUNT';
```
---

<!-- TOC --><a name="2-flashback-drop-me"></a>
### 2 - Flashback Drop - ME

```sql
- Flashback table
DROP TABLE SALARY_History;

Flashback Table Salary_History to Before Drop;

Select * from salary_history;

- Removing the table from the dumpster
- Purge table table;

- Removing all objects from the trash
- Purge user_recyclebin;

```
---

<!-- TOC --><a name="2-flashback-drop"></a>
### 2 - Flashback Drop

```sql
-
- Oracle SQL advanced 
-
- Section 26 - Flashback
-
- Class 3 - Flashback Drop
-

- Flashback Drop

-Connect like HR

Create Table Employees_Copy 
TO THE
SELECT *
From Employees;

SELECT *
From user_objects
WHERE OBJECT_NAME = 'EMPLOYEES_COPY';

SELECT *
From employees_copy;

- Removing an object

Drop Table Employees_Copy;

SELECT *
From user_objects
WHERE OBJECT_NAME = 'EMPLOYEES_COPY';

SELECT *
From employees_copy;

- Consulting the trash

SELECT *
From user_recyclebin
WHERE ORIGINAL_NAME = 'EMPLOYEES_COPY';

- confirming that the object was removed

SELECT *
From user_objects
WHERE OBJECT_NAME = 'EMPLOYEES_COPY';

- Restoring the object from the trash

Flashback Table Employees_Copy to Before Drop;

- confirming that the object was restored

SELECT *
From user_objects
WHERE OBJECT_NAME = 'EMPLOYEES_COPY';

SELECT *
From employees_copy;

SELECT *
From user_recyclebin
WHERE ORIGINAL_NAME = 'EMPLOYEES_COPY';

```
---

<!-- TOC --><a name="3-flashback-table"></a>
### 3 - Flashback table

```sql
- - Oracle SQL advanced 
-
- Section 26 - Flashback
-
- Class 4 - Flashback table
-

- Using Flashback Table

Create Table Employees_Copia2
TO THE
SELECT *
From Employees;

Connected as sys 

GRANT FLASHBACK ON HR.EmpLoyees_Copia2 TO HR;

Connected as sys or hr

Alter table h.

- connected as HR

SELECT *
From Hr.Employees_Copia2;

Delete from hr.employees_copy2;

Commit;

- Consulting the table

SELECT *
From Hr.Employees_Copia2;

- RESOURING THE TABLE FOR POSITION OF 5 MINUTES ATAS

FLASHBACK TABLE HR.EMPLOYEES_COPY2 TO TIMESTAMP SYSTIMESTAMP - INTERVAL '5' MINUTE;

- Consulting the table

SELECT *
From Hr.Employees_Copia2;
```
---

<!-- TOC --><a name="3-flashback-versions-query-me"></a>
### 3 - Flashback Versions Query - Me

```sql
- Flashback Versions Query - Privilege from Sys
Grant Run on dbms_flashback to kNEV;

- Consulting the current SCN
Select dbms_flashback.get_system_change_number from dual;

- Changing UNDO retention to 48 hours
Alter System Set Undo_Retention = 172800;

- SCN 17292603
Drop Table Employees_Copy;
Create Table Employees_copy As Select * From Employees;
Select * from employees_copy and where e.employee_id = 170;

UPDATE EMPLOYEES_COPY AND
   Set e.salary = e.salary * 2
 Where e.employee_id = 170;

SELECT *
  From employees_copy As of SCN 17292603
 Where Employee_id = 170;

```
---

<!-- TOC --><a name="4-flashback-versions-query"></a>
### 4 - Flashback Versions query

```sql
-
- Oracle SQL advanced 
-
- Section 26 - Flashback
-
- Class 5 - Flashback Versions query
-

- Using Flashback Versions Query

- Flashback Query- Necessary privileges

- Connect as SYS

Grant Run on dbms_flashback to hr;

Alter System Set Undo_Retention = 172800; - 172800 seconds = 2880 minutes = 48 hours

SELECT 172800 seconds, 172800/60 minutes, 172800/60/60 hours
From dual;

- Connect like HR

- Creating a copy of the Employees table

Drop Table Employees_Copy;

Create Table Employees_Copy
TO THE 
SELECT *
From Employees;

SELECT *
From employees_copy;

- Consult the current System Change (SCN) 

Select dbms_flashback.get_system_change_number
From dual;

- SCN = 5086585

Select Employee_id, First_Name, Last_Name, Job_id, Salary
From employees_copy
Where Employee_id = 180;

UPDATE EMPLOYEES_COPY
SET SALARY = 10000
Where Employee_id = 180;

Commit;

Select dbms_flashback.get_system_change_number
From dual;

- SCN = 5086689

- Consulting the current Employees_Copy table

Select Employee_id, First_Name, Last_Name, Job_id, Salary
From employees_copy
Where Employee_id = 180;

- Consulting the Employees_Copy table in the position prior to the update (SCN 3737968) using flashback query

Select Employee_id, First_Name, Last_Name, Job_id, Salary
From employees_copy as of scn 5086585
Where Employee_id = 180;

- Consulting the Employees_Copy table in the current position

Select Employee_id, First_Name, Last_Name, Job_id, Salary
From employees_copy 
Where Employee_id = 180;

- Consulting the history of updates of Employee_id = 180

Select Versions_startSCN, 
       Versions_startTime, 
       versions_endscn, 
       versions_endtime,
       Versions_XID, 
       Versions_Operation,
       Employee_id, 
       First_Name, 
       Last_Name, 
       salary
From employees_copy 
       Between SCN Versions 5086585 and 5086689
Where Employee_id = 180;

Select Versions_startSCN, 
       Versions_startTime, 
       versions_endscn, 
       versions_endtime,
       Versions_XID, 
       Versions_Operation,
       Employee_id, 
       First_Name, 
       Last_Name, 
       salary
From employees_copy 
       Versions Between Timestamp To_TitestamP ('10/12/2020 17:09:25 ',' DD/MM/YYYY HH24: Mi: SS ') and 
                                   To_TIMESTAMP ('10/12/2020 17:10:00 ',' dd/mm/yyyy hh24: mi: ss')
Where Employee_id = 180;
```
---

<!-- TOC --><a name="section-27-hierarchical-consultations"></a>
## Section 27 - Hierarchical Consultations

<!-- TOC --><a name="1-hierarchical-queries"></a>
### 1 - Hierarchical queries

```sql
-
- Oracle SQL advanced 
-
- Section 27 - Hierarchical Consultations
-
- Class 1 - Hierarchical consultations
-

- Hierarchical consultations

- Connect like HR

- Consulting the structure of the Employees table

EMPLOYEES

SELECT *
From Employees;

- Hierarchical Consultation on the Employees Up To Down Table from Manager_id is null

Select Level, Employee_id, First_Name, Last_Name, Job_id, Manager_id
From Employees
Start with manager_id is null
Connect by Prior Employee_id = Manager_id;
```
---

<!-- TOC --><a name="2-hierarchical-queries-up-to-down-and-bottom-to-up"></a>
### 2 - Hierarchical queries - Up to Down and Bottom to Up

```sql
-
- Oracle SQL advanced 
-
- Section 27 - Hierarchical Consultations
-
- Class 2 - Hierarchical queries up to down and butttom to up
-

- Hierarchical appointments up to down and buttotom to up

- Connect like HR

- Hierarchical Consultation on the Employees Up To Down table from Employee_id = 103 

Select Level, Employee_id, First_Name, Last_Name, Job_id, Manager_id
From Employees
Start with employee_id = 103
Connect by Prior Employee_id = Manager_id; Select Level, Employee_id, First_Name, Last_Name, Job_id, Manager_id
From Employees
Start with employee_id = 103
Connect by Manager_id = Prior Employee_id;

- Hierarchical consultation on the Employees Table Bottom to Up from Employee_id = 103 

Select Level, Employee_id, First_Name, Last_Name, Job_id, Manager_id
From Employees
Start with employee_id = 103
Connect by Prior Manager_id = Employee_id;

Select Level, Employee_id, First_Name, Last_Name, Job_id, Manager_id
From Employees
Start with employee_id = 103
Connect by Employee_id = Prior Manager_id;

- Hierarchical Consultation on the Employees Up To Down table from Manager_id is null

Select Level, Employee_id, First_Name, Last_Name, Job_id, Manager_id
From Employees
Start with manager_id is null
Connect by Prior Employee_id = Manager_id;

Select Level, Employee_id, First_Name, Last_Name, Job_id, Manager_id
From Employees
Start with manager_id is null
Connect by Manager_id = Prior Employee_id;

- Hierarchical Consultation on the Employees Table Bottom to Up from Manager_id is null

Select Level, Employee_id, First_Name, Last_Name, Job_id, Manager_id
From Employees
Start with manager_id is null
Connect by Prior Manager_id = Employee_id;

Select Level, Employee_id, First_Name, Last_Name, Job_id, Manager_id
From Employees
Start with manager_id is null
Connect by Employee_id = Prior Manager_id;

```
---

<!-- TOC --><a name="3-hierarchical-queries-using-pseudocoluna-level"></a>
### 3 - Hierarchical queries using pseudocoluna level

```sql
-
- Oracle SQL advanced 
-
- Section 27 - Hierarchical Consultations
-
- Class 3 - Hierarchical consultations using pseudocoluna level
-

- Hierarchical consultations using pseudocoluna level

- Connect like HR
Hierarchical consultation on the Employees Up to Down table from the manager_id is null
- 

Select Level, Employee_id, First_Name, Last_Name, Job_id, Manager_id
From Employees
Start with manager_id is null
Connect by Prior Employee_id = Manager_id;

- Hierarchical Consultation on the Employees Up To Down table from Manager_id is null
- Restricting only the level = 2

Select Level, Employee_id, First_Name, Last_Name, Job_id, Manager_id
From Employees
Where Level = 2
Start with manager_id is null
Connect by Prior Employee_id = Manager_id;

- Hierarchical Consultation on the Employees Up To Down table from Manager_id is null
- Restricting only the level <> 2

Select Level, Employee_id, First_Name, Last_Name, Job_id, Manager_id
From Employees
Where Level <> 2
Start with manager_id is null
Connect by Prior Employee_id = Manager_id;
```
---

<!-- TOC --><a name="4-formatting-the-exit-of-the-structure-on-a-tree"></a>
### 4 - Formatting the exit of the structure on a tree

```sql
-
- Oracle SQL advanced 
-
- Section 27 - Hierarchical Consultations
-
- Class 4 - Hierarchical Consultations - Formatting the exit of the structure on a tree
-

- Hierarchical consultations - Formatting the exit of the structure on a tree

- Connect like HR

- Hierarchical Consultation on the Employees Up To Down table from Manager_id is null
- Formatting formatting the tree structure using LPAD

SELECT LEVEL, LPAD (LAST_NAME, LETTH (LAST_NAME)+(LEVEL*4) -4, '') LAST_NAME
From Employees
Start with manager_id is null
Connect by Prior Employee_id = Manager_id;

SELECT LPAD (Level || '.' || Last_Name, Length (level || '.' || Last_Name)+(level*4) -4, '') Last_Name
From Employees
Start with manager_id is null
Connect by Prior Employee_id = Manager_id;
```
---

<!-- TOC --><a name="5-suppressing-branches-brunches-of-the-hierarchical-structure-tree"></a>
### 5 - suppressing branches (brunches) of the hierarchical structure (tree)

```sql
-
- Oracle SQL advanced 
-
- Section 27 - Hierarchical Consultations
-
- Class 5 - suppressing branches (brunches) of the hierarchical structure (tree)
-

- Hierarchical consultations

- Connect like HR

- suppressing branches (brunches) of the hierarchical structure (tree)

- Using the WERE clause- eliminates lines (records) that do not satisfy the Where Clause

Select Level, Employee_id, First_Name, Last_Name, Job_id, Manager_id
From Employees
Where Employee_id <> 205
Start with manager_id is null
Connect by Prior Employee_id = Manager_id;

- Commenting on the Where Clause

Select Level, Employee_id, First_Name, Last_Name, Job_id, Manager_id
From Employees
-Were Employee_id <> 205
Start with manager_id is null
Connect by Prior Employee_id = Manager_id;

- suppressing branches (brunches) of the hierarchical structure (tree)

- Used the Connect by - eliminates lines (records) clause that do not satisfy the Where clause and all their lines (records) children

Select Level, Employee_id, First_Name, Last_Name, Job_id, Manager_id
From Employees
Start with manager_id is null
Connect by Prior Employee_id = Manager_id and 
                 Employee_id <> 205;
```
---

<!-- TOC --><a name="6-ordering-hierarchical-sql"></a>
### 6 - Ordering hierarchical SQL

```sql
-
- Oracle SQL advanced 
-
- Section 27 - Hierarchical Consultations
-
- Class 6 - Ordering hierarchical SQL
-

- Hierarchical consultations

- Connect like HR - Ordering hierarchical SQL

Select Level, Employee_id, First_Name, Last_Name, Job_id, Manager_id
From Employees
Start with manager_id is null
Connect by Prior Employee_id = Manager_id
Order Siblings by Last_Name;


```
---

<!-- TOC --><a name="hierarchical-queries"></a>
### Hierarchical queries

```sql
- Hierarchical consultations
Select [level], column, express
  From Table 
[Where Condition] 
[Start with condition] - from what condition
[Connect by Prior Condition]; - From top to bottom or from the bottom up

- Hierarchical consultation in the Employees Up To Down table
Select level,
       e.employee_id,
       E.FIRST_NAME,
       e.last_name,
       e.job_id,
       e.manager_id
  From Employees and
 Start with e.manager_id is null - will start when the manager's id is null
Connect by Prior e.employee_id = e.manager_id;

- Hierarchical consultation in the Employees Bottom to Down table
Select level,
       e.employee_id,
       E.FIRST_NAME,
       e.last_name,
       e.job_id,
       e.manager_id
  From Employees and
 Start with e.manager_id is null - will start when the manager's id is null
Connect by e.employee_id = prior e.manager_id;

- Formatting Structure Exit on Tree
SELECT LEVEL, LPAD (E.LAST_NAME, LETTH (E.LAST_NAME) + (LEVEL * 4) - 4, '')
  From Employees and
 Start with e.manager_id is null
Connect by Prior e.employee_id = e.manager_id;

- suppressing branchs (branches) of our tree
Select level,
       e.employee_id,
       E.FIRST_NAME,
       e.last_name,
       e.job_id,
       e.manager_id
  From Employees and
 Start with e.manager_id is null
Connect by Prior e.employee_id = e.manager_id
       And e.employee_id <> 108;
			 
- LEVEL SERVICE
Select level,
       e.employee_id,
       E.FIRST_NAME,
       e.last_name,
       e.job_id,
       e.manager_id
  From Employees and
 Start with e.manager_id is null
Connect by Prior e.employee_id = e.manager_id
 Order Siblings by e.last_name;

```
---

<!-- TOC --><a name="section-28-regex"></a>
## Section 28 - REGEX

<!-- TOC --><a name="1-using-regexp_like"></a>
### 1 - Using REGEXP_LIKE

```sql
-
- Oracle SQL advanced 
-
- Section 28 - Regular Expressions
-
- Class 2 - Using Regexp_Like 
-

- Using REGEXP_Like 

- Connect like HR

- Using REGEXP_LIKE in an appointment

- Sensitive case comparison (default) 

SELECT *
From Employees
WHERE REGEXP_LIKE (FIRST_NAME, '^STE (V | PH) EN $');

- Sensitive case comparison

SELECT *
From Employees
WHERE REGEXP_LIKE (FIRST_NAME, '^STE (V | PH) EN $', 'C');

- Non-sensitive case comparison

SELECT *
From Employees
WHERE REGEXP_LIKE (FIRST_NAME, '^STE (V | PH) EN $', 'I');

- Using REGEXP_LIKE at a Check Type Constraint query

Drop Table Employees_Copy;

Create Table Employees_Copy 
TO THE
SELECT *
From Employees
Where 1 = 2;

Alter tablet employees_copy
Add constraint phone_number_ck
Check_like (Phone_Number, '^[0-9] {3} \. [0-9] {3} \. [0-9] {4} $'));
```
---

<!-- TOC --><a name="2-using-regexp_replace"></a>
### 2 - Using REGEXP_Replace

```sql
-
- Oracle SQL advanced 
-
- Section 28 - Regular Expressions
-
- Class 3 - Using REGEXP_Replace
-

- Using REGEXP_Replace

- Connect like HR

- Sensitive case comparison (default), from position 1 for all combinations found

Select Phone_Number, REGEXP_Replace (Phone_Number, '\.', '-') As Phone
From Employees;

- Sensitive case comparison, from position 1 for all combinations found

Select Phone_Number, Regexp_Replace (Phone_Number, '\.', '-', 1.0, 'C')
From Employees;

- Non-sensitive case comparison (default), from position 1 for all combinations found

Select Phone_Number, REGEXP_Replace (Phone_Number, '\.', '-', 1.0, 'i')
From Employees;
```
---

<!-- TOC --><a name="3-using-regexp_substr"></a>
### 3 - Using REGEXP_SUBSTR

```sql
-
- Oracle SQL advanced 
-
- Section 28 - Regular Expressions
-
- Class 4 - Using REGEXP_SUBSTR
-

- Regular Expressions

- Using REGEXP_SUBSTR

- Connect like HR

Drop Table Employees_Copy;

Create Table Employees_Copy
TO THE 
Select Employee_id, First_Name || '' || Last_Name name, email, phone_number, hire_date, job_id,
       Salary, commission_pct, manager_id, department_id
From Employees;

SELECT *
From employees_copy;

- Sensitive case comparison (default), from position 1 to 1 combinations found

SELECT NAME, REGEXP_SUBSTR (Name, '^[A-Z] [[: Alpha:]]+') The First_Name
From employees_copy;

- Sensitive case comparison, from position 1 to 1 combinations found

SELECT NAME, REGEXP_SUBSTR (Name, '^[A-Z] [[: Alpha:]]+', 1.1, 'C')
From employees_copy;

```
---

<!-- TOC --><a name="4-using-regexp_instr"></a>
### 4- Using REGEXP_INSTR

```sql
-
- Oracle SQL advanced 
-
- Section 28 - Regular Expressions
-
- Class 5 - Using REGEXP_INSTR
-

- Regular Expressions

- Connect like HR

- Using REGEXP_INSTR

Drop Table Employees_Copy;

Create Table Employees_Copy
TO THE 
Select Employee_id, First_Name || '' || Last_Name name, email, phone_number, hire_date, job_id,
       Salary, commission_pct, manager_id, department_id
From Employees; - Sensitive case comparison (default), from position 1 to first occurrence found

SELECT NAME, REGEXP_INSTR (NAME, '^[A-Z] [[: Alpha:]]+')
From employees_copy;

- Sensitive case comparison (default), from position 1 to first occurrence found

SELECT NAME, REGEXP_INSTR (NAME, '^[A-Z] [[: Alpha:]]+', 1,1,0, 'c')
From employees_copy;

```
---

<!-- TOC --><a name="5-using-regexp_count"></a>
### 5 - Using REGEXP_COUNT

```sql
-
- Oracle SQL advanced 
-
- Section 28 - Regular Expressions
-
- Class 6 - Using REGEXP_COUNT
-

- Regular Expressions

- Connect like HR

- Using REGEXP_COUNT

Drop Table Employees_Copy;

Create Table Employees_Copy
TO THE 
Select Employee_id, First_Name || '' || Last_Name name, email, phone_number, hire_date, job_id,
       Salary, commission_pct, manager_id, department_id
From Employees;

- Sensitive case comparison (default), from position 1 

SELECT NAME, REGEXP_COUNT (NAME, 'A | E | I | O | U') NUMBER_DE_COMBINATIONS
From employees_copy;

SELECT NAME, REGEXP_SUBSTR (Name, '[A-Z] [[: Alpha:]]+$') Last_Name, REGEXP_COUNT (Name, '[A-Z] [[: Alpha:]]+$)
From employees_copy;
```
---

<!-- TOC --><a name="regex"></a>
### REGEX

```sql
- REGEXP_LIKE
REGEXP_LIKE (string, standard [, optionodematch])

Select * From Employees Ikhere Regexp_Like (e.last_name, '.osa $', 'c');

Drop Table Employees_Copy;
Create Table Employees_copy As Select * From Employees Where 1 = 2;

- Creating a Constraint with Regex
Alter table Employees_copy add constraint phone_number_ck check (Regexp_Like (Phone_Number,
                                                                            '^[0-9] {3} \. [0-9] {3} \. [0-9] {4} $'));
- REGEXP_Replace
REGEXP_Replace (string, 
               standard 
							 [, stringsubstitutation 
							 [, position
							 [,
							 [, OpçaãDematch]]]));
							 
Select * From Employees;

Select e.phone_number, regexp_Replace (e.phone_number, '\.', '-') Phone_number2 from employees and;

- REGEXP_SUBSTR
REGEXP_SUBSTR (string, 
               standard 
               [, position
               [,
               [, OpçaãDematch]]]));
							 
Drop Table Employees_Copy;
Create Table Employees_copy As select e.employee_id, e.first_name || '' || E.LAST_NAME NAME, E.SALARY FROMPLAYEES AND;

Select * from employees_copy;

SELECT E.NAME, REGEXP_SUBSTR (E.NAME, '^[A-Z] [[: Alpha:]+') AS FIRST_NAME, REGEXP_SUBSTR (E.NAME, '[A-Z]+[: Alpha:]]+$' ) The Last_Name
  From employees_copy and;

- REGEXP_COUNT
SELECT E.NAME, REGEXP_COUNT (E.NAME, 'A | E | I | O | U', 1, 1) FROYEES_COPY VOGALS;

```
---

<!-- TOC --><a name="section-29-temporary-tables"></a>
## Section 29 - Temporary Tables

<!-- TOC --><a name="1-temporary-tables"></a>
### 1 - Temporary Tables

```sql
-
- Oracle SQL advanced 
-
- Section 29 - Temporary Tables
-
- Class 1 - Temporary Tables
-

- Temporary Tables

- Connect as HR (first session)

- Creating a temporary table

Create Global Temporary Table Hr.tmp_employees
(Employee_id Number (6),
 First_Name Varchar2 (20),
 Last_Name Varchar2 (25),
 EMAIL VARCHAR2 (25),
 Phone_number Varchar2 (20),
 HIRE_DATE DATE,
 Job_id Varchar2 (10),
 SALARY NUMBER (8.2),
 Commission_PCT NUMBER (2,2),
 Manager_id Number (6),
 Department_id Number (4))
 On Commit Preserve Rows;
 
- Consulting the temporary table 

SELECT *
From hr.tmp_employees;

- Connect as SYS (Second Session)

- Consulting the temporary table 

SELECT *
From hr.tmp_employees;

- Back to first HR session

- Insert lines in the temporary table

INSERT INTO HR.TMP_EMPLAYEES
  SELECT *
  From Hr.Employees;
  
Commit;

- Consulting the temporary table 

SELECT *
From hr.tmp_employees;

- Back to second SYS Session

- Consulting the temporary table 

SELECT *
From hr.tmp_employees;

- Back to first HR session

- end the session

- Connect as SYS (Second Session)

- Consulting the temporary table 

SELECT *
From hr.tmp_employees;

- Insert lines in the temporary table

INSERT INTO HR.TMP_EMPLAYEES
  SELECT *
  From Hr.Employees;

- Connect as HR (Third Session)

- Consulting the temporary table 

SELECT *
From hr.tmp_employees;

- Connect as SYS (fourth session)

- Consulting the temporary table 

SELECT *
From hr.tmp_employees;

```
---

<!-- TOC --><a name="temporary-tables"></a>
### Temporary Tables

```sql
- Creation of a temporary table preserving lines after Commit
Create Global Temporary Table Nametabela 
(column1 [, column2, ...])) 
On Commit Preserve Rows;

- Creation of a temporary table eliminating lines after Commit
Create Global Temporary Table Nametabela 
(column1 [, column2, ...])) 
On Commit Delete Rows;

- Creating a temporary table
Create Global Temporary Table TMP_employees
(Employee_id Number (6) Not null,
 First_Name Varchar2 (20),
 Last_Name Varchar2 (25),
 EMAIL VARCHAR2 (25),
 Phone_number Varchar2 (20),
 HIRE_DATE DATE,
 Job_id Varchar2 (10),
 SALARY NUMBER (8.2),
 Commission_PCT NUMBER (2,2),
 Manager_id Number (6),
 Department_id Number (4))
On Commit Preserve Rows;

Select * From TMP_employees;

```
--- ## Section 30 - Globalization

<!-- TOC --><a name="1-globalization-time-zones"></a>
### 1 - Globalization - Time Zones

```sql
-
- Oracle SQL advanced 
-
- Section 30 - Globalization Treatment of Dates and Different Time Zones
-
- Class 1 - Globalization - Time Zones

- Globalization - Time Zones

- Connect as SYS User

- Consulting Time Zones

SELECT *
From V $ timezone_names
Where tzname like '%sao_paulo%';

SELECT *
From V $ timezone_names
Where Tzname Like '%Brazil%';

SELECT *
From V $ timezone_names
Where Tzname Like '%New_york%';
```
---

<!-- TOC --><a name="2-globalization-data-types"></a>
### 2 - Globalization - Data Types

```sql
-
- Oracle SQL advanced 
-
- Section 30 - Globalization Treatment of Dates and Different Time Zones
-
- Class 2 - Globalization - Data Types

- Globalization - Data Types

- Connect as HR User

- SYSDATE - Current Date (Date Date Type)

SELECT SYSDATE
From dual;

SELECT TO_CAR (SYSDATE, 'DD/MM/YYYY')
From dual;

- Systimestamp - Current Date (Timestamp type type)

SELECT SYSTIMESTAMP
From dual;

- Interval Year to Month

Select Interval '55 -11 'Year to Month
From dual;

Select Interval '1-4' Year to Month
From dual;

- Precision error for the year

Select Interval '555-11' Year to Month
From dual;

- Correcting Precision Error for the Year

Select Interval '555-11' Year (4) to month
From dual;

Select Interval '350' Month
From dual;

Select Interval '10' Year
From dual;

Select Interval '33 20:20:20 'Day to Second
From dual;

- Precision error for the day

Select Interval '333 20:20:20' Day to Second
From dual;

- Correcting Precision Error for the Day

Select Interval '333 20:20:20' Day (3) to Second
From dual;

Select Interval '500' Hour
From dual;
```
---

<!-- TOC --><a name="3-globalization-functions"></a>
### 3 - Globalization - Functions

```sql
-
- Oracle SQL advanced 
-
- Section 30 - Globalization Treatment of Dates and Different Time Zones
-
- Class 3 - Globalization - Functions

- Globalization - Functions

- Connect as SYS User

- Consult the database UTC 

SELECT DBTIMEZONE
From dual;

- Change the database UTC 

- Connect as SYS User 

Alter database set time_zone = '-03:00'; 

- Shutdown Instance
- Install Startup

- DBTIMEZONE - Returns to the database UTC

SELECT DBTIMEZONE
From dual;

- Sessiontimezone - Returns the database timezone

SELECT SESSIONINTIMEZONE
From dual;

- Connect as HR User

- SYSDATE - Returns the date (Date) date of the database

SELECT SYSDATE
From dual;

- Systimestamp - Returns the date (Timestamp) date of the database server

SELECT SYSTIMESTAMP
From dual;

- Current_Date - Returns the date of the database user session (Date Type) 

SELECT CURRENT_DATE
From dual;

- Current_TIMESTAMP - Returns the date of the database user session (type Timestamp with time zone) 

SELECT CURRENT_TIMESTAMP
From dual;

- LocalTimstamp - Returns a Timestamp Location without user session time (Timestamp type) 

SELECT LocalTimstamp
From dual;

-




```
---

<!-- TOC --><a name="4-conversion-functions-used-with-interval"></a>
### 4 - Conversion functions used with interval

```sql
- Section 30 - Globalization Treatment of Dates and Different Time Zones
-
- Class 4 - Conversion functions used with interval

- Conversion functions used with interval

- Connect as HR User

- adding days to a date - (in the example adds 30 days to Sysdate)

SELECT SYSDATE, SYSDATE + 30 
From dual;

- adding hours to a date - (in the example adds 3 hours to Sysdate)

SELECT TO_char (Sysdate, 'DD/MM/YYYY HH24: Mi: SS'), To_char (Sysdate + 3/24, 'DD/MM/YYYY HH24: Mi: SS')
From dual;

- adding minutes to a date - (in the example adds 10 minutes to Sysdate)

SELECT TO_char (Sysdate, 'DD/MM/YYYY HH24: Mi: SS'), To_char (Sysdate + 10/24/60, 'DD/MM/YYYY HH24: Mi: SS')
From dual;

- adding seconds to a date - (in the example adds 10 seconds to Sysdate)

Select to_char (Sysdate, 'DD/MM/Yyyy HH24: Mi: SS'), To_char (Sysdate + 10/24/60/60, 'DD/MM/Yyy HH24: Mi: SS')
From dual;

- Using the to_yminterval function

- Add 1 year and 6 months the current date

SELECT SYSDATE, SYSDATE + TO_YMINTerval ('01 -06 ')
From dual;

- Using the to_dsinterval function

- Add 6 days and 2 hours to the current date

SELECT TO_char (Sysdate, 'DD/MM/YYYY HH24: Mi: SS'), To_char (Sysdate + To_Dsinterval ('6 02:00:00'), 'DD/MM/Yyy HH24: Mi: SS')
From dual;
```
---

<!-- TOC --><a name="5-tz_offset-function"></a>
### 5 - Tz_Offset function

```sql
-
- Oracle SQL advanced 
-
- Section 30 - Globalization Treatment of Dates and Different Time Zones
-
- Class 5 - Tz_Offset function

- Connect as SYS User

- Change the database UTC 

- Connect as SYS User 

Alter database set time_zone = '+00:00'; 

- Shutdown Instance
- Install Startup

- DBTIMEZONE - Returns to the database UTC

SELECT DBTIMEZONE
From dual;

SELECT SESSIONINTIMEZONE
From dual;

- Tz_Offset function

SELECT TZ_OFFSET (DBTIMEZONE)
From dual;

SELECT TZ_OFFSET (Sessiontimezone)
From dual;

SELECT *
From V $ timezone_names
Where Tzname Like '%New_york%';

SELECT TZ_OFFSET ('America/New_york')
From dual;

SELECT *
From V $ timezone_names Where Tzname Like '%Paris%';

SELECT TZ_OFFSET ('Europe/Paris')
From dual;





```
---

<!-- TOC --><a name="6-extract-function"></a>
### 6 - Extract Function

```sql
-
- Oracle SQL advanced 
-
- Section 30 - Globalization Treatment of Dates and Different Time Zones
-
- Class 6 - Extract Function
- 

- Extract Function

- Connect as HR User

- extracting year, month and day of a type of date

Select Extract (Year from Sysdate) year,
       Extract (Month From Sysdate) month,
       Extract (Day from Sysdate) day
From dual;

- extracting year, month, day, time, minute, second, timezone time, timezone minute, timezone second, timezone region, timezone abbreviation 
- of a Timestamp Tith Timezone type

Select Extract (Year from Current_TitEmph) year,
       Extract (Month From Current_TIMESTAMP) month,
       Extract (day from current_timstamp) day,
	   Extract (hour from current_timstamp) time,
       Extract (Minute from Current_TIMESTAMP) Minute,
       Extract (Second From Current_TIMESTAMP) Second,
       Extract (timezone_hour from current_timstamp) timezone_hour,
       Extract (timezone_minute from current_timstamp) timezone_minute,
	   Extract (timezone_region from current_timstamp) timezone_region,
       Extract (timezone_abbr from current_timstamp) timezone_abbr
From dual;

- extracting year, month from interval year to month

Select Extract (Year From Interval '5-2' Year to Month) year, 
        Extract (Month From Interval '5-2' Year To Month) month
From dual;

- Extraring day, time, minute, second by Interval Day to Second

Select Extract (Day from Interval '5 04: 30: 20.11' Day to Second) day,
       Extract (hour from interval '5 04: 30: 20.11' day to second) hour,
       Extract (Minute from Interval '5 04: 30: 20.11' Day to Second) minute,
       Extract (Second From Interval '5 04: 30: 20.11' Day to Second) Second
From dual;
```
---

<!-- TOC --><a name="7-conversion-functions"></a>
### 7 - Conversion Functions

```sql
-
- Oracle SQL advanced 
-
- Oracle SQL advanced 
-
- Section 30 - Globalization Treatment of Dates and Different Time Zones
-
- Class 7 - Conversion Functions

- Conversion functions

- Connect as HR User

- From_tz

SELECT LOCALTIMESTAMP, 
       From_tz (localtimstamp, 'America/Sao_Paulo'), 
       From_tz (localtimstamp, 'Asia/Dubai'), 
       From_tz (localtimstamp, 'America/Chicago')
From dual;

Select from_tz (Timestamp '2021-08-08 11:00:00', '-03: 00'),
       From_tz (Timestamp '2021-08-08 11:00:00', '-05: 00'),
       From_tz (Timestamp '2021-08-08 11:00:00', '-07: 00')
From dual;
  
Select from_TZ (localtimstamp, '-03: 00'),
       From_tz (localtimstamp, '-05: 00'),
       From_tz (localtimstamp, '-07: 00')
From dual;
  
- To_Timstamp

SELECT TO_TIMESTAMP ('2006-01-18 08: 15: 32.1234',
                     'Yyyy-mm-dd hh24: mi: ss.ff') Novo_timstamp
From dual;

- To_timstamp_tz

SELECT TO_TIMESTAMP_TZ ('2006-01-18 08: 15: 32.1234 -5: 00',
                        'Yyyy-mm-dd hh24: mi: ss.ff tzh: tzm') new_timstamp_with_timezone
From dual;

SELECT TO_TIMESTAMP_TZ ('2006-01-18 08: 15: 32.1234 America/Sao_Paulo',
                        'Yyyy-mm-dd hh24: mi: ss.ff tzr') new_timstamp_with_timezone
From dual;
```
---

<!-- TOC --><a name="8-conversion-functions"></a>
### 8 - Conversion Functions

```sql
-
- Oracle SQL advanced 
-
- Oracle SQL advanced 
-
- Section 30 - Globalization Treatment of Dates and Different Time Zones
-
- Class 7 - Conversion Functions

- Conversion functions

- Connect as HR User

- From_tz

SELECT LOCALTIMESTAMP, 
       From_tz (localtimstamp, 'America/Sao_Paulo'), 
       From_tz (localtimstamp, 'Asia/Dubai'), 
       From_tz (localtimstamp, 'America/Chicago')
From dual;

Select from_tz (Timestamp '2021-08-08 11:00:00', '-03: 00'),
       From_tz (Timestamp '2021-08-08 11:00:00', '-05: 00'),
       From_tz (Timestamp '2021-08-08 11:00:00', '-07: 00')
From dual;
  
Select from_TZ (localtimstamp, '-03: 00'),
       From_tz (localtimstamp, '-05: 00'),
       From_tz (localtimstamp, '-07: 00')
From dual;
  
- To_Timstamp

SELECT TO_TIMESTAMP ('2006-01-18 08: 15: 32.1234',
                     'Yyyy-mm-dd hh24: mi: ss.ff') Novo_timstamp
From dual;

- To_timstamp_tz

SELECT TO_TIMESTAMP_TZ ('2006-01-18 08: 15: 32.1234 -5: 00',
                        'Yyyy-mm-dd hh24: mi: ss.ff tzh: tzm') new_timstamp_with_timezone
From dual;

SELECT TO_TIMESTAMP_TZ ('2006-01-18 08: 15: 32.1234 America/Sao_Paulo',
                        'Yyyy-mm-dd hh24: mi: ss.ff tzr') new_timstamp_with_timezone
From dual;
```
---

<!-- TOC --><a name="globalization"></a>
### Globalization

```sql
- View of Time Zones (DBA only)
SELECT *
  From V $ timezone_names tn
 WHERE REGEXP_LIKE (TN.TZNAME, 'SAO_PAULO');

- Sysdate
SELECT SYSDATE FROM DUAL;

- Systimestamp
Select Systimestamp from Dual;

- Interval Year to Month
SELECT INTERVAL '55 -11 'Year To Month From Dual;

- Functions (SYS)
- Consulting the Bank UTC
Select dbtimezone from dual;

- Changing Bank UTC
Alter database set time_zone = '-03: 00';

- Sessiontimezone
SELECT SESSIONINTIMEZONE DUAL;

- Extract
Select Extract (Year from Sysdate) year,
       Extract (Month From Sysdate) month, Extract (Day from Sysdate) day
  From dual;

```
---

<!-- TOC --><a name="section-31-advanced-sub-query"></a>
## Section 31 - Advanced Sub -Query

<!-- TOC --><a name="1-using-the-clause-with"></a>
### 1 - Using the clause with

```sql
-
- Oracle SQL advanced 
-
- Section 31 - Subconsultures 
-
- Class 1 - Using the With clause

- Using the With clause

- Connect as HR User

With max_salaries as 
       (Select Department_id,
               Max (salary) maximum_salary,
               Round (AVG (SALARY), 2) AVERAGE_SARY        
        From Employees and
        Group by Department_id
       )
Select e.employee_id, e.salary, e.department_id, max_salaries.maximum_salarry, max_salaries.average_salary
From Employees and
  Join Max_Salaries On (e.department_id = max_salaries.department_id);
```
---

<!-- TOC --><a name="2-update-using-correlated-subconsultures"></a>
### 2 - Update using correlated subconsultures

```sql
-
- Oracle SQL advanced 
-
- Section 31 - Subconsultures
-
- Class 2 - Update using correlated subconsultures

- Update using correlated subconsultures

- Connect as HR User

- Creating the Departments_Averag_Temp table

DROP Table Departments_Averag_TEMP;

Create Table Departments_Averag_Temp
(Department_id Number (4),
 SALARY_Averag Number (8,2),
 Commission_PCT_Averag Number (2,2));
 
- Initializing the Department_Averag_Temp table

INSERT INTO departments_average_temp
  Select department_id, 0, 0
  From Employees
  Group by Department_id;

Commit;

- Consulting the Departments_Averag_Temp table

SELECT *
From department_average_temp;

- Update using correlated subconsultures

UPDATE DEPARTMENTS_Averag_TEMP D
SET (D.Salarry_Averag, d.comMession_PCT_Averag) = (Select Round (AVG (E.Salarry), 2), AVG (e.comMission_PCT)
                                                    From Employees and
                                                    Where D.Department_id = E.Department_id
                                                    Group by E.Department_id);
                                                    
Commit;

- Consulting the Departments_Averag_Temp table

SELECT *
From department_average_temp;
```
---

<!-- TOC --><a name="advanced-subqueries"></a>
### Advanced Subqueries

```sql
- CLAUSE WITH
With max_salaries as
 (Select Department_id,
         Max (salary) max_salary,
         Round (AVG (SALARY), 2) AVG_SARY
    From Employees
   Group by Department_id)
Select e.employee_id,
       E.SARARY,
       e.department_id,
       max_salaries.max_salary,
       max_salaries.avg_salary
  From Employees and
  Join Max_Salaries
    On (e.department_id = max_salaries.department_id);

-Update with correlated Sub-Query
Update Table A1
   Set (column1, column2) =
       (Select column1, column2 from table b1 where a1.coluna1 = b2.coluna1);

-- Training
Drop table dp_avg_temp;

Create Table DP_AVG_TEMP (Department_id Number (4),
                         SALARY_AVG NUMBER (8, 2),
                         Commission_pct Number (2, 2));

INSERT INTO DP_AVG_TEMP
  Select Department_id, 0, 0 from Employees Group by Department_id;

Select * from dp_avg_temp;

Update dp_avg_temp dp
   Set (dp.salarry_avg, dp.comdesson_pct) =
       (SELECT ROUND (AVG (E.SARARY), 2), ROUND (AVG (E.comMISSON_PCT), 2)
          From Employees and
         Where Dp.Department_id = E.Department_id
         Group by E.Department_id);

 With salads as
  (Select e.Department_id,
          Max (e.salary) max_salary,
          Min (E.Salarry) Min
          Round (AVG (E.Salarry), 2) AVG_SARARY
     From Employees and
    Group by Department_id)
 Select e.employee_id,
        E.FIRST_NAME,
        E.SARARY,
        e.department_id,
        S.MAX_SALARY,
        s.min_sarly,
        S.Avg_Salarry
   From Employees E, Salaities
  Where e.department_id = s.department_id;

```
---

<!-- TOC --><a name="section-32-sql-script-dynamic"></a>
## Section 32 - SQL Script Dynamic

<!-- TOC --><a name="1-generating-dynamic-scripts"></a>
### 1 - Generating dynamic scripts

```sql
-
- Oracle SQL advanced 
-
- Section 32 - generating dynamic SQL scripts
-
- Class 1 - generating dynamic SQL scripts

- generating dynamic SQL scripts

- Connect as SYS User

- Create a course user

Drop user course; 

Create User Course
Identified by course
Default Tablespace Users
Quota unlimited on users
TEMPORY TABLESPACE TEMP;

Grant Connect, Resource to Course;

- Create a folder on Windows C: \ Courses \ Oracle \ SQL_Specialist 
- In the Windows Command Line Run:

Mkdir C: \ Courses \ Oracle \ SQL_Specialist

- In SQL Developer Create a connection to the course user

- Connect as a Course User

Drop table students;

Create Table Students
(Student_id Number (11),
 Varchar2 (200));

Drop table courses;

Create Table Courses
(Course_id Number (11),
 name Varchar2 (200),
 Number price (11.2));
 
 - Consulting the tables of the connected user (course)
 
 SELECT *
 From user_tables;

- Creating a script that removes (drop) all tables of the user that is connected (course)

Set head heading off
Spool c: \ courses \ oracle \ sql_especialist \ drop_tables.sql
SELECT 'DROP TABLE' || table_name || 'Cascade Constraints;'
From user_tables;
Spool off - edit and vizualize the generated file c: \ courses \ oracle \ sql_especialist \ drop_tables.sql

- In SQLdeveloper Run the script C: \ Courses \ Oracle \ SQL_Specialist \ Drop_tables.sql

@C: \ courses \ oracle \ sql_especialist \ drop_tables.sql

- Consulting the tables of the connected user (course)
 
 SELECT *
 From user_tables;

```
---

<!-- TOC --><a name="section-33-group-by-advanced"></a>
## Section 33 - Group by Advanced

<!-- TOC --><a name="1-creating-schema-sales"></a>
### 1 - Creating Schema Sales

```sql
-
- Oracle SQL advanced 
-
- Section 34 - Improving the Group Clause by
-
- Class 1 - Setup: Creating Schema Sales

- Setup: Creating Schema Sales

- Connect as SYS User

Drop User Sales Cascade;

Create User Sales
Identified by Sales
Default Tablespace Users
Quota unlimited on users
TEMPORY TABLESPACE TEMP;

Grant Connect, Resource to Sales;

- Create Sales User Connection using the Xepdb Database Service

- Connect as Sales 

Create Table Sales
(
	Continent Varchar (20),
	Country Varchar (20),
	City Varchar (20),
	Units_Sold Integer
);

INSERT INTO SALES VALUES ('North America', 'Canada', 'Toronto', 10000);
INSERT INTO SALES VALUES ('North America', 'Canada', 'Montreal', 5000);
INSERT INTO SALES VALUES ('North America', 'Canada', 'Vancouver', 15000);
INSERT INTO SALES VALUES ('Asia', 'China', 'Hong Kong', 7000);
INSERT INTO SALES VALUES ('Asia', 'China', 'Shanghai', 3000);
INSERT INTO SALES VALUES ('Asia', 'Japan', 'Tokyo', 5000);
INSERT INTO SALES VALUES ('Europe', 'UK', 'London', 6000);
INSERT INTO SALES VALUES ('Europe', 'UK', 'Manchester', 12000);
INSERT INTO SALES VALUES ('Europe', 'France', 'Paris', 5000);

Commit;

- Consult the Sales table

SELECT *
From Sales;

```
---

<!-- TOC --><a name="2-grouping-sets"></a>
### 2 - Grouping Sets

```sql
-
- Oracle SQL advanced 
-
- Section 34 - Improving the Group Clause by
-
- Class 2 - Grouping Sets

- Grouping Sets

- Connect as User Sales

SELECT *
From Sales
Order by Continent, Country, City;

SELECT CONTINENT, SUM (Units_Sold)
From Sales 
Group by Continent;

SELECT COUNTRY, SUM (UNITS_SOLD)
From Sales 
Group by country;

Select City, Sum (units_sold)
From Sales 
Group by City;

- Using Grouping Sets

Select Continent, Country, City, Sum (Units_Sold)
From Sales
Group by Grouping Sets (Continent, Country, City);

- Using Grouping Sets (including General Total)

Select Continent, Country, City, Sum (Units_Sold)
From Sales
Group by Grouping Sets (Continent, Country, City, ());





```
---

<!-- TOC --><a name="3-rollup"></a>
### 3 - Rollup

```sql
-
- Oracle SQL advanced 
-
- Section 34 - Improving the Group Clause by
-
- Class 3 - Rollup

- Rollup

- Using Rollup

Select Continent, Country, City, Sum (Units_Sold)
From Sales
Group by Rollup (Continent, Country, City);

- Using the Grouping_id function 

SELECT CONTINENT, GROURING_ID (Continent) GCONTINENT,
       Country, Grouping_id (country) Gountry, 
       City, group_id (City) Gcity,
       Sum (units_sold)
From Sales
Group by Rollup (Continent, Country, City);






```
---

<!-- TOC --><a name="4-cube"></a>
### 4 - Cube

```sql
-
- Oracle SQL advanced 
-
- Section 34 - Improving the Group Clause by
-
- Class 4 - Cube

- Cube

- Connect as User Sales

- Using Cube

Select Continent, Country, City, Sum (Units_Sold)
From Sales
Group by Cube (Continent, Country, City);





```
---

<!-- TOC --><a name="group-by-advanced"></a>
### Group by Advanced

```sql
- Creating Base for Training
Drop User Sales Cascade;

Create User Sales 
Identified by Sales 
Default Tablespace Users 
Quota unlimited on users 
TEMPORY TABLESPACE TEMP;

Grant Connect, Resource to Sales;

Create Table Sales
(Continent Varchar (20),
 Country Varchar (20),
 City Varchar (20),
 Units_Sold Integer);

INSERT INTO SALES VALUES ('North America', 'Canada', 'Toronto', 10000);
INSERT INTO SALES VALUES ('North America', 'Canada', 'Montreal', 5000);
INSERT INTO SALES VALUES ('North America', 'Canada', 'Vancouver', 15000);
INSERT INTO SALES VALUES ('Asia', 'China', 'Hong Kong', 7000);
INSERT INTO SALES VALUES ('Asia', 'China', 'Shanghai', 3000);
INSERT INTO SALES VALUES ('Asia', 'Japan', 'Tokyo', 5000);
INSERT INTO SALES VALUES ('Europe', 'UK', 'London', 6000);
INSERT INTO SALES VALUES ('Europe', 'UK', 'Manchester', 12000);
INSERT INTO SALES VALUES ('Europe', 'France', 'Paris', 5000);

Commit;

- Consult the Sales table
Select * From Sales;

-Using Group by to see the sub-total by column
Select S.Continent, Sum (s.units_sold)
From Sales S
Group by S.Continent;

SELECT S.COUNTRY, SUM (S.UNITS_SOLD)
From Sales S
Group by S.Continent;

Select S.City, Sum (s.units_sold)
From Sales S
Group by S.Continent;

- Grouping Sets
SELECT column1, column2, column3, Sum (Colnax) 
  From Table 
 Group by Grouping Sets (column1, column2, column3, ());

- Using Grouping Sets
SELECT S.CONTINENT, S.COUNTRY, S.CITY, SUM (S.UNITS_SOLD) SUM_UNITS
  From Sales S
 Group by Grouping Sets (S.Continent, S.Country, S.City, ());

- Rollup
SELECT column1, column2, column3, Sum (Colnax) 
  From Table 
 Group by Rollup (column1, column2, column3);

- Using Rollup
SELECT S.CONTINENT, S.COUNTRY, S.CITY, SUM (s. units_sold) sum_units
  From Sales S
 Group by Rollup (S.Continent, S.Country, S.City);
 
 

```
---

<!-- TOC --><a name="section-34-materialized-views"></a>
## Section 34 - Materialized Views

<!-- TOC --><a name="1-materialized-visions"></a>
### 1 - MATERIALIZED VISIONS

```sql
-
- Oracle SQL advanced 
-
- Section 34 - Materialized Visions
-
- Class 1 - Materialized Visions

- Connect as SYS User

- Passing System Privilege necessary to create a Materialized View 

Grant Create Materialized View to HR;

- Connect as HR User

- Removing a Materialized View 

DROP MATERIALIZED VIEW MV_DEPARTMENT_MAX_SALARIES;

- Creating a Materialized View  

Create Materialized View MV_Department_max_Salaries
BUILD IMMEDIATE 
Refresh complete 
On demand
Enable Query Rewrite 
TO THE 
  Select Department_id, Max (Salary) 
  From Employees
  Group by Department_id
  Order by Department_id;
       
- Consulting Materialized View

SELECT *
From MV_Department_max_Salaries;


```
---

<!-- TOC --><a name="2-types-of-materialized-views"></a>
### 2 - Types of materialized views

```sql
-
- Oracle SQL advanced 
-
- Section 34 - Materialized Visions
-
- Class 2 - Types of materialized views

- Types of materialized views

- Connect as SYS

Grant Create Materialized View to HR; 

- Connect as HR User

- Materialized Views with aggregation functions

- Creating Materialized View Log

DROP MATERIALIZED VIEW LOG ON EMPLOYEES;

Create Materialized View Log On Employees;

- Creating Materialized View

DROP MATERIALIZED VIEW MV_DEPARTMENT_SALARIES;

Create Materialized View MV_Department_Salaries
BUILD IMMEDIATE
Refresh complete
Enable Query Rewrite
TO THE 
  Select e.department_id,
         Sum (e.salary) sum_salary,
         Round (AVG (NVL (E.Salarry, 0)), 2) AVG_SALARY
  From Employees and
  Group by E.Department_id;

SELECT *
From MV_Department_Salaries;

- Materialized Views containing only Joins

- Creating Materialized View

DROP MATERIALIZED VIEW MV_EMPLOYES_JOBS_Departments;

Create Materialized View MV_employes_jobs_Departments
BUILD IMMEDIATE
Refresh complete
Enable Query Rewrite
TO THE 
Select e.employee_id, e.first_name, e.last_name, e.salary, e.comMission_PCT,
       E.JOB_ID, J.JOB_TITLE,
       E.Department_id, D.Department_Name
From Employees and
     Join Jobs J On (e.job_id = j.job_id)
     Join Departments D On (e.department_id = d.department_id);
     
SELECT *
From mv_employes_jobs_departments;

- this Materialized Views

- Creating Materialized View

DROP MATERIALIZED VIEW MV_DEPARTMENT_CUST_Hour;

Create Materialized View MV_Department_Cust_Hour
BUILD IMMEDIATE
Refresh complete
Enable Query Rewrite
TO THE 
  Select mv.department_name,
         Sum (mv.salary) sum_salary,
         Round (Sum (mv.salary)/160.2) Cust_Hour
  From mv_employes_jobs_departments mv
  Group by MV.Department_Name;

SELECT *
From MV_Department_Cust_Hour;
```
---

<!-- TOC --><a name="3-fast-refresh-materialized-view"></a>
### 3 - FAST REFRESH MATERIALIZED View

```sql
-
- Oracle SQL advanced 
-
- Section 34 - Materialized Visions
-
- Class 4 - Fast Refresh Materialized View 

- FAST REFRESH MATERIALIZED View 

- Connect as HR User
		  
- Removing a fast refreshed Materialized View 

- Removing Materialized View Log

DROP MATERIALIZED VIEW LOG ON EMPLOYEES;

- Creating Materialized View Log

Create Materialized View Log On Employees;

DROP MATERIALIZED VIEW MV_SALES_MANAGER;

- Creating a Fast Refreshed Materialized View 

Create Materialized View MV_SALES_MANAGER
BUILD IMMEDIATE 
Refresh fast on commit 
TO THE
  SELECT *
  From Employees
  Where Job_id = 'Sa_Man'; 

- Consulting a Fast Refreshed Materialized View 

SELECT *
From mv_sales_manager;

- Run DML on the base table of a fast refreshed Materialized View 

INSERT INTO EMPLOYEES 
VALUES (500, 'Alex', 'Brown', 'Abrown', '1111111', Sysdate, 'Sa_Man', 10000, null, 102.60);

Commit;

- Consulting Fast Refreshed Materialized View after the DML

SELECT *
From mv_sales_manager;

Delete from Employees
Where Employee_id = 500;

Commit;

- Consulting Fast Refreshed Materialized View after the DML

SELECT *
From mv_sales_manager;
		  
- Error in creating a fast refreshed complex materialized view 

- Removing Materialized View Log

DROP MATERIALIZED VIEW LOG ON DEPARTMENTS;

- Creating Materialized View Log

Create Materialized View Log On Departments;

DROP MATERIALIZED VIEW MV_DEPARTMENT_MAX_SALARIES;

Create Materialized View MV_Department_max_Salaries
BUILD IMMEDIATE
Refresh fast on commit
Enable Query Rewrite
The select D.Department_Name, e.* 
   From Employees and Join Departments D On (e.department_id = d.department_id)
   Where (e.department_id, salary) in 
                                   (Select Department_id, Max (Salary) Salary
                                    From Employees
                                    Group by Department_id)
   Order by E.Department_id, Salary;
		  
Create Materialized View MV_Department_max_Salaries
BUILD IMMEDIATE
Refresh Fast 
Enable Query Rewrite
The select D.Department_Name, e.* 
   From Employees and Join Departments D On (e.department_id = d.department_id) Where (e.department_id, salary) in 
                                   (Select Department_id, Max (Salary) Salary
                                    From Employees
                                    Group by Department_id)
   Order by E.Department_id, Salary;
   
Create Materialized View MV_Department_max_Salaries
BUILD IMMEDIATE
Refresh complete
Enable Query Rewrite
The select D.Department_Name, e.* 
   From Employees and Join Departments D On (e.department_id = d.department_id)
   Where (e.department_id, salary) in 
                                   (Select Department_id, Max (Salary) Salary
                                    From Employees
                                    Group by Department_id)
   Order by E.Department_id, Salary;
   
- Consulting Materialized View

SELECT *
From MV_Department_max_Salaries;
```
---

<!-- TOC --><a name="4-complete-refresh-materialized"></a>
### 4 - Complete Refresh Materialized

```sql
-
- Oracle SQL advanced 
-
- Section 34 - Materialized Visions
-
- Class 5 - Complete Refresh Materialized View 

- Complete Refresh Materialized View 
		  
- Connect as HR User

DROP MATERIALIZED VIEW MV_SALES_MANAGER;

- Creating a Complete Refresh Materialized View

Create Materialized View MV_SALES_MANAGER
BUILD IMMEDIATE 
Refresh complete 
ON COMMIT 
TO THE
  SELECT *
  From Employees
  Where Job_id = 'Sa_Man'; 

- Consulting a Complete Refreshed Materialized View 

SELECT *
From mv_sales_manager;

- Run DML on the base table of a complete refreshed materialized view

INSERT INTO EMPLOYEES
VALUES (501, 'Robert', 'Jonhson', 'Rjonhson', '2222222', Sysdate, 'Sa_Man', 15000, null, 102.60);

Commit;   

- Consulting a complete refreshed Materialized View again after the DML

SELECT *
From mv_sales_manager;

Delete from Employees
Where Employee_id = 501;

Commit;

- Consulting the Complete Refreshed Materialized View after the DML

SELECT *
From mv_sales_manager;

DROP MATERIALIZED VIEW MV_DEPARTMENT_MAX_SALARIES;

Create Materialized View MV_Department_max_Salaries
BUILD IMMEDIATE
Refresh complete 
Enable Query Rewrite
The select D.Department_Name, e.* 
   From Employees and Join Departments D On (e.department_id = d.department_id)
   Where (e.department_id, salary) in 
                                   (Select Department_id, Max (Salary) Salary
                                    From Employees
                                    Group by Department_id)
   Order by E.Department_id, Salary;

- Consulting Materialized View

SELECT *
From MV_Department_max_Salaries;
```
---

<!-- TOC --><a name="5-force-refresh-materialized-view"></a>
### 5 - Force Refresh Materialized View

```sql
-
- Oracle SQL advanced 
-
- Section 34 - Materialized Visions
-
- Class 6 - Force Refresh Materialized View 

- Force Refresh Materialized View 

- Connect as HR User

- Removing Materialized View Log

DROP MATERIALIZED VIEW LOG ON EMPLOYEES;

- Creating Materialized View Log

Create Materialized View Log On Employees;

DROP MATERIALIZED VIEW MV_IT_PROGRAMMERS;

- Creating a Force Refresh Materialized View

Create Materialized View MV_IT_PROGRAMMERS
BUILD IMMEDIATE 
REFRESH FORCE 
ON COMMIT
Enable Query Rewrite 
TO THE
  SELECT *
  From Employees
  Where job_id = 'it_prog'
  Order by Department_id; 

- Consulting a Force Refreshed Materialized View 

SELECT *
From MV_IT_PROGRAMMERS;

- Performing DML on the base table of a Force Refreshed Materialized View 

INSERT INTO EMPLOYEES
VALUES (503, 'Greg', 'Lake', 'Glake', '33333333', Sysdate, 'It_Prog', 20000, Null, 103.60);

Commit;   

- Consulting a Force Refreshed Materialized View again after the DML

SELECT *
From MV_IT_PROGRAMMERS;

Delete from Employees
Where Employee_id = 503;

Commit;

- Consulting Force Refreshed Materialized View after the DML

SELECT *
From MV_IT_PROGRAMMERS;

```
---

<!-- TOC --><a name="6-updating-materialized-views-using-packages"></a>
### 6 - Updating materialized views using packages

```sql
-
- Oracle SQL advanced 
-
- Section 34 - Materialized Visions
-
- Class 7 - Updating materialized views using packages

- Updating materialized views using packages

- Connect as SYS User

- Passing System privileges necessary to execute components of Package DBMS_MVIEW

Grant Run on dbms_mview to hr;

- Passing System privileges necessary to execute components of Package DBMS_SNAPSHOT

Grant Run on dbms_snapshot to hr;

- Connect as HR User

- Removing Materialized View Log

DROP MATERIALIZED VIEW LOG ON EMPLOYEES;

- Creating Materialized View Log

Create Materialized View Log On Employees;

DROP MATERIALIZED VIEW MV_IT_PROGRAMMERS;

- Creating a Force Refresh Materialized View

Create Materialized View MV_IT_PROGRAMMERS
BUILD IMMEDIATE 
REFRESH FORCE 
Enable Query Rewrite 
TO THE
  SELECT *
  From Employees
  Where job_id = 'it_prog'
  Order by Department_id; 

- Updating manually materialized views using the Package DBMS_MVIEW.refresh

- Consulting Materialized View

SELECT *
From MV_IT_PROGRAMMERS;

- Consulting the Employees table SELECT *
From Employees;

- Running DML on the Materialized View base table 

Delete from Employees
Where Employee_id In (504, 505, 506);

Commit;

INSERT INTO EMPLOYEES
Values ​​(504, 'Richard', 'Wright', 'Rwright', '4444444', Sysdate, 'It_Prog', 25000, Null, 103.60);

Commit;  



- Consulting the Employees table

SELECT *
From Employees
Where Employee_id = 504;

- Consulting Materialized View that will be outdated

SELECT *
From MV_IT_PROGRAMMERS;

-- Updating views using Package DBMS_MVIEW

Run dbms_mview.refresh ('mv_it_programmers', 'f')

- Consulting Materialized View

SELECT *
From MV_IT_PROGRAMMERS;

- Updating materialized views using Package DBMS_SNAPSHOT

- Running DML on the Materialized View base table 

INSERT INTO EMPLOYEES
VALUES (505, 'BILLIE', 'HOLIDAY', 'BHOLIDAY', '5555555', SYSDATE, 'IT_PROG', 30000, NULL, 103, 60);

Commit;  

- Consulting the Employees table

SELECT *
From Employees
Where Employee_id In (504,505);

- Consulting Materialized View that will be outdated

SELECT *
From MV_IT_PROGRAMMERS;

- Performing the procedure dbms_snapshot.refresh

Run dbms_snapshot.refresh ('mv_it_programmers', 'c')

- Consulting Materialized View

SELECT *
From MV_IT_PROGRAMMERS;

- Updating manually materialized views using the DBMS_MVIEW.refresh_all_mviews

- Consulting the Employees table

SELECT *
From Employees;

- Consulting Materialized View

SELECT *
From MV_IT_PROGRAMMERS;

- Running DML on the Materialized View base table 

INSERT INTO EMPLOYEES
VALUES (506, 'EDDIE', 'VEDDER', 'EVEDDER', '7777777', SYSDATE, 'IT_PROG', 35000, NULL, 103.60);

Commit; 

- Consulting the Employees table

SELECT *
From Employees
Where Employee_id In (504, 505.506);

- Consulting Materialized View

SELECT *
From MV_IT_PROGRAMMERS;

- Connect as SYS User

Grant Run on dbms_mview to hr;

Grant Alter Any Materialized View to HR;

--- Performing the procedure dbms_mview.refresh_all_mviews

Declare
  VFAILURES NUMBER;
Begin        
  Dbms_mview.refresh_all_mviews (vfailures, 'c', '', true, false, false);
End;

- Consulting Materialized View

SELECT *
From MV_IT_PROGRAMMERS;
```
---

<!-- TOC --><a name="7-scheduling-periodic-updates-of-materialized-visions"></a>
### 7 - Scheduling Periodic Updates of Materialized Visions

```sql
-
- Oracle SQL advanced 
-
- Section 34 - Materialized Visions
-
- Class 8 - Scheduling Periodic Updates (Refresh) of Materialized Visions

- Scheduling periodic updates (Refresh) of materialized views

- Connect as HR User

- Removing Materialized View Log

DROP MATERIALIZED VIEW LOG ON EMPLOYEES;

- Creating Materialized View Log

Create Materialized View Log On Employees;

- Creating a Materialized View Sales_Managers_VW not immediately populated
- and that performs next updates (refreshes) every 1 day

DROP MATERIALIZED VIEW MV_SALES_MANAGER;

Create Materialized View MV_SALES_MANAGER
Build Deferred
REFRESH FORCE
Next Sysdate + 1
TO THE
  SELECT *
  From Employees
  Where job_id = 'sa_man'
  Order by Department_id;

- Consulting Materialized View

SELECT *
From mv_sales_manager;
```
---

<!-- TOC --><a name="materialized-view"></a>
### MATERIALIZED View

```sql
- Materialized View
Create Materialized View NameView
Build [immediate | Deferred]
Refresh [fast | Complete | Force]
On [Commit | Demand]
[[Enable | Disable] Query Rewrite]
[On prebuilt table] 
The select ...;

- Giving permission to the user to create Materialized View
GRANT CREATE MATERIALIZED VIEW TO KNETEV

- Removing Materialized View
DROP MATERIALIZED VIEW MV_DEPARTMENT_MAX_SALARIES;

- Creating Materialized View
Create Materialized View MV_Department_max_Salaries
BUILD IMMEDIATE
Refresh complete 
On demand
Enable Query Rewrite 
TO THE 
SELECT E.DEPARTMENT_ID, MAX (E.SALARY)
  From Employees and
 Group by e.department_id
 Order by E.Department_id, Max (E.Salarry);
 
SELECT * FROM MV_DEPARTMENT_MAX_SALARIES;

- Materialized View Log
DROP MATERIALIZED VIEW LOG ON EMPLOYEES;
Create Materialized View Log On Employees;

DROP MATERIALIZED VIEW MV_DEPARTMENT_SALARIES;

Create Materialized View MV_Department_Salaries
BUILD IMMEDIATE
Refresh complete
Enable Query Rewrite
TO THE 
Select e.department_id,
       Sum (e.salary) sum_salary,
       Round (AVG (NVL (E.Salarry, 0)), 2) AVG_SALARY
  From Employees and
 Group by E.Department_id;

SELECT * from MV_Department_Salaries;

```
---
